import{ay as t,a_ as e,S as n,i as a,s as l,e as s,c as i,a as o,d as r,b as c,f as d,x as m,l as p,r as u,u as h,v as f,w as $,j as g,o as v,a8 as w,k as b,n as E,m as y,G as x,H as C,I as A,a9 as L,aa as R,ab as M,N as _,aX as k}from"./vendor-c6674e75.js";import{R as N}from"./Ripple-ada69b16.js";const P=(t,e,n,a={})=>(t.addEventListener(e,n,a),()=>{t.removeEventListener(e,n,a)}),j=(e,n)=>{const a="string"==typeof n||null==n?{tip:n}:n;let l,s=document.createElement("div");s.classList.add("tooltip"),s.textContent=a.tip,e.appendChild(s);let i=null;const o=P(e,"mouseenter",(async()=>{if(null==a.tip)return;clearTimeout(l),s.classList.remove("visible");const n=e.getBoundingClientRect();document.body.appendChild(s),await t(),s.style.left=Math.max(5,Math.min(window.innerWidth-5,n.left+n.width/2-s.clientWidth/2))+"px",s.style.top=Math.max(5,Math.min(window.innerHeight-5,n.top-s.clientHeight-7))+"px",s.classList.add("visible"),i=P(window,"scroll",(()=>r()),{once:!0,capture:!0,passive:!0})})),r=()=>{s.classList.remove("visible"),i&&i(),l=setTimeout((()=>{s.parentElement&&s.parentElement.removeChild(s)}),200)},c=P(e,"mouseleave",r);return{update(t){"string"!=typeof t&&null!=t||(t={tip:t}),a.tip=t.tip,s.textContent=t.tip,a.tip||s.parentElement&&s.parentElement.removeChild(s)},destroy(){o(),c(),i&&i(),s.parentElement&&s.parentElement.removeChild(s)}}},S=(t,n)=>{var a,l,s;let i="string"==typeof n?n:(null==n?void 0:n.html)||"";i=i.trim();const o="string"==typeof n?null:n.message,r=e.sanitize(i,{RETURN_DOM_FRAGMENT:!0,ALLOWED_URI_REGEXP:/^(mailto|https?|tel|cid|attachment):/i});for(const e of[].slice.call(r.querySelectorAll("a"))){const t=e;t.target="_blank",null==(a=t.relList)||a.add("external")}for(const e of[].slice.call(r.querySelectorAll("style, link, script, meta, object, head, title")))null==(l=e.parentNode)||l.removeChild(e);if(o){const t=[].slice.call(r.querySelectorAll("img"));for(const e of t){const t=e.getAttribute("src");if(!t)continue;const n=t.trim().match(/^(cid|attachment):(.+)/i);if(!n)continue;e.removeAttribute("src");const a=n[2];if(!a)continue;const l=null==(s=o.attachments)?void 0:s.find((t=>t.id===a));l&&e.setAttribute("src",`/api/mailboxes/${o.mailbox}/messages/${o.id}/attachments/${l.id}`)}}t.appendChild(r)},T=t=>(document.body.appendChild(t),{destroy(){var e;null==(e=t.parentElement)||e.removeChild(t)}});function q(t){let e,n,a=t[0]&&D(t);return{c(){e=s("div"),a&&a.c(),this.h()},l(t){e=i(t,"DIV",{class:!0});var n=o(e);a&&a.l(n),n.forEach(r),this.h()},h(){c(e,"class","icon svelte-1stp7al")},m(t,l){d(t,e,l),a&&a.m(e,null),n=!0},p(t,n){t[0]?a?(a.p(t,n),1&n&&m(a,1)):(a=D(t),a.c(),m(a,1),a.m(e,null)):a&&(u(),h(a,1,1,(()=>{a=null})),$())},i(t){n||(m(a),n=!0)},o(t){h(a),n=!1},d(t){t&&r(e),a&&a.d()}}}function D(t){let e,n,a;var l=t[0];return l&&(e=new l({})),{c(){e&&g(e.$$.fragment),n=p()},l(t){e&&y(e.$$.fragment,t),n=p()},m(t,l){e&&v(e,t,l),d(t,n,l),a=!0},p(t,a){if(l!==(l=t[0])){if(e){u();const t=e;h(t.$$.fragment,1,0,(()=>{f(t,1)})),$()}l?(e=new l({}),g(e.$$.fragment),m(e.$$.fragment,1),v(e,n.parentNode,n)):e=null}},i(t){a||(e&&m(e.$$.fragment,t),a=!0)},o(t){e&&h(e.$$.fragment,t),a=!1},d(t){t&&r(n),e&&f(e,t)}}}function G(t){let e,n,a,l,p,k,P,j=(t[0]||t[2])&&q(t);const S=t[6].default,T=w(S,t,t[5],null);return l=new N({}),{c(){e=s("a"),j&&j.c(),n=b(),T&&T.c(),a=b(),g(l.$$.fragment),this.h()},l(t){e=i(t,"A",{class:!0,href:!0,target:!0,download:!0});var s=o(e);j&&j.l(s),n=E(s),T&&T.l(s),a=E(s),y(l.$$.fragment,s),s.forEach(r),this.h()},h(){c(e,"class","menu-item na btn-dark svelte-1stp7al"),c(e,"href",t[1]),c(e,"target",t[3]),c(e,"download",t[4]),x(e,"noplaceholder",!t[0]&&!t[2])},m(s,i){d(s,e,i),j&&j.m(e,null),C(e,n),T&&T.m(e,null),C(e,a),v(l,e,null),p=!0,k||(P=[A(e,"click",t[7]),A(e,"pointerdown",t[8])],k=!0)},p(t,[a]){t[0]||t[2]?j?(j.p(t,a),5&a&&m(j,1)):(j=q(t),j.c(),m(j,1),j.m(e,n)):j&&(u(),h(j,1,1,(()=>{j=null})),$()),T&&T.p&&(!p||32&a)&&L(T,S,t,t[5],p?M(S,t[5],a,null):R(t[5]),null),(!p||2&a)&&c(e,"href",t[1]),(!p||8&a)&&c(e,"target",t[3]),(!p||16&a)&&c(e,"download",t[4]),5&a&&x(e,"noplaceholder",!t[0]&&!t[2])},i(t){p||(m(j),m(T,t),m(l.$$.fragment,t),p=!0)},o(t){h(j),h(T,t),h(l.$$.fragment,t),p=!1},d(t){t&&r(e),j&&j.d(),T&&T.d(t),f(l),k=!1,_(P)}}}function H(t,e,n){let{$$slots:a={},$$scope:l}=e,{icon:s}=e,{href:i}=e,{iconPlaceholder:o=!1}=e,{target:r}=e,{download:c}=e;return t.$$set=t=>{"icon"in t&&n(0,s=t.icon),"href"in t&&n(1,i=t.href),"iconPlaceholder"in t&&n(2,o=t.iconPlaceholder),"target"in t&&n(3,r=t.target),"download"in t&&n(4,c=t.download),"$$scope"in t&&n(5,l=t.$$scope)},[s,i,o,r,c,l,a,function(e){k.call(this,t,e)},function(e){k.call(this,t,e)}]}class I extends n{constructor(t){super(),a(this,t,H,G,l,{icon:0,href:1,iconPlaceholder:2,target:3,download:4})}}export{I as M,P as a,S as b,T as p,j as t};
