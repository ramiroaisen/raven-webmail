var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;import{S as o,i,s as c,aF as d,aG as f,a as u,d as m,b as h,f as p,H as v,D as $,aH as g,e as b,k as w,t as x,j as y,c as E,n as j,g as k,m as O,aI as A,aA as C,o as M,J as R,I as D,a3 as L,h as B,r as _,u as N,w as X,x as z,aJ as P,v as I,N as T,E as S,aK as U,am as V,aw as F,aL as G,K as H,L as q,R as Z,a0 as K,a1 as J,ad as Q,G as W,l as Y,F as ee,P as te,Q as ne,O as le,aM as ae,aN as se,aO as re,aP as oe,aQ as ie,aR as ce,aS as de,aT as fe,aU as ue,aV as me,aW as he,y as pe,C as ve,a7 as $e,aC as ge,aX as be,V as we,U as xe,ac as ye,A as Ee,ai as je,aY as ke,af as Oe,ah as Ae,aj as Ce,aq as Me,aZ as Re,a_ as De,a$ as Le}from"./vendor-c6674e75.js";import{b as Be,c as _e,o as Ne,p as Xe,k as ze,l as Pe,_ as Ie}from"./util-26aae2f7.js";import{R as Te}from"./Ripple-ada69b16.js";import{t as Se,a as Ue}from"./MenuItem-f687bcf2.js";import{F as Ve,a as Fe,C as Ge,c as He,s as qe}from"./signature-38791045.js";import{_ as Ze}from"./preload-helper-ec9aa979.js";import{l as Ke}from"./locale-43eac5b3.js";function Je(e){let t,n;return{c(){t=d("svg"),n=d("path"),this.h()},l(e){t=f(e,"svg",{width:!0,height:!0,viewBox:!0});var l=u(t);n=f(l,"path",{d:!0,fill:!0}),u(n).forEach(m),l.forEach(m),this.h()},h(){h(n,"d","M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"),h(n,"fill",e[2]),h(t,"width",e[0]),h(t,"height",e[1]),h(t,"viewBox",e[3])},m(e,l){p(e,t,l),v(t,n)},p(e,[l]){4&l&&h(n,"fill",e[2]),1&l&&h(t,"width",e[0]),2&l&&h(t,"height",e[1]),8&l&&h(t,"viewBox",e[3])},i:$,o:$,d(e){e&&m(t)}}}function Qe(e,t,n){let{size:l="1em"}=t,{width:a=l}=t,{height:s=l}=t,{color:r="currentColor"}=t,{viewBox:o="0 0 24 24"}=t;return e.$$set=e=>{"size"in e&&n(4,l=e.size),"width"in e&&n(0,a=e.width),"height"in e&&n(1,s=e.height),"color"in e&&n(2,r=e.color),"viewBox"in e&&n(3,o=e.viewBox)},[a,s,r,o,l]}class We extends o{constructor(e){super(),i(this,e,Qe,Je,c,{size:4,width:0,height:1,color:2,viewBox:3})}}const Ye=["3g2","3ga","3gp","7z","aa","aac","ac","accdb","accdt","ace","adn","ai","aif","aifc","aiff","ait","amr","ani","apk","app","applescript","asax","asc","ascx","asf","ash","ashx","asm","asmx","asp","aspx","asx","au","aup","avi","axd","aze","bak","bash","bat","bin","blank","bmp","bowerrc","bpg","browser","bz2","bzempty","c","cab","cad","caf","cal","cd","cdda","cer","cfg","cfm","cfml","cgi","chm","class","cmd","code-workspace","codekit","coffee","coffeelintignore","com","compile","conf","config","cpp","cptx","cr2","crdownload","crt","crypt","cs","csh","cson","csproj","css","csv","cue","cur","dart","dat","data","db","dbf","deb","default","dgn","dist","diz","dll","dmg","dng","doc","docb","docm","docx","dot","dotm","dotx","download","dpj","ds_store","dsn","dtd","dwg","dxf","editorconfig","el","elf","eml","enc","eot","eps","epub","eslintignore","exe","f4v","fax","fb2","fla","flac","flv","fnt","folder","fon","gadget","gdp","gem","gif","gitattributes","gitignore","go","gpg","gpl","gradle","gz","h","handlebars","hbs","heic","hlp","hs","hsl","htm","html","ibooks","icns","ico","ics","idx","iff","ifo","image","img","iml","in","inc","indd","inf","info","ini","inv","iso","j2","jar","java","jpe","jpeg","jpg","js","json","jsp","jsx","key","kf8","kmk","ksh","kt","kts","kup","less","lex","licx","lisp","lit","lnk","lock","log","lua","m","m2v","m3u","m3u8","m4","m4a","m4r","m4v","map","master","mc","md","mdb","mdf","me","mi","mid","midi","mk","mkv","mm","mng","mo","mobi","mod","mov","mp2","mp3","mp4","mpa","mpd","mpe","mpeg","mpg","mpga","mpp","mpt","msg","msi","msu","nef","nes","nfo","nix","npmignore","ocx","odb","ods","odt","ogg","ogv","ost","otf","ott","ova","ovf","p12","p7b","pages","part","partial","pcd","pdb","pdf","pem","pfx","pgp","ph","phar","php","pid","pkg","pl","plist","pm","png","po","pom","pot","potx","pps","ppsx","ppt","pptm","pptx","prop","ps","ps1","psd","psp","pst","pub","py","pyc","qt","ra","ram","rar","raw","rb","rdf","rdl","reg","resx","retry","rm","rom","rpm","rpt","rsa","rss","rst","rtf","ru","rub","sass","scss","sdf","sed","sh","sit","sitemap","skin","sldm","sldx","sln","sol","sphinx","sql","sqlite","step","stl","svg","swd","swf","swift","swp","sys","tar","tax","tcsh","tex","tfignore","tga","tgz","tif","tiff","tmp","tmx","torrent","tpl","ts","tsv","ttf","twig","txt","udf","vb","vbproj","vbs","vcd","vcf","vcs","vdi","vdx","vmdk","vob","vox","vscodeignore","vsd","vss","vst","vsx","vtx","war","wav","wbk","webinfo","webm","webp","wma","wmf","wmv","woff","woff2","wps","wsf","xaml","xcf","xfl","xlm","xls","xlsm","xlsx","xlt","xltm","xltx","xml","xpi","xps","xrb","xsd","xsl","xspf","xz","yaml","yml","z","zip","zsh"],et=e=>{const t=tt(e);return`/file-icons/${Ye.includes(t)?t:"asc"}.svg`},tt=e=>{const t=e.split(".");return(t[t.length-1]||"").toLowerCase()};function nt(e){let t,n,l,a,s,r;return n=new We({}),{c(){t=b("x-state"),y(n.$$.fragment),this.h()},l(e){t=E(e,"X-STATE",{class:!0});var l=u(t);O(n.$$.fragment,l),l.forEach(m),this.h()},h(){C(t,"class","error svelte-jvrbx4")},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=R(l=Se.call(null,t,e[0][sn])),s=!0)},p(e,t){l&&L(l.update)&&1&t&&l.update.call(null,e[0][sn])},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,r()}}}function lt(e){let t,n,l;return n=new V({}),{c(){t=b("x-state"),y(n.$$.fragment),this.h()},l(e){t=E(e,"X-STATE",{class:!0});var l=u(t);O(n.$$.fragment,l),l.forEach(m),this.h()},h(){C(t,"class","complete svelte-jvrbx4")},m(e,a){p(e,t,a),M(n,t,null),l=!0},p:$,i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){N(n.$$.fragment,e),l=!1},d(e){e&&m(t),I(n)}}}function at(e){let t;return{c(){t=b("x-progress"),this.h()},l(e){t=E(e,"X-PROGRESS",{style:!0,class:!0}),u(t).forEach(m),this.h()},h(){F(t,"width",e[0][rn]/e[0].size*100+"%"),C(t,"class","svelte-jvrbx4")},m(e,n){p(e,t,n)},p(e,n){1&n&&F(t,"width",e[0][rn]/e[0].size*100+"%")},i:$,o:$,d(e){e&&m(t)}}}function st(e){let t,n,l,a,s,r,o,i,c,d,f,$,S,U,V,F,G,H,q,Z,K=e[0].filename+"";const J=[at,lt,nt],Q=[];function W(e,t){return"uploading"===e[0][an]?0:"complete"===e[0][an]||null==e[0][an]?1:"error"===e[0][an]?2:-1}return~(c=W(e))&&(d=Q[c]=J[c](e)),S=new g({}),V=new Te({}),{c(){t=b("x-file"),n=b("x-icon"),l=b("img"),s=w(),r=b("x-name"),o=x(K),i=w(),d&&d.c(),f=w(),$=b("x-action"),y(S.$$.fragment),U=w(),y(V.$$.fragment),this.h()},l(e){t=E(e,"X-FILE",{class:!0});var a=u(t);n=E(a,"X-ICON",{class:!0});var c=u(n);l=E(c,"IMG",{src:!0,alt:!0,width:!0,height:!0}),c.forEach(m),s=j(a),r=E(a,"X-NAME",{class:!0});var h=u(r);o=k(h,K),h.forEach(m),i=j(a),d&&d.l(a),f=j(a),$=E(a,"X-ACTION",{class:!0});var p=u($);O(S.$$.fragment,p),U=j(p),O(V.$$.fragment,p),p.forEach(m),a.forEach(m),this.h()},h(){A(l.src,a=et(e[0].filename))||h(l,"src",a),h(l,"alt",""),h(l,"width","100%"),h(l,"height","100%"),C(n,"class","svelte-jvrbx4"),C(r,"class","svelte-jvrbx4"),C($,"class","remove btn-dark svelte-jvrbx4"),C(t,"class","svelte-jvrbx4")},m(a,d){p(a,t,d),v(t,n),v(n,l),v(t,s),v(t,r),v(r,o),v(t,i),~c&&Q[c].m(t,null),v(t,f),v(t,$),M(S,$,null),v($,U),M(V,$,null),H=!0,q||(Z=[R(F=Se.call(null,$,e[2].Remove)),D($,"click",(function(){L(e[1])&&e[1].apply(this,arguments)}))],q=!0)},p(n,[s]){e=n,(!H||1&s&&!A(l.src,a=et(e[0].filename)))&&h(l,"src",a),(!H||1&s)&&K!==(K=e[0].filename+"")&&B(o,K);let r=c;c=W(e),c===r?~c&&Q[c].p(e,s):(d&&(_(),N(Q[r],1,1,(()=>{Q[r]=null})),X()),~c?(d=Q[c],d?d.p(e,s):(d=Q[c]=J[c](e),d.c()),z(d,1),d.m(t,f)):d=null),F&&L(F.update)&&4&s&&F.update.call(null,e[2].Remove)},i(e){H||(z(d),z(S.$$.fragment,e),z(V.$$.fragment,e),G&&G.end(1),H=!0)},o(n){N(d),N(S.$$.fragment,n),N(V.$$.fragment,n),n&&(G=P(t,e[3],{duration:150})),H=!1},d(e){e&&m(t),~c&&Q[c].d(),I(S),I(V),e&&G&&G.end(),q=!1,T(Z)}}}function rt(e,t,n){let l;S(e,Ke,(e=>n(2,l=e)));let{file:a}=t,{onRemove:s}=t;return e.$$set=e=>{"file"in e&&n(0,a=e.file),"onRemove"in e&&n(1,s=e.onRemove)},[a,s,l,(e,t)=>{const n=e.clientHeight;return Object.assign(Object.assign({easing:U},t),{css:(e,t)=>`z-index: 1; margin-top: -${t*n}px; opacity: ${e};`})}]}class ot extends o{constructor(e){super(),i(this,e,rt,st,c,{file:0,onRemove:1})}}function it(e){let t,n,l;return{c(){t=b("div"),n=d("svg"),l=d("circle"),this.h()},l(e){t=E(e,"DIV",{class:!0});var a=u(t);n=f(a,"svg",{viewBox:!0,height:!0,width:!0});var s=u(n);l=f(s,"circle",{class:!0,cx:!0,cy:!0,r:!0,fill:!0,stroke:!0,"stroke-width":!0}),u(l).forEach(m),s.forEach(m),a.forEach(m),this.h()},h(){h(l,"class","circle indeterminate svelte-2axl0b"),h(l,"cx","44"),h(l,"cy","44"),h(l,"r","20.2"),h(l,"fill","none"),h(l,"stroke","currentColor"),h(l,"stroke-width","3.6"),h(n,"viewBox","22 22 44 44"),h(n,"height",e[0]),h(n,"width",e[0]),h(t,"class","circular-progress svelte-2axl0b")},m(e,a){p(e,t,a),v(t,n),v(n,l)},p(e,[t]){1&t&&h(n,"height",e[0]),1&t&&h(n,"width",e[0])},i:$,o:$,d(e){e&&m(t)}}}function ct(e,t,n){let{size:l="1em"}=t;return e.$$set=e=>{"size"in e&&n(0,l=e.size)},[l]}class dt extends o{constructor(e){super(),i(this,e,ct,it,c,{size:0})}}function ft(e,t,n){const l=e.slice();return l[14]=t[n],l}function ut(e){let t,n,l;return n=new dt({props:{size:"100%"}}),{c(){t=b("x-loading"),y(n.$$.fragment),this.h()},l(e){t=E(e,"X-LOADING",{class:!0});var l=u(t);O(n.$$.fragment,l),l.forEach(m),this.h()},h(){C(t,"class","svelte-1l68ord")},m(e,a){p(e,t,a),M(n,t,null),l=!0},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){N(n.$$.fragment,e),l=!1},d(e){e&&m(t),I(n)}}}function mt(e){let t,n,l,a,s=e[0].files.length+"";return{c(){t=b("x-bubble"),n=x(s),this.h()},l(e){t=E(e,"X-BUBBLE",{class:!0});var l=u(t);n=k(l,s),l.forEach(m),this.h()},h(){C(t,"class","svelte-1l68ord")},m(e,l){p(e,t,l),v(t,n),a=!0},p(e,t){(!a||1&t)&&s!==(s=e[0].files.length+"")&&B(n,s)},i(e){a||(e&&H((()=>{l||(l=q(t,Z,{duration:200},!0)),l.run(1)})),a=!0)},o(e){e&&(l||(l=q(t,Z,{duration:200},!1)),l.run(0)),a=!1},d(e){e&&m(t),e&&l&&l.end()}}}function ht(e){let t,n,l,a,s,r,o,i,c,$,g,A,R,L,P,T,S,U,V=[],F=new Map,G=e[4].Add+"",Z=e[0].files;const W=e=>e[14];for(let d=0;d<Z.length;d+=1){let t=ft(e,Z,d),n=W(t);F.set(n,V[d]=pt(n,t))}return L=new Te({}),{c(){t=b("x-popup"),n=d("svg"),l=d("path"),a=w(),s=b("x-popup-body"),r=b("x-scroll");for(let e=0;e<V.length;e+=1)V[e].c();o=w(),i=b("x-popup-top"),c=b("x-label"),$=w(),g=b("button"),A=x(G),R=w(),y(L.$$.fragment),this.h()},l(e){t=E(e,"X-POPUP",{class:!0});var d=u(t);n=f(d,"svg",{class:!0,viewBox:!0,preserveAspectRatio:!0});var h=u(n);l=f(h,"path",{d:!0,fill:!0}),u(l).forEach(m),h.forEach(m),a=j(d),s=E(d,"X-POPUP-BODY",{class:!0});var p=u(s);r=E(p,"X-SCROLL",{class:!0});var v=u(r);for(let t=0;t<V.length;t+=1)V[t].l(v);v.forEach(m),o=j(p),i=E(p,"X-POPUP-TOP",{class:!0});var b=u(i);c=E(b,"X-LABEL",{class:!0}),u(c).forEach(m),$=j(b),g=E(b,"BUTTON",{class:!0});var w=u(g);A=k(w,G),R=j(w),O(L.$$.fragment,w),w.forEach(m),b.forEach(m),p.forEach(m),d.forEach(m),this.h()},h(){h(l,"d","M0 0 L24 0 L12 24 L 0 0"),h(l,"fill","#fff"),h(n,"class","arrow svelte-1l68ord"),h(n,"viewBox","0 0 24 24"),h(n,"preserveAspectRatio","none"),C(r,"class","svelte-1l68ord"),C(c,"class","svelte-1l68ord"),h(g,"class","add btn-dark svelte-1l68ord"),C(i,"class","svelte-1l68ord"),C(s,"class","svelte-1l68ord"),C(t,"class","svelte-1l68ord")},m(d,f){p(d,t,f),v(t,n),v(n,l),v(t,a),v(t,s),v(s,r);for(let e=0;e<V.length;e+=1)V[e].m(r,null);v(s,o),v(s,i),v(i,c),v(i,$),v(i,g),v(g,A),v(g,R),M(L,g,null),T=!0,S||(U=D(g,"click",e[10]),S=!0)},p(e,t){33&t&&(Z=e[0].files,_(),V=K(V,t,W,1,e,Z,F,r,J,pt,null,ft),X()),(!T||16&t)&&G!==(G=e[4].Add+"")&&B(A,G)},i(e){if(!T){for(let e=0;e<Z.length;e+=1)z(V[e]);z(L.$$.fragment,e),e&&H((()=>{P||(P=q(t,Q,{x:0,y:20,duration:250},!0)),P.run(1)})),T=!0}},o(e){for(let t=0;t<V.length;t+=1)N(V[t]);N(L.$$.fragment,e),e&&(P||(P=q(t,Q,{x:0,y:20,duration:250},!1)),P.run(0)),T=!1},d(e){e&&m(t);for(let t=0;t<V.length;t+=1)V[t].d();I(L),e&&P&&P.end(),S=!1,U()}}}function pt(e,t){let n,l,a;function s(){return t[9](t[14])}return l=new ot({props:{file:t[14],onRemove:s}}),{key:e,first:null,c(){n=Y(),y(l.$$.fragment),this.h()},l(e){n=Y(),O(l.$$.fragment,e),this.h()},h(){this.first=n},m(e,t){p(e,n,t),M(l,e,t),a=!0},p(e,n){t=e;const a={};1&n&&(a.file=t[14]),1&n&&(a.onRemove=s),l.$set(a)},i(e){a||(z(l.$$.fragment,e),a=!0)},o(e){N(l.$$.fragment,e),a=!1},d(e){e&&m(n),I(l,e)}}}function vt(e){let t,n,l,a,s,r,o,i,c,d,f,$,g,x;s=new G({});let k=e[2]>0&&ut(),A=e[0].files.length&&mt(e);c=new Te({});let B=e[1]&&ht(e);return{c(){t=b("x-upload"),n=b("input"),l=w(),a=b("x-action"),y(s.$$.fragment),r=w(),k&&k.c(),o=w(),A&&A.c(),i=w(),y(c.$$.fragment),f=w(),B&&B.c(),this.h()},l(e){t=E(e,"X-UPLOAD",{class:!0});var d=u(t);n=E(d,"INPUT",{type:!0,name:!0,id:!0,class:!0}),l=j(d),a=E(d,"X-ACTION",{class:!0});var h=u(a);O(s.$$.fragment,h),r=j(h),k&&k.l(h),o=j(h),A&&A.l(h),i=j(h),O(c.$$.fragment,h),h.forEach(m),f=j(d),B&&B.l(d),d.forEach(m),this.h()},h(){h(n,"type","file"),h(n,"name","0-upload"),h(n,"id","0-upload"),n.multiple=!0,h(n,"class","svelte-1l68ord"),C(a,"class","upload btn-dark svelte-1l68ord"),W(a,"hover",e[1]),C(t,"class","svelte-1l68ord")},m(u,m){p(u,t,m),v(t,n),e[8](n),v(t,l),v(t,a),M(s,a,null),v(a,r),k&&k.m(a,null),v(a,o),A&&A.m(a,null),v(a,i),M(c,a,null),v(t,f),B&&B.m(t,null),$=!0,g||(x=[D(n,"change",e[6]),R(d=Se.call(null,a,e[1]?null:e[4].Attach)),D(a,"click",e[7])],g=!0)},p(e,[n]){e[2]>0?k?4&n&&z(k,1):(k=ut(),k.c(),z(k,1),k.m(a,o)):k&&(_(),N(k,1,1,(()=>{k=null})),X()),e[0].files.length?A?(A.p(e,n),1&n&&z(A,1)):(A=mt(e),A.c(),z(A,1),A.m(a,i)):A&&(_(),N(A,1,1,(()=>{A=null})),X()),d&&L(d.update)&&18&n&&d.update.call(null,e[1]?null:e[4].Attach),2&n&&W(a,"hover",e[1]),e[1]?B?(B.p(e,n),2&n&&z(B,1)):(B=ht(e),B.c(),z(B,1),B.m(t,null)):B&&(_(),N(B,1,1,(()=>{B=null})),X())},i(e){$||(z(s.$$.fragment,e),z(k),z(A),z(c.$$.fragment,e),z(B),$=!0)},o(e){N(s.$$.fragment,e),N(k),N(A),N(c.$$.fragment,e),N(B),$=!1},d(n){n&&m(t),e[8](null),I(s),k&&k.d(),A&&A.d(),I(c),B&&B.d(),g=!1,T(x)}}}function $t(e,t,n){let l;S(e,Ke,(e=>n(4,l=e)));var a=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(a,s){function r(e){try{i(l.next(e))}catch(t){s(t)}}function o(e){try{i(l.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}i((l=l.apply(e,t||[])).next())}))};let s,{draft:r}=t,{open:o=!1}=t,{loading:i=0}=t;const c=e=>{n(0,r.files=r.files.filter((t=>t!==e)),r)},d=e=>a(void 0,void 0,void 0,(function*(){n(2,i++,i);try{let t={id:void 0,size:e.size,contentType:e.type,filename:e.name,[an]:"uploading",[ln]:e,[rn]:0};n(0,r.files=[...r.files,t],r);const{id:l}=yield f(e,(e=>{t[rn]=e.loaded,n(0,r.files=[...r.files],r)}));if(null==l)throw new Error("No 'id' in response");t.id=l,t[an]="complete",n(0,r.files=[...r.files],r),n(2,i--,i)}catch(t){e[an]="error",e[sn]=String(null==t?void 0:t.message),delete e[ln],n(0,r.files=[...r.files],r),n(2,i--,i)}})),f=(e,t)=>a(void 0,void 0,void 0,(function*(){const n=(yield Ze((()=>import("./index-2204b0a9.js").then((function(e){return e.i}))),[])).default;return yield n.post(`/api/storage?filename=${encodeURIComponent(e.name)}&contentType=${encodeURIComponent(e.type)}`,e,{headers:{"content-type":"application/binary"},onUploadProgress:t}).then((e=>{const t=e.data;if(null==t?void 0:t.error)throw new Error(t.error.message);return t})).catch((t=>{if(t.response){const n=t.response;if("application/json"===n.headers["content-type"]){const e=n.data;throw e.error?new Error(e.error.message):t}throw 413===n.status?new Error(`File ${e.name} is too big`):t}}))}));return e.$$set=e=>{"draft"in e&&n(0,r=e.draft),"open"in e&&n(1,o=e.open),"loading"in e&&n(2,i=e.loading)},[r,o,i,s,l,c,()=>{for(const e of[].slice.call(s.files))r.files.find((t=>t[ln]===e))||(n(1,o=!0),d(e))},()=>{0!==r.files.length||o?n(1,o=!o):null==s||s.click()},function(e){ee[e?"unshift":"push"]((()=>{s=e,n(3,s)}))},e=>c(e),()=>null==s?void 0:s.click()]}class gt extends o{constructor(e){super(),i(this,e,$t,vt,c,{draft:0,open:1,loading:2})}}function bt(e){let t,n,l,a,s=e[6]("bold"),r=e[6]("italic"),o=e[6]("underline"),i=s&&function(e){let t,n,l,a,s,r;return n=new re({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Bold)),D(t,"click",e[11])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Bold)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e),c=r&&function(e){let t,n,l,a,s,r;return n=new oe({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Italic)),D(t,"click",e[12])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Italic)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e),d=o&&function(e){let t,n,l,a,s,r;return n=new ie({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Underline)),D(t,"click",e[13])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Underline)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e);return{c(){t=b("x-command-group"),i&&i.c(),n=w(),c&&c.c(),l=w(),d&&d.c()},l(e){t=E(e,"X-COMMAND-GROUP",{});var a=u(t);i&&i.l(a),n=j(a),c&&c.l(a),l=j(a),d&&d.l(a),a.forEach(m)},m(e,s){p(e,t,s),i&&i.m(t,null),v(t,n),c&&c.m(t,null),v(t,l),d&&d.m(t,null),a=!0},p(e,t){s&&i.p(e,t),r&&c.p(e,t),o&&d.p(e,t)},i(e){a||(z(i),z(c),z(d),a=!0)},o(e){N(i),N(c),N(d),a=!1},d(e){e&&m(t),i&&i.d(),c&&c.d(),d&&d.d()}}}function wt(e){let t,n,l,a,s=e[6]("justifyLeft"),r=e[6]("justifyCenter"),o=e[6]("justifyRight"),i=s&&function(e){let t,n,l,a,s,r;return n=new ce({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Align_left)),D(t,"click",e[14])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Align_left)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e),c=r&&function(e){let t,n,l,a,s,r;return n=new de({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Align_center)),D(t,"click",e[15])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Align_center)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e),d=o&&function(e){let t,n,l,a,s,r;return n=new fe({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Align_right)),D(t,"click",e[16])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Align_right)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e);return{c(){t=b("x-command-group"),i&&i.c(),n=w(),c&&c.c(),l=w(),d&&d.c()},l(e){t=E(e,"X-COMMAND-GROUP",{});var a=u(t);i&&i.l(a),n=j(a),c&&c.l(a),l=j(a),d&&d.l(a),a.forEach(m)},m(e,s){p(e,t,s),i&&i.m(t,null),v(t,n),c&&c.m(t,null),v(t,l),d&&d.m(t,null),a=!0},p(e,t){s&&i.p(e,t),r&&c.p(e,t),o&&d.p(e,t)},i(e){a||(z(i),z(c),z(d),a=!0)},o(e){N(i),N(c),N(d),a=!1},d(e){e&&m(t),i&&i.d(),c&&c.d(),d&&d.d()}}}function xt(e){let t,n,l,a=e[6]("insertUnorderedList"),s=e[6]("insertOrderedList"),r=a&&function(e){let t,n,l,a,s,r;return n=new ue({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].List)),D(t,"click",e[17])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].List)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e),o=s&&function(e){let t,n,l,a,s,r;return n=new me({}),{c(){t=b("x-command"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(o,i){p(o,t,i),M(n,t,null),a=!0,s||(r=[R(l=Se.call(null,t,e[2].Numbered_list)),D(t,"click",e[18])],s=!0)},p(e,t){l&&L(l.update)&&4&t&&l.update.call(null,e[2].Numbered_list)},i(e){a||(z(n.$$.fragment,e),a=!0)},o(e){N(n.$$.fragment,e),a=!1},d(e){e&&m(t),I(n),s=!1,T(r)}}}(e);return{c(){t=b("x-command-group"),r&&r.c(),n=w(),o&&o.c()},l(e){t=E(e,"X-COMMAND-GROUP",{});var l=u(t);r&&r.l(l),n=j(l),o&&o.l(l),l.forEach(m)},m(e,a){p(e,t,a),r&&r.m(t,null),v(t,n),o&&o.m(t,null),l=!0},p(e,t){a&&r.p(e,t),s&&o.p(e,t)},i(e){l||(z(r),z(o),l=!0)},o(e){N(r),N(o),l=!1},d(e){e&&m(t),r&&r.d(),o&&o.d()}}}function yt(e){let t,n,l,a;return n=new dt({}),{c(){t=b("div"),y(n.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var l=u(t);O(n.$$.fragment,l),l.forEach(m),this.h()},h(){h(t,"class","sending-progress svelte-ecbj8s")},m(e,l){p(e,t,l),M(n,t,null),a=!0},i(e){a||(z(n.$$.fragment,e),e&&H((()=>{l||(l=q(t,Z,{duration:250},!0)),l.run(1)})),a=!0)},o(e){N(n.$$.fragment,e),e&&(l||(l=q(t,Z,{duration:250},!1)),l.run(0)),a=!1},d(e){e&&m(t),I(n),e&&l&&l.end()}}}function Et(e){let t,n,l,a,s,r,o,i,c,d,f,$,g,A,P,S,U,V,F,G,H,q=e[3]("undo","redo"),Z=e[6]("fontName"),K=e[6]("fontSize"),J=e[4]("bold","italic","underline"),Q=e[4]("foreColor","backColor"),Y=e[4]("justifyLeft","justifyCenter","justifyRight"),le=e[4]("insertUnorderedList","insertOrderedList"),re=e[6]("removeFormat"),oe=e[2].Send+"",ie=q&&function(e){let t,n,l,a,s,r,o,i,c,d,f;return l=new ae({}),o=new se({}),{c(){t=b("x-command-group"),n=b("x-command"),y(l.$$.fragment),s=w(),r=b("x-command"),y(o.$$.fragment)},l(e){t=E(e,"X-COMMAND-GROUP",{});var a=u(t);n=E(a,"X-COMMAND",{});var i=u(n);O(l.$$.fragment,i),i.forEach(m),s=j(a),r=E(a,"X-COMMAND",{});var c=u(r);O(o.$$.fragment,c),c.forEach(m),a.forEach(m)},m(u,m){p(u,t,m),v(t,n),M(l,n,null),v(t,s),v(t,r),M(o,r,null),c=!0,d||(f=[R(a=Se.call(null,n,e[2].Undo)),D(n,"click",e[9]),R(i=Se.call(null,r,e[2].Redo)),D(r,"click",e[10])],d=!0)},p(e,t){a&&L(a.update)&&4&t&&a.update.call(null,e[2].Undo),i&&L(i.update)&&4&t&&i.update.call(null,e[2].Redo)},i(e){c||(z(l.$$.fragment,e),z(o.$$.fragment,e),c=!0)},o(e){N(l.$$.fragment,e),N(o.$$.fragment,e),c=!1},d(e){e&&m(t),I(l),I(o),d=!1,T(f)}}}(e),ce=Z&&function(e){let t,n,l;return n=new Ve({props:{label:e[2].Font_type}}),{c(){t=b("x-command-group"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND-GROUP",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(e,a){p(e,t,a),M(n,t,null),l=!0},p(e,t){const l={};4&t&&(l.label=e[2].Font_type),n.$set(l)},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){N(n.$$.fragment,e),l=!1},d(e){e&&m(t),I(n)}}}(e),de=K&&function(e){let t,n,l;return n=new Fe({props:{label:e[2].Font_size}}),{c(){t=b("x-command-group"),y(n.$$.fragment)},l(e){t=E(e,"X-COMMAND-GROUP",{});var l=u(t);O(n.$$.fragment,l),l.forEach(m)},m(e,a){p(e,t,a),M(n,t,null),l=!0},p(e,t){const l={};4&t&&(l.label=e[2].Font_size),n.$set(l)},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){N(n.$$.fragment,e),l=!1},d(e){e&&m(t),I(n)}}}(e),fe=J&&bt(e),ue=Q&&function(e){let t,n;return t=new Ge({}),{c(){y(t.$$.fragment)},l(e){O(t.$$.fragment,e)},m(e,l){M(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){N(t.$$.fragment,e),n=!1},d(e){I(t,e)}}}(),me=Y&&wt(e),pe=le&&xt(e),ve=re&&function(e){let t,n,l,a,s,r,o;return l=new he({}),{c(){t=b("x-command-group"),n=b("x-command"),y(l.$$.fragment)},l(e){t=E(e,"X-COMMAND-GROUP",{});var a=u(t);n=E(a,"X-COMMAND",{});var s=u(n);O(l.$$.fragment,s),s.forEach(m),a.forEach(m)},m(i,c){p(i,t,c),v(t,n),M(l,n,null),s=!0,r||(o=[R(a=Se.call(null,n,e[2].Remove_format)),D(n,"click",e[19])],r=!0)},p(e,t){a&&L(a.update)&&4&t&&a.update.call(null,e[2].Remove_format)},i(e){s||(z(l.$$.fragment,e),s=!0)},o(e){N(l.$$.fragment,e),s=!1},d(e){e&&m(t),I(l),r=!1,T(o)}}}(e);function $e(t){e[20](t)}let ge={};void 0!==e[0]&&(ge.draft=e[0]),$=new gt({props:ge}),ee.push((()=>te($,"draft",$e)));let be=e[1]&&yt();return{c(){t=b("x-toolbar"),n=b("x-commands"),ie&&ie.c(),l=w(),ce&&ce.c(),a=w(),de&&de.c(),s=w(),fe&&fe.c(),r=w(),ue&&ue.c(),o=w(),me&&me.c(),i=w(),pe&&pe.c(),c=w(),ve&&ve.c(),d=w(),f=b("x-send-up"),y($.$$.fragment),A=w(),P=b("button"),S=b("div"),U=x(oe),V=w(),be&&be.c(),this.h()},l(e){t=E(e,"X-TOOLBAR",{class:!0});var h=u(t);n=E(h,"X-COMMANDS",{class:!0});var p=u(n);ie&&ie.l(p),l=j(p),ce&&ce.l(p),a=j(p),de&&de.l(p),s=j(p),fe&&fe.l(p),r=j(p),ue&&ue.l(p),o=j(p),me&&me.l(p),i=j(p),pe&&pe.l(p),c=j(p),ve&&ve.l(p),p.forEach(m),d=j(h),f=E(h,"X-SEND-UP",{class:!0});var v=u(f);O($.$$.fragment,v),A=j(v),P=E(v,"BUTTON",{class:!0});var g=u(P);S=E(g,"DIV",{class:!0});var b=u(S);U=k(b,oe),b.forEach(m),V=j(g),be&&be.l(g),g.forEach(m),v.forEach(m),h.forEach(m),this.h()},h(){C(n,"class","elev3 thin-scroll svelte-ecbj8s"),h(S,"class","send-label svelte-ecbj8s"),h(P,"class","send elev2 btn-light svelte-ecbj8s"),W(P,"sending",e[1]),C(f,"class","svelte-ecbj8s"),C(t,"class","svelte-ecbj8s")},m(u,m){p(u,t,m),v(t,n),ie&&ie.m(n,null),v(n,l),ce&&ce.m(n,null),v(n,a),de&&de.m(n,null),v(n,s),fe&&fe.m(n,null),v(n,r),ue&&ue.m(n,null),v(n,o),me&&me.m(n,null),v(n,i),pe&&pe.m(n,null),v(n,c),ve&&ve.m(n,null),v(t,d),v(t,f),M($,f,null),v(f,A),v(f,P),v(P,S),v(S,U),v(P,V),be&&be.m(P,null),F=!0,G||(H=D(P,"click",e[7]),G=!0)},p(e,[t]){q&&ie.p(e,t),Z&&ce.p(e,t),K&&de.p(e,t),J&&fe.p(e,t),Y&&me.p(e,t),le&&pe.p(e,t),re&&ve.p(e,t);const n={};!g&&1&t&&(g=!0,n.draft=e[0],ne((()=>g=!1))),$.$set(n),(!F||4&t)&&oe!==(oe=e[2].Send+"")&&B(U,oe),e[1]?be?2&t&&z(be,1):(be=yt(),be.c(),z(be,1),be.m(P,null)):be&&(_(),N(be,1,1,(()=>{be=null})),X()),2&t&&W(P,"sending",e[1])},i(e){F||(z(ie),z(ce),z(de),z(fe),z(ue),z(me),z(pe),z(ve),z($.$$.fragment,e),z(be),F=!0)},o(e){N(ie),N(ce),N(de),N(fe),N(ue),N(me),N(pe),N(ve),N($.$$.fragment,e),N(be),F=!1},d(e){e&&m(t),ie&&ie.d(),ce&&ce.d(),de&&de.d(),fe&&fe.d(),ue&&ue.d(),me&&me.d(),pe&&pe.d(),ve&&ve.d(),I($),be&&be.d(),G=!1,H()}}}function jt(e,t,n){let l;S(e,Ke,(e=>n(2,l=e)));var a=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(a,s){function r(e){try{i(l.next(e))}catch(t){s(t)}}function o(e){try{i(l.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}i((l=l.apply(e,t||[])).next())}))};let{draft:s}=t,{onRemove:r}=t,{sending:o=!1}=t;const{all:i,any:c,cmd:d,has:f}=le("editor"),u=Be((()=>a(void 0,void 0,void 0,(function*(){if(0===s.to.length&&0===s.cc.length&&0===s.bcc.length)throw new Error("This message has no recipients");n(1,o=!0);try{n(0,s[un]=!0,s),yield bn(s),n(1,o=!1),_e(l.notifier.Message_sent),r()}catch(e){throw n(0,s[un]=!1,s),n(1,o=!1),e}}))));return e.$$set=e=>{"draft"in e&&n(0,s=e.draft),"onRemove"in e&&n(8,r=e.onRemove),"sending"in e&&n(1,o=e.sending)},[s,o,l,i,c,d,f,u,r,()=>d("undo"),()=>d("redo"),()=>d("bold"),()=>d("italic"),()=>d("underline"),()=>d("justifyLeft"),()=>d("justifyCenter"),()=>d("justifyRight"),()=>d("insertUnorderedList"),()=>d("insertOrderedList"),()=>d("removeFormat"),function(e){s=e,n(0,s)}]}class kt extends o{constructor(e){super(),i(this,e,jt,Et,c,{draft:0,onRemove:8,sending:1})}}function Ot(e){let t,n,l,a,s,r,o,i,c;function d(t){e[5](t)}let f={onRemove:e[1]};return void 0!==e[0]&&(f.draft=e[0]),s=new kt({props:f}),ee.push((()=>te(s,"draft",d))),{c(){t=b("div"),n=b("div"),l=w(),a=b("div"),y(s.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var r=u(t);n=E(r,"DIV",{class:!0}),u(n).forEach(m),l=j(r),a=E(r,"DIV",{class:!0});var o=u(a);O(s.$$.fragment,o),o.forEach(m),r.forEach(m),this.h()},h(){h(n,"class","contents svelte-1l0mhlg"),h(a,"class","bar"),h(t,"class","editor svelte-1l0mhlg")},m(r,d){p(r,t,d),v(t,n),v(t,l),v(t,a),M(s,a,null),o=!0,i||(c=R(e[3].call(null,n)),i=!0)},p(e,[t]){const n={};2&t&&(n.onRemove=e[1]),!r&&1&t&&(r=!0,n.draft=e[0],ne((()=>r=!1))),s.$set(n)},i(e){o||(z(s.$$.fragment,e),o=!0)},o(e){N(s.$$.fragment,e),o=!1},d(e){e&&m(t),I(s),i=!1,c()}}}function At(e,t,n){let l;var a=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(a,s){function r(e){try{i(l.next(e))}catch(t){s(t)}}function o(e){try{i(l.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}i((l=l.apply(e,t||[])).next())}))};let{draft:s}=t,{onRemove:r}=t,{iframe:o}=t;const i=ve(null);S(e,i,(e=>n(6,l=e)));const c=ve(null),d=e=>document.queryCommandSupported(e),f={_document:i,_window:c,has:d,cmd:(e,t)=>null==l?void 0:l.execCommand(e,null,t),any:(...e)=>e.some((e=>d(e))),all:(...e)=>e.every((e=>d(e)))};pe("editor",f);return e.$$set=e=>{"draft"in e&&n(0,s=e.draft),"onRemove"in e&&n(1,r=e.onRemove),"iframe"in e&&n(4,o=e.iframe)},[s,r,i,e=>(n(4,o=document.createElement("iframe")),o.setAttribute("sandbox","allow-forms allow-same-origin"),n(4,o.srcdoc="<!doctype html><html><head></head><body></body></html>",o),e.appendChild(o),Promise.resolve().then((()=>a(void 0,void 0,void 0,(function*(){yield new Promise((e=>n(4,o.onload=e,o)));const e=o.contentDocument,t=o.contentWindow;f._document.set(e),f._window.set(t),e.documentElement.classList.add("editor-content");const l=e.createElement("style");l.textContent=He,e.head.appendChild(l),e.body.contentEditable="true",e.body.innerHTML=s.html;new MutationObserver((()=>{n(0,s.html=e.body.innerHTML,s),n(0,s.text=e.body.textContent,s)})).observe(e.body,{childList:!0,characterData:!0,attributes:!0,subtree:!0})})))),{destroy:()=>{e.removeChild(o)}}),o,function(e){s=e,n(0,s)}]}class Ct extends o{constructor(e){super(),i(this,e,At,Ot,c,{draft:0,onRemove:1,iframe:4})}}function Mt(e,t,n){const l=e.slice();return l[14]=t[n],l[16]=n,l}function Rt(e){let t,n,l,a,s,r,o,i,c=e[14].address+"";function d(){return e[10](e[16])}return s=new g({}),{c(){t=b("x-addr"),n=x(c),l=w(),a=b("x-addr-close"),y(s.$$.fragment),this.h()},l(e){t=E(e,"X-ADDR",{class:!0});var r=u(t);n=k(r,c),l=j(r),a=E(r,"X-ADDR-CLOSE",{class:!0});var o=u(a);O(s.$$.fragment,o),o.forEach(m),r.forEach(m),this.h()},h(){C(a,"class","svelte-8vkngb"),C(t,"class","svelte-8vkngb")},m(e,c){p(e,t,c),v(t,n),v(t,l),v(t,a),M(s,a,null),r=!0,o||(i=D(a,"click",d),o=!0)},p(t,l){e=t,(!r||1&l)&&c!==(c=e[14].address+"")&&B(n,c)},i(e){r||(z(s.$$.fragment,e),r=!0)},o(e){N(s.$$.fragment,e),r=!1},d(e){e&&m(t),I(s),o=!1,i()}}}function Dt(e){let t,n,l,a,s,r,o=e[0],i=[];for(let d=0;d<o.length;d+=1)i[d]=Rt(Mt(e,o,d));const c=e=>N(i[e],1,1,(()=>{i[e]=null}));return{c(){t=b("label");for(let e=0;e<i.length;e+=1)i[e].c();n=w(),l=b("input"),this.h()},l(e){t=E(e,"LABEL",{class:!0});var a=u(t);for(let t=0;t<i.length;t+=1)i[t].l(a);n=j(a),l=E(a,"INPUT",{type:!0,autocomplete:!0,name:!0,id:!0,class:!0}),a.forEach(m),this.h()},h(){h(l,"type","text"),h(l,"autocomplete","off"),h(l,"name",e[3]),h(l,"id",e[4]),h(l,"class","svelte-8vkngb"),h(t,"class","addr-input svelte-8vkngb")},m(o,c){p(o,t,c);for(let e=0;e<i.length;e+=1)i[e].m(t,null);v(t,n),v(t,l),e[11](l),$e(l,e[1]),a=!0,s||(r=[D(l,"keypress",e[5]),D(l,"blur",e[7]),D(l,"keydown",e[6]),D(l,"input",e[12]),D(l,"input",e[9])],s=!0)},p(e,[s]){if(257&s){let l;for(o=e[0],l=0;l<o.length;l+=1){const a=Mt(e,o,l);i[l]?(i[l].p(a,s),z(i[l],1)):(i[l]=Rt(a),i[l].c(),z(i[l],1),i[l].m(t,n))}for(_(),l=o.length;l<i.length;l+=1)c(l);X()}(!a||8&s)&&h(l,"name",e[3]),(!a||16&s)&&h(l,"id",e[4]),2&s&&l.value!==e[1]&&$e(l,e[1])},i(e){if(!a){for(let e=0;e<o.length;e+=1)z(i[e]);a=!0}},o(e){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)N(i[t]);a=!1},d(n){n&&m(t),ge(i,n),e[11](null),s=!1,T(r)}}}function Lt(e,t,n){let{name:l=""}=t,{id:a=""}=t,{addrs:s=[]}=t,{value:r=""}=t,{input:o=null}=t;const i=()=>{const e=r.trim();e&&(s.some((t=>t.address===e))||(n(0,s=[...s,{address:e,name:""}]),n(1,r="")))},c=i,d=e=>{const t=s.slice();t.splice(e,1),n(0,s=t)};return e.$$set=e=>{"name"in e&&n(3,l=e.name),"id"in e&&n(4,a=e.id),"addrs"in e&&n(0,s=e.addrs),"value"in e&&n(1,r=e.value),"input"in e&&n(2,o=e.input)},[s,r,o,l,a,e=>{"Enter"===e.key&&i()},e=>{"Backspace"===e.key&&s.length&&o.selectionStart===o.selectionEnd&&0===o.selectionStart&&n(0,s=s.slice(0,s.length-1))},c,d,function(t){be.call(this,e,t)},e=>d(e),function(e){ee[e?"unshift":"push"]((()=>{o=e,n(2,o)}))},function(){r=this.value,n(1,r)}]}class Bt extends o{constructor(e){super(),i(this,e,Lt,Dt,c,{name:3,id:4,addrs:0,value:1,input:2})}}function _t(e){let t,n;return{c(){t=d("svg"),n=d("path"),this.h()},l(e){t=f(e,"svg",{width:!0,height:!0,viewBox:!0});var l=u(t);n=f(l,"path",{d:!0,fill:!0}),u(n).forEach(m),l.forEach(m),this.h()},h(){h(n,"d","M0,24H24V20H0V24Z"),h(n,"fill",e[2]),h(t,"width",e[0]),h(t,"height",e[1]),h(t,"viewBox",e[3])},m(e,l){p(e,t,l),v(t,n)},p(e,[l]){4&l&&h(n,"fill",e[2]),1&l&&h(t,"width",e[0]),2&l&&h(t,"height",e[1]),8&l&&h(t,"viewBox",e[3])},i:$,o:$,d(e){e&&m(t)}}}function Nt(e,t,n){let{size:l="1em"}=t,{width:a=l}=t,{height:s=l}=t,{color:r="currentColor"}=t,{viewBox:o="0 0 24 24"}=t;return e.$$set=e=>{"size"in e&&n(4,l=e.size),"width"in e&&n(0,a=e.width),"height"in e&&n(1,s=e.height),"color"in e&&n(2,r=e.color),"viewBox"in e&&n(3,o=e.viewBox)},[a,s,r,o,l]}class Xt extends o{constructor(e){super(),i(this,e,Nt,_t,c,{size:4,width:0,height:1,color:2,viewBox:3})}}function zt(e){let t,n;return{c(){t=d("svg"),n=d("path"),this.h()},l(e){t=f(e,"svg",{width:!0,height:!0,viewBox:!0});var l=u(t);n=f(l,"path",{d:!0,fill:!0}),u(n).forEach(m),l.forEach(m),this.h()},h(){h(n,"d","M12,10A2,2 0 0,0 10,12C10,13.11 10.9,14 12,14C13.11,14 14,13.11 14,12A2,2 0 0,0 12,10Z"),h(n,"fill",e[2]),h(t,"width",e[0]),h(t,"height",e[1]),h(t,"viewBox",e[3])},m(e,l){p(e,t,l),v(t,n)},p(e,[l]){4&l&&h(n,"fill",e[2]),1&l&&h(t,"width",e[0]),2&l&&h(t,"height",e[1]),8&l&&h(t,"viewBox",e[3])},i:$,o:$,d(e){e&&m(t)}}}function Pt(e,t,n){let{size:l="1em"}=t,{width:a=l}=t,{height:s=l}=t,{color:r="currentColor"}=t,{viewBox:o="0 0 24 24"}=t;return e.$$set=e=>{"size"in e&&n(4,l=e.size),"width"in e&&n(0,a=e.width),"height"in e&&n(1,s=e.height),"color"in e&&n(2,r=e.color),"viewBox"in e&&n(3,o=e.viewBox)},[a,s,r,o,l]}class It extends o{constructor(e){super(),i(this,e,Pt,zt,c,{size:4,width:0,height:1,color:2,viewBox:3})}}function Tt(e){let t,n,l,a;return n=new It({}),{c(){t=b("div"),y(n.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var l=u(t);O(n.$$.fragment,l),l.forEach(m),this.h()},h(){h(t,"class","saving-icon svelte-bvwpjo")},m(e,l){p(e,t,l),M(n,t,null),a=!0},i(s){a||(z(n.$$.fragment,s),s&&H((()=>{l||(l=q(t,e[10],{},!0)),l.run(1)})),a=!0)},o(s){N(n.$$.fragment,s),s&&(l||(l=q(t,e[10],{},!1)),l.run(0)),a=!1},d(e){e&&m(t),I(n),e&&l&&l.end()}}}function St(e){let t,n,l,a,s=e[9].Cc+"";return{c(){t=b("span"),n=x(s),this.h()},l(e){t=E(e,"SPAN",{class:!0});var l=u(t);n=k(l,s),l.forEach(m),this.h()},h(){h(t,"class","svelte-bvwpjo")},m(s,r){p(s,t,r),v(t,n),l||(a=D(t,"click",we(e[14])),l=!0)},p(e,t){512&t&&s!==(s=e[9].Cc+"")&&B(n,s)},d(e){e&&m(t),l=!1,a()}}}function Ut(e){let t,n,l,a,s=e[9].Bcc+"";return{c(){t=b("span"),n=x(s),this.h()},l(e){t=E(e,"SPAN",{class:!0});var l=u(t);n=k(l,s),l.forEach(m),this.h()},h(){h(t,"class","svelte-bvwpjo")},m(s,r){p(s,t,r),v(t,n),l||(a=D(t,"click",we(e[15])),l=!0)},p(e,t){512&t&&s!==(s=e[9].Bcc+"")&&B(n,s)},d(e){e&&m(t),l=!1,a()}}}function Vt(e){let t,n,l,a,s,r,o,i,c=e[9]["Cc:"]+"";function d(t){e[16](t)}function f(t){e[17](t)}let $={id:"compose-cc",name:"cc"};return void 0!==e[0].cc&&($.addrs=e[0].cc),void 0!==e[4]&&($.input=e[4]),s=new Bt({props:$}),ee.push((()=>te(s,"addrs",d))),ee.push((()=>te(s,"input",f))),{c(){t=b("label"),n=b("x-label"),l=x(c),a=w(),y(s.$$.fragment),this.h()},l(e){t=E(e,"LABEL",{class:!0,for:!0});var r=u(t);n=E(r,"X-LABEL",{class:!0});var o=u(n);l=k(o,c),o.forEach(m),a=j(r),O(s.$$.fragment,r),r.forEach(m),this.h()},h(){C(n,"class","svelte-bvwpjo"),h(t,"class","label-input svelte-bvwpjo"),h(t,"for","compose-cc")},m(e,r){p(e,t,r),v(t,n),v(n,l),v(t,a),M(s,t,null),i=!0},p(e,t){(!i||512&t)&&c!==(c=e[9]["Cc:"]+"")&&B(l,c);const n={};!r&&1&t&&(r=!0,n.addrs=e[0].cc,ne((()=>r=!1))),!o&&16&t&&(o=!0,n.input=e[4],ne((()=>o=!1))),s.$set(n)},i(e){i||(z(s.$$.fragment,e),i=!0)},o(e){N(s.$$.fragment,e),i=!1},d(e){e&&m(t),I(s)}}}function Ft(e){let t,n,l,a,s,r,o,i,c=e[9]["Bcc:"]+"";function d(t){e[18](t)}function f(t){e[19](t)}let $={id:"compose-bcc",name:"bcc"};return void 0!==e[0].bcc&&($.addrs=e[0].bcc),void 0!==e[5]&&($.input=e[5]),s=new Bt({props:$}),ee.push((()=>te(s,"addrs",d))),ee.push((()=>te(s,"input",f))),{c(){t=b("label"),n=b("x-label"),l=x(c),a=w(),y(s.$$.fragment),this.h()},l(e){t=E(e,"LABEL",{class:!0,for:!0});var r=u(t);n=E(r,"X-LABEL",{class:!0});var o=u(n);l=k(o,c),o.forEach(m),a=j(r),O(s.$$.fragment,r),r.forEach(m),this.h()},h(){C(n,"class","svelte-bvwpjo"),h(t,"class","label-input svelte-bvwpjo"),h(t,"for","compose-bcc")},m(e,r){p(e,t,r),v(t,n),v(n,l),v(t,a),M(s,t,null),i=!0},p(e,t){(!i||512&t)&&c!==(c=e[9]["Bcc:"]+"")&&B(l,c);const n={};!r&&1&t&&(r=!0,n.addrs=e[0].bcc,ne((()=>r=!1))),!o&&32&t&&(o=!0,n.input=e[5],ne((()=>o=!1))),s.$set(n)},i(e){i||(z(s.$$.fragment,e),i=!0)},o(e){N(s.$$.fragment,e),i=!1},d(e){e&&m(t),I(s)}}}function Gt(e){let t,n,l,a,s,r,o,i,c,d,f,$,A,R,S,U,V,F,G,q,Z,K,J,Q,W,Y,le,ae,se,re,oe,ie,ce,de,fe,ue,me,he,pe,ve,ge,be,we,Ee,je,ke=e[9].New_message+"",Oe=e[9]["To:"]+"",Ae=e[9]["Subject:"]+"",Ce=!e[6]&&Tt(e);function Me(t){e[13](t)}c=new Xt({}),f=new Te({}),R=new g({}),U=new Te({});let Re={id:"compose-to",name:"to"};void 0!==e[0].to&&(Re.addrs=e[0].to),Q=new Bt({props:Re}),ee.push((()=>te(Q,"addrs",Me)));let De=!e[8]&&St(e),Le=!e[7]&&Ut(e),Be=e[8]&&Vt(e),_e=e[7]&&Ft(e);function Ne(t){e[21](t)}function Xe(t){e[22](t)}let ze={onRemove:e[2]};return void 0!==e[0]&&(ze.draft=e[0]),void 0!==e[3]&&(ze.iframe=e[3]),he=new Ct({props:ze}),ee.push((()=>te(he,"draft",Ne))),ee.push((()=>te(he,"iframe",Xe))),{c(){t=b("div"),n=b("div"),l=b("div"),a=b("div"),Ce&&Ce.c(),s=w(),r=x(ke),o=w(),i=b("div"),y(c.$$.fragment),d=w(),y(f.$$.fragment),$=w(),A=b("div"),y(R.$$.fragment),S=w(),y(U.$$.fragment),V=w(),F=b("div"),G=b("x-metadata"),q=b("label"),Z=b("x-label"),K=x(Oe),J=w(),y(Q.$$.fragment),Y=w(),le=b("x-toggle-cc"),De&&De.c(),ae=w(),Le&&Le.c(),se=w(),Be&&Be.c(),re=w(),_e&&_e.c(),oe=w(),ie=b("label"),ce=b("x-label"),de=x(Ae),fe=w(),ue=b("input"),me=w(),y(he.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var h=u(t);n=E(h,"DIV",{class:!0});var p=u(n);l=E(p,"DIV",{class:!0});var v=u(l);a=E(v,"DIV",{class:!0});var g=u(a);Ce&&Ce.l(g),g.forEach(m),s=j(v),r=k(v,ke),v.forEach(m),o=j(p),i=E(p,"DIV",{class:!0});var b=u(i);O(c.$$.fragment,b),d=j(b),O(f.$$.fragment,b),b.forEach(m),$=j(p),A=E(p,"DIV",{class:!0});var w=u(A);O(R.$$.fragment,w),S=j(w),O(U.$$.fragment,w),w.forEach(m),p.forEach(m),V=j(h),F=E(h,"DIV",{class:!0});var x=u(F);G=E(x,"X-METADATA",{class:!0});var y=u(G);q=E(y,"LABEL",{class:!0,for:!0});var C=u(q);Z=E(C,"X-LABEL",{class:!0});var M=u(Z);K=k(M,Oe),M.forEach(m),J=j(C),O(Q.$$.fragment,C),Y=j(C),le=E(C,"X-TOGGLE-CC",{class:!0});var D=u(le);De&&De.l(D),ae=j(D),Le&&Le.l(D),D.forEach(m),C.forEach(m),se=j(y),Be&&Be.l(y),re=j(y),_e&&_e.l(y),oe=j(y),ie=E(y,"LABEL",{class:!0,for:!0});var L=u(ie);ce=E(L,"X-LABEL",{class:!0});var B=u(ce);de=k(B,Ae),B.forEach(m),fe=j(L),ue=E(L,"INPUT",{type:!0,name:!0,id:!0,class:!0,autocomplete:!0}),L.forEach(m),y.forEach(m),me=j(x),O(he.$$.fragment,x),x.forEach(m),h.forEach(m),this.h()},h(){h(a,"class","saving svelte-bvwpjo"),h(l,"class","window-title svelte-bvwpjo"),h(i,"class","btn-light window-btn window-minimize svelte-bvwpjo"),h(A,"class","window-btn window-close btn-light svelte-bvwpjo"),h(n,"class","window-top svelte-bvwpjo"),C(Z,"class","svelte-bvwpjo"),C(le,"class","svelte-bvwpjo"),h(q,"class","label-input svelte-bvwpjo"),h(q,"for","compose-to"),C(ce,"class","svelte-bvwpjo"),h(ue,"type","text"),h(ue,"name","subject"),h(ue,"id","compose-subject"),h(ue,"class","subject svelte-bvwpjo"),h(ue,"autocomplete","off"),h(ie,"class","label-input svelte-bvwpjo"),h(ie,"for","compose-subject"),C(G,"class","svelte-bvwpjo"),h(F,"class","window-contents svelte-bvwpjo"),h(t,"class","window svelte-bvwpjo")},m(u,m){p(u,t,m),v(t,n),v(n,l),v(l,a),Ce&&Ce.m(a,null),v(l,s),v(l,r),v(n,o),v(n,i),M(c,i,null),v(i,d),M(f,i,null),v(n,$),v(n,A),M(R,A,null),v(A,S),M(U,A,null),v(t,V),v(t,F),v(F,G),v(G,q),v(q,Z),v(Z,K),v(q,J),M(Q,q,null),v(q,Y),v(q,le),De&&De.m(le,null),v(le,ae),Le&&Le.m(le,null),v(G,se),Be&&Be.m(G,null),v(G,re),_e&&_e.m(G,null),v(G,oe),v(G,ie),v(ie,ce),v(ce,de),v(ie,fe),v(ie,ue),$e(ue,e[0].subject),v(F,me),M(he,F,null),we=!0,Ee||(je=[D(i,"click",xe((function(){L(e[1])&&e[1].apply(this,arguments)}))),D(A,"click",xe((function(){L(e[2])&&e[2].apply(this,arguments)}))),D(n,"click",(function(){L(e[1])&&e[1].apply(this,arguments)})),D(n,"auxclick",(function(){L(e[2])&&e[2].apply(this,arguments)})),D(ue,"input",e[20])],Ee=!0)},p(t,[n]){(e=t)[6]?Ce&&(_(),N(Ce,1,1,(()=>{Ce=null})),X()):Ce?64&n&&z(Ce,1):(Ce=Tt(e),Ce.c(),z(Ce,1),Ce.m(a,null)),(!we||512&n)&&ke!==(ke=e[9].New_message+"")&&B(r,ke),(!we||512&n)&&Oe!==(Oe=e[9]["To:"]+"")&&B(K,Oe);const l={};!W&&1&n&&(W=!0,l.addrs=e[0].to,ne((()=>W=!1))),Q.$set(l),e[8]?De&&(De.d(1),De=null):De?De.p(e,n):(De=St(e),De.c(),De.m(le,ae)),e[7]?Le&&(Le.d(1),Le=null):Le?Le.p(e,n):(Le=Ut(e),Le.c(),Le.m(le,null)),e[8]?Be?(Be.p(e,n),256&n&&z(Be,1)):(Be=Vt(e),Be.c(),z(Be,1),Be.m(G,re)):Be&&(_(),N(Be,1,1,(()=>{Be=null})),X()),e[7]?_e?(_e.p(e,n),128&n&&z(_e,1)):(_e=Ft(e),_e.c(),z(_e,1),_e.m(G,oe)):_e&&(_(),N(_e,1,1,(()=>{_e=null})),X()),(!we||512&n)&&Ae!==(Ae=e[9]["Subject:"]+"")&&B(de,Ae),1&n&&ue.value!==e[0].subject&&$e(ue,e[0].subject);const s={};4&n&&(s.onRemove=e[2]),!pe&&1&n&&(pe=!0,s.draft=e[0],ne((()=>pe=!1))),!ve&&8&n&&(ve=!0,s.iframe=e[3],ne((()=>ve=!1))),he.$set(s)},i(n){we||(z(Ce),z(c.$$.fragment,n),z(f.$$.fragment,n),z(R.$$.fragment,n),z(U.$$.fragment,n),z(Q.$$.fragment,n),z(Be),z(_e),z(he.$$.fragment,n),H((()=>{be&&be.end(1),ge=ye(t,mn,{key:e[0]}),ge.start()})),we=!0)},o(n){N(Ce),N(c.$$.fragment,n),N(f.$$.fragment,n),N(R.$$.fragment,n),N(U.$$.fragment,n),N(Q.$$.fragment,n),N(Be),N(_e),N(he.$$.fragment,n),ge&&ge.invalidate(),be=P(t,hn,{key:e[0]}),we=!1},d(e){e&&m(t),Ce&&Ce.d(),I(c),I(f),I(R),I(U),I(Q),De&&De.d(),Le&&Le.d(),Be&&Be.d(),_e&&_e.d(),I(he),e&&be&&be.end(),Ee=!1,T(je)}}}function Ht(e,t,n){let l,a,s;S(e,Ke,(e=>n(9,s=e)));var r,o,i=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(a,s){function r(e){try{i(l.next(e))}catch(t){s(t)}}function o(e){try{i(l.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}i((l=l.apply(e,t||[])).next())}))},c=this&&this.__rest||function(e,t){var n={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(n[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(l=Object.getOwnPropertySymbols(e);a<l.length;a++)t.indexOf(l[a])<0&&Object.prototype.propertyIsEnumerable.call(e,l[a])&&(n[l[a]]=e[l[a]])}return n};let d,f,u,m,{current:h}=t,{onMinimize:p}=t,{onRemove:v}=t,$=Ne(h),g=1,b=!0;const w=(e,t)=>i(void 0,void 0,void 0,(function*(){if(e[un])return;const l=yield gn(e);e.id=l,t===g&&n(6,b=!0)})),x=(e,t)=>{const n=c(e,["id","key"]),l=c(t,["id","key"]);return Xe(n,l)};Ee((()=>{const e=e=>{"Escape"===e.key&&p()},t=[Ue(document,"keydown",e,{capture:!0})];return d&&d.contentDocument&&t.push(Ue(d.contentDocument,"keydown",e,{capture:!0})),()=>{b||w(h,++g),clearTimeout(m),T(t)}}));return e.$$set=e=>{"current"in e&&n(0,h=e.current),"onMinimize"in e&&n(1,p=e.onMinimize),"onRemove"in e&&n(2,v=e.onRemove)},e.$$.update=()=>{2049&e.$$.dirty&&n(8,l=(null==h?void 0:h[fn])||(null===n(11,r=null==h?void 0:h.bcc)||void 0===r?void 0:r.length)),4097&e.$$.dirty&&n(7,a=(null==h?void 0:h[dn])||(null===n(12,o=null==h?void 0:h.cc)||void 0===o?void 0:o.length)),1&e.$$.dirty&&(e=>{if(x($,e))return;$=Ne(e),n(6,b=!1);const t=++g;clearTimeout(m),m=setTimeout((()=>w(e,t)),1500)})(h)},[h,p,v,d,f,u,b,a,l,s,(e,t)=>{const n=getComputedStyle(e),l=parseInt(n.width)+parseFloat(n.marginInlineEnd);return parseFloat(n.marginInlineStart),{css:(e,t)=>`margin-inline-start: -${t*l}px; transform: scale(${e});`,duration:100}},r,o,function(t){e.$$.not_equal(h.to,t)&&(h.to=t,n(0,h))},()=>{n(0,h[fn]=!0,h),setTimeout((()=>f&&f.focus()),5)},()=>{n(0,h[dn]=!0,h),setTimeout((()=>u&&u.focus()),5)},function(t){e.$$.not_equal(h.cc,t)&&(h.cc=t,n(0,h))},function(e){f=e,n(4,f)},function(t){e.$$.not_equal(h.bcc,t)&&(h.bcc=t,n(0,h))},function(e){u=e,n(5,u)},function(){h.subject=this.value,n(0,h)},function(e){h=e,n(0,h)},function(e){d=e,n(3,d)}]}class qt extends o{constructor(e){super(),i(this,e,Ht,Gt,c,{current:0,onMinimize:1,onRemove:2})}}function Zt(e,t,n){const l=e.slice();return l[21]=t[n],l}function Kt(e){let t,n,l=[],a=new Map,s=e[1];const r=e=>e[21];for(let o=0;o<s.length;o+=1){let t=Zt(e,s,o),n=r(t);a.set(n,l[o]=Qt(n,t))}return{c(){t=b("div");for(let e=0;e<l.length;e+=1)l[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var n=u(t);for(let t=0;t<l.length;t+=1)l[t].l(n);n.forEach(m),this.h()},h(){h(t,"class","tabs svelte-1xk3i4p")},m(e,a){p(e,t,a);for(let n=0;n<l.length;n+=1)l[n].m(t,null);n=!0},p(e,n){if(15&n){s=e[1],_();for(let e=0;e<l.length;e+=1)l[e].r();l=K(l,n,r,1,e,s,a,t,je,Qt,null,Zt);for(let e=0;e<l.length;e+=1)l[e].a();X()}},i(e){if(!n){for(let e=0;e<s.length;e+=1)z(l[e]);n=!0}},o(e){for(let t=0;t<l.length;t+=1)N(l[t]);n=!1},d(e){e&&m(t);for(let t=0;t<l.length;t+=1)l[t].d()}}}function Jt(e){let t,n,l,a,s,r,o,i,c,d,f,$,A,C,R,L=e[3].New_message+"";function _(){return e[9](e[21])}function X(...t){return e[10](e[21],...t)}function S(){return e[11](e[21])}return s=new g({}),o=new Te({}),{c(){t=b("div"),n=x(L),l=w(),a=b("div"),y(s.$$.fragment),r=w(),y(o.$$.fragment),i=w(),c=b("div"),this.h()},l(e){t=E(e,"DIV",{class:!0});var d=u(t);n=k(d,L),l=j(d),a=E(d,"DIV",{class:!0});var f=u(a);O(s.$$.fragment,f),r=j(f),O(o.$$.fragment,f),f.forEach(m),i=j(d),c=E(d,"DIV",{class:!0}),u(c).forEach(m),d.forEach(m),this.h()},h(){h(a,"class","btn-light tab-remove svelte-1xk3i4p"),h(c,"class","tab-sender svelte-1xk3i4p"),h(t,"class","tab svelte-1xk3i4p")},m(e,d){p(e,t,d),v(t,n),v(t,l),v(t,a),M(s,a,null),v(a,r),M(o,a,null),v(t,i),v(t,c),A=!0,C||(R=[D(a,"click",xe(_)),D(t,"click",X),D(t,"auxclick",S)],C=!0)},p(t,l){e=t,(!A||8&l)&&L!==(L=e[3].New_message+"")&&B(n,L)},i(n){A||(z(s.$$.fragment,n),z(o.$$.fragment,n),H((()=>{f&&f.end(1),d=ye(c,mn,{key:e[21]}),d.start()})),H((()=>{$||($=q(t,ke,{duration:300},!0)),$.run(1)})),A=!0)},o(n){N(s.$$.fragment,n),N(o.$$.fragment,n),d&&d.invalidate(),f=P(c,hn,{key:e[21]}),$||($=q(t,ke,{duration:300},!1)),$.run(0),A=!1},d(e){e&&m(t),I(s),I(o),e&&f&&f.end(),e&&$&&$.end(),C=!1,T(R)}}}function Qt(e,t){let n,l,a,s,r=$,o=t[21]!==t[2]&&Jt(t);return{key:e,first:null,c(){n=b("div"),o&&o.c(),l=w(),this.h()},l(e){n=E(e,"DIV",{class:!0});var t=u(n);o&&o.l(t),l=j(t),t.forEach(m),this.h()},h(){h(n,"class","tab-holder svelte-1xk3i4p"),this.first=n},m(e,t){p(e,n,t),o&&o.m(n,null),v(n,l),s=!0},p(e,a){(t=e)[21]!==t[2]?o?(o.p(t,a),6&a&&z(o,1)):(o=Jt(t),o.c(),z(o,1),o.m(n,l)):o&&(_(),N(o,1,1,(()=>{o=null})),X())},r(){a=n.getBoundingClientRect()},f(){Oe(n),r()},a(){r(),r=Ae(n,a,Ce,{duration:250})},i(e){s||(z(o),s=!0)},o(e){N(o),s=!1},d(e){e&&m(n),o&&o.d()}}}function Wt(e){let t,n,l,a,s,r,o,i=e[2].key,d=Yt(e);return{c(){t=b("div"),l=w(),d.c(),a=Y(),this.h()},l(e){t=E(e,"DIV",{class:!0}),u(t).forEach(m),l=j(e),d.l(e),a=Y(),this.h()},h(){h(t,"class","overlay svelte-1xk3i4p")},m(n,i){p(n,t,i),p(n,l,i),d.m(n,i),p(n,a,i),s=!0,r||(o=D(t,"click",e[12]),r=!0)},p(e,t){4&t&&c(i,i=e[2].key)?(_(),N(d,1,1,$),X(),d=Yt(e),d.c(),z(d),d.m(a.parentNode,a)):d.p(e,t)},i(e){s||(e&&H((()=>{n||(n=q(t,ke,{duration:300},!0)),n.run(1)})),z(d),s=!0)},o(e){e&&(n||(n=q(t,ke,{duration:300},!1)),n.run(0)),N(d),s=!1},d(e){e&&m(t),e&&n&&n.end(),e&&m(l),e&&m(a),d.d(e),r=!1,o()}}}function Yt(e){let t,n,l;function a(t){e[15](t)}let s={onMinimize:e[13],onRemove:e[14]};return void 0!==e[2]&&(s.current=e[2]),t=new qt({props:s}),ee.push((()=>te(t,"current",a))),{c(){y(t.$$.fragment)},l(e){O(t.$$.fragment,e)},m(e,n){M(t,e,n),l=!0},p(e,l){const a={};4&l&&(a.onMinimize=e[13]),4&l&&(a.onRemove=e[14]),!n&&4&l&&(n=!0,a.current=e[2],ne((()=>n=!1))),t.$set(a)},i(e){l||(z(t.$$.fragment,e),l=!0)},o(e){N(t.$$.fragment,e),l=!1},d(e){I(t,e)}}}function en(e){let t,n,l,a=e[1].length&&Kt(e),s=e[2]&&Wt(e);return{c(){a&&a.c(),t=w(),s&&s.c(),n=Y()},l(e){a&&a.l(e),t=j(e),s&&s.l(e),n=Y()},m(e,r){a&&a.m(e,r),p(e,t,r),s&&s.m(e,r),p(e,n,r),l=!0},p(e,[l]){e[1].length?a?(a.p(e,l),2&l&&z(a,1)):(a=Kt(e),a.c(),z(a,1),a.m(t.parentNode,t)):a&&(_(),N(a,1,1,(()=>{a=null})),X()),e[2]?s?(s.p(e,l),4&l&&z(s,1)):(s=Wt(e),s.c(),z(s,1),s.m(n.parentNode,n)):s&&(_(),N(s,1,1,(()=>{s=null})),X())},i(e){l||(z(a),z(s),l=!0)},o(e){N(a),N(s),l=!1},d(e){a&&a.d(e),e&&m(t),s&&s.d(e),e&&m(n)}}}function tn(e,t,n){let l;S(e,Ke,(e=>n(3,l=e)));var a=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(a,s){function r(e){try{i(l.next(e))}catch(t){s(t)}}function o(e){try{i(l.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}i((l=l.apply(e,t||[])).next())}))};let s=[],r=null;const o=`#compose-${Date.now().toString(36)}`;Ee((()=>({destroy:Ue(window,"hashchange",(()=>{r&&location.hash!==o&&n(2,r=null)}))})));const i=e=>{r===e&&n(2,r=null),n(1,s=s.filter((t=>t!==e)))},c=e=>{var t;e instanceof Array&&(e=e.join(""));const n=De.sanitize(e||"",{RETURN_DOM:!0}),l=n.querySelectorAll("style, link, script, meta, object, head, title");for(let a=0;a<l.length;a++){const e=l[a];null===(t=e.parentNode)||void 0===t||t.removeChild(e)}return{html:n.innerHTML,text:n.textContent}},d=(e,t)=>{var n;return["<br />".repeat(6),Me(qe),"<br/>".repeat(2),"-".repeat(10)+" "+("re"===e?"Reply message":"Forwarded message")+" "+"-".repeat(10),t.from&&`From: <b>${Re(t.from.name)||""}</b> ${Re("<"+t.from.address+">")}`,t.to&&t.to.length&&`To: ${t.to.map((e=>Re(e.address))).join(", ")}`,"Subject: "+Re(t.subject),"Date: "+Re(new Date(t.date).toUTCString())].filter(Boolean).join("<br />")+"<br/>".repeat(4)+(null===(n=t.html)||void 0===n?void 0:n.join(""))||""},f=(e,t)=>a(void 0,void 0,void 0,(function*(){const l=s.find((e=>e.id===t));if(l)n(2,r=l);else{const l=yield Pe(`/api/mailboxes/${e.id}/messages/${t}`),{html:a,text:o}=c(l.html),i={key:Math.random(),id:l.id,mailbox:l.mailbox,bcc:l.bcc||[],cc:l.cc||[],to:l.to||[],subject:l.subject,html:a,text:o,reference:l.reference,files:l.files||[],[dn]:!1,[fn]:!1,[un]:!1};n(1,s=[i,...s]),n(2,r=i)}}));return e.$$.update=()=>{var t;6&e.$$.dirty&&(s.includes(r)||n(2,r=null)),4&e.$$.dirty&&((t=r)&&location.hash!==o&&(location.hash=o),t||location.hash!==o||history.back())},[i,s,r,l,e=>a(void 0,void 0,void 0,(function*(){const t=`${"<br />".repeat(6)}${Me(qe)}`,{html:n,text:l}=c(t),a=cn({subject:"",html:n,text:l}),s=yield ze(`/api/mailboxes/${e.id}/messages`,a);yield f(e,s.message.id)})),(e,t,n)=>a(void 0,void 0,void 0,(function*(){const l=yield Pe(`/api/mailboxes/${t.id}/messages/${n}`),a=d("re",l),{html:s,text:r}=c(a),o=`Re: ${l.subject.trim().replace(/^re:/i,"").trim()}`,i=cn({to:l.from?[l.from]:[],subject:o,html:s,text:r,reference:{mailbox:t.id,id:n,action:"reply",attachments:!1}}),u=yield ze(`/api/mailboxes/${e.id}/messages`,i);yield f(e,u.message.id)})),(e,t,n,l)=>a(void 0,void 0,void 0,(function*(){var a,s;const r=yield Pe(`/api/mailboxes/${n.id}/messages/${l}`),o=d("re",r),{html:i,text:u}=c(o),m=`Re: ${r.subject.trim().replace(/^re:/i,"").trim()}`,h=[r.from];if(r.to)for(const t of r.to)t.address.toLowerCase()!==(null===(a=e.address)||void 0===a?void 0:a.toLowerCase())&&h.push(t);const p=[];if(r.cc)for(const t of r.cc)t.address.toLowerCase()!==(null===(s=e.address)||void 0===s?void 0:s.toLowerCase())&&p.push(t);const v=cn({to:h,cc:p,subject:m,html:i,text:u,reference:{mailbox:n.id,id:l,action:"replyAll",attachments:!1}}),$=yield ze(`/api/mailboxes/${t.id}/messages`,v);yield f(t,$.message.id)})),(e,t,n)=>a(void 0,void 0,void 0,(function*(){const l=yield Pe(`/api/mailboxes/${t.id}/messages/${n}`),a=d("fwd",l),{html:s,text:r}=c(a),o=`Fwd: ${l.subject.trim().replace(/^fw?d?:/i,"").trim()}`,i=cn({subject:o,html:s,text:r,reference:{mailbox:t.id,id:n,action:"forward",attachments:!0}}),u=yield ze(`/api/mailboxes/${e.id}/messages`,i);yield f(e,u.message.id)})),f,e=>i(e),(e,t)=>t.ctrlKey?i(e):n(2,r=e),e=>i(e),()=>n(2,r=null),()=>n(2,r=null),()=>i(r),function(e){r=e,n(2,r),n(1,s)}]}class nn extends o{constructor(e){super(),i(this,e,tn,en,c,{removeTab:0,blank:4,reply:5,replyAll:6,forward:7,open:8})}get removeTab(){return this.$$.ctx[0]}get blank(){return this.$$.ctx[4]}get reply(){return this.$$.ctx[5]}get replyAll(){return this.$$.ctx[6]}get forward(){return this.$$.ctx[7]}get open(){return this.$$.ctx[8]}}const ln=Symbol("draft-file-file"),an=Symbol("draft-file-state"),sn=Symbol("draft-file-error"),rn=Symbol("draft-file-loaded"),on={draft:!0,to:[],cc:[],bcc:[],subject:"",html:"",text:"",reference:void 0,files:void 0},cn=e=>Object.assign({},on,e),dn=Symbol("draft-show-cc"),fn=Symbol("draft-show-cc"),un=Symbol("draft-sent"),[mn,hn]=Le({duration:300,fallback:e=>Q(e,{duration:300,y:20})});let pn=null;const vn=()=>(null==pn&&(pn=new nn({target:document.body})),pn),$n=()=>{null!=pn&&(pn.$destroy(),pn=null)},gn=async e=>{const o=e,{id:i,mailbox:c,key:d,files:f}=o,u=((e,t)=>{var n={};for(var r in e)a.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&l)for(var r of l(e))t.indexOf(r)<0&&s.call(e,r)&&(n[r]=e[r]);return n})(o,["id","mailbox","key","files"]),{message:m}=await ze(`/api/mailboxes/${e.mailbox}/messages`,cn((h=((e,t)=>{for(var n in t||(t={}))a.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))s.call(t,n)&&r(e,n,t[n]);return e})({},u),p={files:null==f?void 0:f.map((e=>e.id)).filter(Boolean)},t(h,n(p)))));var h,p;return Ie(`/api/mailboxes/${c}/messages/${i}`).catch((()=>{})),m.id},bn=async e=>{const t=await gn(e);e.id=t,await ze(`/api/mailboxes/${e.mailbox}/messages/${e.id}/submit`,{})},wn=async e=>{await vn().blank(e)},xn=async(e,t,n,l)=>{await vn().replyAll(e,t,n,l)},yn=async(e,t,n)=>{await vn().forward(e,t,n)},En=async(e,t)=>{await vn().open(e,t)};export{dt as C,wn as _,En as a,xn as b,yn as c,$n as d,et as u};
