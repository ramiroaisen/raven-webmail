import{S as t,i as e,s,ae as a,e as n,k as r,c as i,a as o,n as c,d as l,b as u,f as h,H as f,x as g,r as m,u as x,v as d,w as p,j as v,o as $,t as w,g as b,I as y,h as j,af as S,ag as D,ah as O,K as k,L as U,ad as I,a0 as E,ai as N,m as z,aj as J,ak as T,l as B,al as M,D as C,am as V,an as X,ao as q,ap as A,aq as F,ar as Y,as as _,at as H,au as L,W as P,av as K}from"./vendor-d7518362.js";import{r as R}from"./singletons-12a22614.js";import{l as W}from"./locale-0e600940.js";const G=R,Q=async function(t,e){return G.goto(t,e,[])};function Z(t,e,s){const a=t.slice();return a[1]=e[s],a}function tt(t){let e,s,a;var r=t[1].icon;return r&&(s=new r({})),{c(){e=n("div"),s&&v(s.$$.fragment),this.h()},l(t){e=i(t,"DIV",{class:!0});var a=o(e);s&&z(s.$$.fragment,a),a.forEach(l),this.h()},h(){u(e,"class","message-icon svelte-v1icgi")},m(t,n){h(t,e,n),s&&$(s,e,null),a=!0},p(t,a){if(r!==(r=t[1].icon)){if(s){m();const t=s;x(t.$$.fragment,1,0,(()=>{d(t,1)})),p()}r?(s=new r({}),v(s.$$.fragment),g(s.$$.fragment,1),$(s,e,null)):s=null}},i(t){a||(s&&g(s.$$.fragment,t),a=!0)},o(t){s&&x(s.$$.fragment,t),a=!1},d(t){t&&l(e),s&&d(s)}}}function et(t){let e,s=t[1].text+"";return{c(){e=w(s)},l(t){e=b(t,s)},m(t,s){h(t,e,s)},p(t,a){1&a&&s!==(s=t[1].text+"")&&j(e,s)},d(t){t&&l(e)}}}function st(t){let e,s,a=t[1].html+"";return{c(){e=new T,s=B(),this.h()},l(t){e=M(t),s=B(),this.h()},h(){e.a=s},m(t,n){e.m(a,t,n),h(t,s,n)},p(t,s){1&s&&a!==(a=t[1].html+"")&&e.p(a)},d(t){t&&l(s),t&&e.d()}}}function at(t){let e,s,a,r,c,g=t[1].action.text+"";function m(...e){return t[11](t[1],...e)}return{c(){e=n("div"),s=n("button"),a=w(g),this.h()},l(t){e=i(t,"DIV",{class:!0});var n=o(e);s=i(n,"BUTTON",{class:!0});var r=o(s);a=b(r,g),r.forEach(l),n.forEach(l),this.h()},h(){u(s,"class","btn-light"),u(e,"class","message-action svelte-v1icgi")},m(t,n){h(t,e,n),f(e,s),f(s,a),r||(c=y(s,"click",m),r=!0)},p(e,s){t=e,1&s&&g!==(g=t[1].action.text+"")&&j(a,g)},d(t){t&&l(e),r=!1,c()}}}function nt(t,e){let s,a,d,v,$,w,b,y,j,E,N=C,z=e[1].icon&&tt(e);function T(t,e){return null!=t[1].html?st:et}let B=T(e),M=B(e),V=e[1].action&&at(e);return{key:t,first:null,c(){s=n("div"),z&&z.c(),a=r(),d=n("div"),M.c(),$=r(),V&&V.c(),w=r(),this.h()},l(t){s=i(t,"DIV",{class:!0});var e=o(s);z&&z.l(e),a=c(e),d=i(e,"DIV",{class:!0});var n=o(d);M.l(n),n.forEach(l),$=c(e),V&&V.l(e),w=c(e),e.forEach(l),this.h()},h(){u(d,"class",v="message-content "+(null!=e[1].html?"html":"text")+" svelte-v1icgi"),u(s,"class",b="message "+e[1].variant+" svelte-v1icgi"),this.first=s},m(t,e){h(t,s,e),z&&z.m(s,null),f(s,a),f(s,d),M.m(d,null),f(s,$),V&&V.m(s,null),f(s,w),E=!0},p(t,n){(e=t)[1].icon?z?(z.p(e,n),1&n&&g(z,1)):(z=tt(e),z.c(),g(z,1),z.m(s,a)):z&&(m(),x(z,1,1,(()=>{z=null})),p()),B===(B=T(e))&&M?M.p(e,n):(M.d(1),M=B(e),M&&(M.c(),M.m(d,null))),(!E||1&n&&v!==(v="message-content "+(null!=e[1].html?"html":"text")+" svelte-v1icgi"))&&u(d,"class",v),e[1].action?V?V.p(e,n):(V=at(e),V.c(),V.m(s,w)):V&&(V.d(1),V=null),(!E||1&n&&b!==(b="message "+e[1].variant+" svelte-v1icgi"))&&u(s,"class",b)},r(){j=s.getBoundingClientRect()},f(){S(s),N(),D(s,j)},a(){N(),N=O(s,j,J,{duration:200})},i(t){E||(g(z),k((()=>{y||(y=U(s,I,{x:-200,duration:250},!0)),y.run(1)})),E=!0)},o(t){x(z),y||(y=U(s,I,{x:-200,duration:250},!1)),y.run(0),E=!1},d(t){t&&l(s),z&&z.d(),M.d(),V&&V.d(),t&&y&&y.end()}}}function rt(t){let e,s,a=[],r=new Map,c=t[0];const f=t=>t[1];for(let n=0;n<c.length;n+=1){let e=Z(t,c,n),s=f(e);r.set(s,a[n]=nt(s,e))}return{c(){e=n("div");for(let t=0;t<a.length;t+=1)a[t].c();this.h()},l(t){e=i(t,"DIV",{class:!0});var s=o(e);for(let e=0;e<a.length;e+=1)a[e].l(s);s.forEach(l),this.h()},h(){u(e,"class","messenger svelte-v1icgi")},m(t,n){h(t,e,n);for(let s=0;s<a.length;s+=1)a[s].m(e,null);s=!0},p(t,[s]){if(1&s){c=t[0],m();for(let t=0;t<a.length;t+=1)a[t].r();a=E(a,s,f,1,t,c,r,e,N,nt,null,Z);for(let t=0;t<a.length;t+=1)a[t].a();p()}},i(t){if(!s){for(let t=0;t<c.length;t+=1)g(a[t]);s=!0}},o(t){for(let e=0;e<a.length;e+=1)x(a[e]);s=!1},d(t){t&&l(e);for(let e=0;e<a.length;e+=1)a[e].d()}}}function it(t,e,s){const a={success:V,error:X,info:q,warning:A};let{messages:n=[]}=e,{maxStack:r=3}=e,{duration:i=3e3}=e;const o=t=>{let e={variant:t.variant||"normal",text:t.text,html:t.html,icon:t.icon||(t.variant&&"normal"!==t.variant?a[t.variant]:null),persist:!!t.persist,duration:t.duration||i};s(0,n=[...n,e]),e.persist||setTimeout((()=>c(e)),e.duration),n.length>r&&s(0,n=n.slice(1))},c=t=>{s(0,n=n.filter((e=>e!=t)))};return t.$$set=t=>{"messages"in t&&s(0,n=t.messages),"maxStack"in t&&s(2,r=t.maxStack),"duration"in t&&s(3,i=t.duration)},[n,(t,e={})=>o(Object.assign({variant:"normal",text:t},e)),r,i,o,c,()=>{s(0,n=[])},(t,e={})=>o(Object.assign({variant:"success",text:t},e)),(t,e={})=>o(Object.assign({variant:"info",text:t},e)),(t,e={})=>o(Object.assign({variant:"warning",text:t},e)),(t,e={})=>o(Object.assign({variant:"error",text:t},e)),(t,e)=>t.action&&t.action.fn(e)]}class ot extends t{constructor(t){super(),e(this,t,it,rt,s,{messages:0,maxStack:2,duration:3,add:4,remove:5,clear:6,message:1,success:7,info:8,warn:9,error:10})}get messages(){return this.$$.ctx[0]}set messages(t){this.$$set({messages:t}),a()}get maxStack(){return this.$$.ctx[2]}set maxStack(t){this.$$set({maxStack:t}),a()}get duration(){return this.$$.ctx[3]}set duration(t){this.$$set({duration:t}),a()}get add(){return this.$$.ctx[4]}get remove(){return this.$$.ctx[5]}get clear(){return this.$$.ctx[6]}get message(){return this.$$.ctx[1]}get success(){return this.$$.ctx[7]}get info(){return this.$$.ctx[8]}get warn(){return this.$$.ctx[9]}get error(){return this.$$.ctx[10]}}let ct;const lt=()=>(null==ct&&(ct=new ot({target:document.body})),ct),ut=t=>{lt().error(t)},ht=t=>{lt().message(t)};class ft extends Error{constructor(t,e){super(e),this.status=t}}const gt=t=>{const e=F(W);return"INBOX"===t.path?e.mailboxes.Inbox:"\\Junk"===t.specialUse?e.mailboxes.Spam:"\\Sent"===t.specialUse?e.mailboxes.Sent:"\\Drafts"===t.specialUse?e.mailboxes.Drafts:"\\Trash"===t.specialUse?e.mailboxes.Trash:t.name},mt=t=>"INBOX"===t.path?Y:"\\Junk"===t.specialUse?_:"\\Sent"===t.specialUse?H:"\\Drafts"===t.specialUse?L:"\\Trash"===t.specialUse?P:K,xt=t=>"INBOX"!==t.path&&null==t.specialUse,dt=t=>"INBOX"===t.path,pt=t=>"\\Junk"===t.specialUse,vt=t=>"\\Sent"===t.specialUse,$t=t=>"\\Drafts"===t.specialUse,wt=t=>"\\Trash"===t.specialUse,bt=t=>{const e=t.find(dt),s=t.find($t),a=t.find(vt),n=t.find(pt),r=t.find(wt),i=[e,...t.filter((t=>!dt(t)&&null==t.specialUse)),s,a,n,r].filter(Boolean);for(const o of t)i.includes(o)||i.push(o);return i},yt=async({page:t,fetch:e,session:s})=>{var a;let n=(null==(a=t.query)?void 0:a.toString())||"";n=n?`?${n}`:"";const r="string"==typeof t?t:`/api/pages${t.path}${n}`;{const t=await e(r);return await t.json()}},jt=t=>async(...e)=>{try{return await t(...e)}catch(s){ut((null==s?void 0:s.message)||"Error")}},St=async t=>{const e=await fetch(t).catch((t=>{throw new ft(500,"Cannot connect to server")})),s=await e.json().catch((t=>{throw new ft(e.status,"Invalid JSON response from server")}));if(s.error)throw new ft(e.status,s.error.message);return s},Dt=async t=>{const e=await fetch(t,{method:"DELETE"}).catch((t=>{throw new ft(500,"Cannot connect to server")})),s=await e.json().catch((t=>{throw new ft(e.status,"Invalid JSON response from server")}));if(s.error)throw new ft(e.status,s.error.message);return s},Ot=async(t,e)=>{const s=await fetch(t,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).catch((t=>{throw new ft(500,"Cannot connect to server")})),a=await s.json().catch((t=>{throw new ft(s.status,"Invalid JSON response from server")}));if(a.error)throw new ft(s.status,a.error.message);return a},kt=async(t,e)=>{const s=await fetch(t,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).catch((t=>{throw new ft(500,"Cannot connect to server")})),a=await s.json().catch((t=>{throw new ft(s.status,"Invalid JSON response from server")}));if(a.error)throw new ft(s.status,a.error.message);return a},Ut=t=>/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i.test(t),It=()=>window.matchMedia("(max-width: 800px)").matches,Et=t=>{const e=new EventSource("/api/auth");return e.onmessage=e=>{const s=JSON.parse(e.data);s.username!==t&&(t=s.username,Q(null==t?"/login":"/"))},()=>e.close()},Nt=t=>{const e=F(W),s=new Date,a=new Date(t);return s.getFullYear()!==a.getFullYear()?`${e.month[a.getMonth()]} ${a.getFullYear()}`:s.getMonth()!==a.getMonth()?`${a.getDate()} ${e.month[a.getMonth()]}`:s.getDate()!==a.getDate()?`${e.week[a.getDay()]} ${a.getDate()}`:`${a.getHours()}:${n=a.getMinutes(),n.toString().padStart(2,"0")}`;var n},zt=t=>{if(t instanceof Date)return new Date(t);if(t instanceof Array)return t.map(zt);if("object"==typeof t&&null!==t){const e={};for(const s of Object.keys(t))e[s]=zt(t[s]);return e}return t},Jt=(t,e)=>{if(t instanceof Date&&e instanceof Date)return+t==+e;if(t instanceof Array){if(!(e instanceof Array))return!1;if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!Jt(t[s],e[s]))return!1;return!0}if("object"==typeof t&&null!==t){if("object"!=typeof e||null===e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s of Object.keys(t))if(!Jt(t[s],e[s]))return!1;return!0}return t===e};export{Dt as _,mt as a,jt as b,ht as c,kt as d,wt as e,$t as f,Q as g,ut as h,It as i,xt as j,Ot as k,St as l,gt as m,yt as n,zt as o,Jt as p,Ut as q,Nt as r,bt as s,pt as t,dt as u,vt as v,Et as w};
