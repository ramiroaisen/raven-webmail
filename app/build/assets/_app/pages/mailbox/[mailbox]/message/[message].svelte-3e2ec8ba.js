import{S as a,i as e,s as t,e as n,j as s,k as l,t as r,c,a as o,m as i,n as m,g as f,d as $,b as d,G as u,f as h,H as g,o as p,J as v,I as b,h as x,Q as w,a3 as k,x as D,u as E,v as I,N as _,l as V,r as y,w as j,E as M,aL as S,F as T,P as A,aw as F,aC as N,K as P,b4 as z,O as R,ac as B,D as L,bh as C,W as G,bi as H,ad as J,bj as K,bd as O,bc as Q,as as W,be as q}from"../../../../chunks/vendor-c6674e75.js";import{n as U,b as X,u as Y,v as Z,e as aa,_ as ea,g as ta,d as na,f as sa,x as la,m as ra}from"../../../../chunks/util-26aae2f7.js";import{t as ca,b as oa}from"../../../../chunks/MenuItem-f687bcf2.js";import{T as ia}from"../../../../chunks/TabTop-1c2ebbed.js";import{R as ma}from"../../../../chunks/Ripple-ada69b16.js";import{M as fa}from"../../../../chunks/MoveTo-75860a74.js";import{u as $a,b as da,c as ua}from"../../../../chunks/compose-0c636a4e.js";import{P as ha,M as ga}from"../../../../chunks/signature-38791045.js";import{l as pa}from"../../../../chunks/locale-43eac5b3.js";import"../../../../chunks/singletons-12a22614.js";import"../../../../chunks/preload-helper-ec9aa979.js";function va(a,e,t){const n=a.slice();return n[6]=e[t],n}function ba(a){let e,t,V,y,j,M,F,N,P,z,R,B,L,C,G,H,J=a[2].attachments.length+"";function K(e){a[4](e)}V=new S({});let O={anchor:"top-left",$$slots:{default:[ka]},$$scope:{ctx:a}};return void 0!==a[0]&&(O.open=a[0]),P=new ha({props:O}),T.push((()=>A(P,"open",K))),B=new ma({}),{c(){e=n("div"),t=n("div"),s(V.$$.fragment),y=l(),j=n("div"),M=r(J),F=l(),N=n("div"),s(P.$$.fragment),R=l(),s(B.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);t=c(n,"DIV",{class:!0});var s=o(t);i(V.$$.fragment,s),y=m(s),j=c(s,"DIV",{class:!0});var l=o(j);M=f(l,J),l.forEach($),F=m(s),N=c(s,"DIV",{class:!0});var r=o(N);i(P.$$.fragment,r),r.forEach($),R=m(s),i(B.$$.fragment,s),s.forEach($),n.forEach($),this.h()},h(){d(j,"class","count svelte-1as9z7t"),d(N,"class","anchor svelte-1as9z7t"),d(t,"class","action btn-dark"),u(t,"hover",a[0]),d(e,"class","action-group")},m(n,s){h(n,e,s),g(e,t),p(V,t,null),g(t,y),g(t,j),g(j,M),g(t,F),g(t,N),p(P,N,null),g(t,R),p(B,t,null),C=!0,G||(H=[v(L=ca.call(null,t,a[3].Attachments)),b(t,"click",a[5])],G=!0)},p(a,e){(!C||4&e)&&J!==(J=a[2].attachments.length+"")&&x(M,J);const n={};518&e&&(n.$$scope={dirty:e,ctx:a}),!z&&1&e&&(z=!0,n.open=a[0],w((()=>z=!1))),P.$set(n),L&&k(L.update)&&8&e&&L.update.call(null,a[3].Attachments),1&e&&u(t,"hover",a[0])},i(a){C||(D(V.$$.fragment,a),D(P.$$.fragment,a),D(B.$$.fragment,a),C=!0)},o(a){E(V.$$.fragment,a),E(P.$$.fragment,a),E(B.$$.fragment,a),C=!1},d(a){a&&$(e),I(V),I(P),I(B),G=!1,_(H)}}}function xa(a){let e,t,u,v,b,w,k,_,V,y,j,M=a[6].filename+"";return k=new ma({}),{c(){e=n("a"),t=n("div"),u=l(),v=n("div"),b=r(M),w=l(),s(k.$$.fragment),_=l(),this.h()},l(a){e=c(a,"A",{href:!0,class:!0,download:!0});var n=o(e);t=c(n,"DIV",{class:!0,style:!0}),o(t).forEach($),u=m(n),v=c(n,"DIV",{class:!0});var s=o(v);b=f(s,M),s.forEach($),w=m(n),i(k.$$.fragment,n),_=m(n),n.forEach($),this.h()},h(){d(t,"class","img svelte-1as9z7t"),F(t,"background-image","url("+$a(a[6].filename)+")"),d(v,"class","name svelte-1as9z7t"),d(e,"href",V="/api/mailboxes/"+a[1].id+"/messages/"+a[2].id+"/attachments/"+a[6].id),d(e,"class","na item btn-dark svelte-1as9z7t"),d(e,"download",y=a[6].filename)},m(a,n){h(a,e,n),g(e,t),g(e,u),g(e,v),g(v,b),g(e,w),p(k,e,null),g(e,_),j=!0},p(a,n){(!j||4&n)&&F(t,"background-image","url("+$a(a[6].filename)+")"),(!j||4&n)&&M!==(M=a[6].filename+"")&&x(b,M),(!j||6&n&&V!==(V="/api/mailboxes/"+a[1].id+"/messages/"+a[2].id+"/attachments/"+a[6].id))&&d(e,"href",V),(!j||4&n&&y!==(y=a[6].filename))&&d(e,"download",y)},i(a){j||(D(k.$$.fragment,a),j=!0)},o(a){E(k.$$.fragment,a),j=!1},d(a){a&&$(e),I(k)}}}function wa(a){let e,t,n=a[2].attachments,s=[];for(let r=0;r<n.length;r+=1)s[r]=xa(va(a,n,r));const l=a=>E(s[a],1,1,(()=>{s[a]=null}));return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=V()},l(a){for(let e=0;e<s.length;e+=1)s[e].l(a);e=V()},m(a,n){for(let e=0;e<s.length;e+=1)s[e].m(a,n);h(a,e,n),t=!0},p(a,t){if(6&t){let r;for(n=a[2].attachments,r=0;r<n.length;r+=1){const l=va(a,n,r);s[r]?(s[r].p(l,t),D(s[r],1)):(s[r]=xa(l),s[r].c(),D(s[r],1),s[r].m(e.parentNode,e))}for(y(),r=n.length;r<s.length;r+=1)l(r);j()}},i(a){if(!t){for(let a=0;a<n.length;a+=1)D(s[a]);t=!0}},o(a){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)E(s[e]);t=!1},d(a){N(s,a),a&&$(e)}}}function ka(a){let e,t;return e=new ga({props:{$$slots:{default:[wa]},$$scope:{ctx:a}}}),{c(){s(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,n){p(e,a,n),t=!0},p(a,t){const n={};518&t&&(n.$$scope={dirty:t,ctx:a}),e.$set(n)},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function Da(a){var e;let t,n,s=(null==(e=a[2].attachments)?void 0:e.length)&&ba(a);return{c(){s&&s.c(),t=V()},l(a){s&&s.l(a),t=V()},m(a,e){s&&s.m(a,e),h(a,t,e),n=!0},p(a,[e]){var n;(null==(n=a[2].attachments)?void 0:n.length)?s?(s.p(a,e),4&e&&D(s,1)):(s=ba(a),s.c(),D(s,1),s.m(t.parentNode,t)):s&&(y(),E(s,1,1,(()=>{s=null})),j())},i(a){n||(D(s),n=!0)},o(a){E(s),n=!1},d(a){s&&s.d(a),a&&$(t)}}}function Ea(a,e,t){let n;M(a,pa,(a=>t(3,n=a)));let{mailbox:s}=e,{message:l}=e,{open:r=!1}=e;return a.$$set=a=>{"mailbox"in a&&t(1,s=a.mailbox),"message"in a&&t(2,l=a.message),"open"in a&&t(0,r=a.open)},[r,s,l,n,function(a){r=a,t(0,r)},()=>t(0,r=!r)]}class Ia extends a{constructor(a){super(),e(this,a,Ea,Da,t,{mailbox:1,message:2,open:0})}}function _a(a,e,t){const n=a.slice();return n[17]=e[t],n[19]=t,n}function Va(a){let e,t;return e=new O({}),{c(){s(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,n){p(e,a,n),t=!0},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function ya(a){let e,t;return e=new Q({}),{c(){s(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,n){p(e,a,n),t=!0},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function ja(a){let e,t,r,f,u,x,w,V;return t=new W({}),f=new ma({}),{c(){e=n("div"),s(t.$$.fragment),r=l(),s(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);i(t.$$.fragment,n),r=m(n),i(f.$$.fragment,n),n.forEach($),this.h()},h(){d(e,"class","action btn-dark")},m(n,s){h(n,e,s),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].Mark_as_spam)),b(e,"click",a[8])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].Mark_as_spam)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&$(e),I(t),I(f),w=!1,_(V)}}}function Ma(a){let e,t,r,f,u,x,w,V;return t=new q({}),f=new ma({}),{c(){e=n("div"),s(t.$$.fragment),r=l(),s(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);i(t.$$.fragment,n),r=m(n),i(f.$$.fragment,n),n.forEach($),this.h()},h(){d(e,"class","action btn-dark")},m(n,s){h(n,e,s),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].This_is_not_spam)),b(e,"click",a[8])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].This_is_not_spam)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&$(e),I(t),I(f),w=!1,_(V)}}}function Sa(a){let e,t,r,f,u,x,w,V;return t=new K({}),f=new ma({}),{c(){e=n("div"),s(t.$$.fragment),r=l(),s(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);i(t.$$.fragment,n),r=m(n),i(f.$$.fragment,n),n.forEach($),this.h()},h(){d(e,"class","action btn-dark")},m(n,s){h(n,e,s),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].Reply)),b(e,"click",a[11])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].Reply)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&$(e),I(t),I(f),w=!1,_(V)}}}function Ta(a){let e,t,r,f,u,x,w,V,M,S,T,A,F,N,P,z,R,B,L,J,K,O,Q,W,q,U,X,Z,ea,ta,na,oa,ia,$a,da,ua,ha,ga,pa,va,ba,xa,wa=!sa(a[1])&&!la(a[1]);r=new C({}),u=new ma({});const ka=[ya,Va],Da=[];function Ea(a,e){return a[0].seen?0:1}T=Ea(a),A=Da[T]=ka[T](a),N=new ma({});const _a=[Ma,ja],Ta=[];function Aa(a,e){return(null==R||2&e)&&(R=!!Y(a[1])),R?0:((null==B||2&e)&&(B=!(sa(a[1])||la(a[1])||aa(a[1]))),B?1:-1)}~(L=Aa(a,-1))&&(J=Ta[L]=_a[L](a)),Q=new G({}),q=new ma({}),na=new H({}),ia=new ma({});let Fa=wa&&Sa(a);return ha=new fa({props:{mailbox:a[1],onMove:a[10]}}),pa=new Ia({props:{mailbox:a[1],message:a[0]}}),{c(){e=n("div"),t=n("a"),s(r.$$.fragment),f=l(),s(u.$$.fragment),V=l(),M=n("div"),S=n("div"),A.c(),F=l(),s(N.$$.fragment),z=l(),J&&J.c(),K=l(),O=n("div"),s(Q.$$.fragment),W=l(),s(q.$$.fragment),X=l(),Z=n("div"),ea=n("div"),ta=n("div"),s(na.$$.fragment),oa=l(),s(ia.$$.fragment),da=l(),Fa&&Fa.c(),ua=l(),s(ha.$$.fragment),ga=l(),s(pa.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);t=c(n,"A",{class:!0,href:!0});var s=o(t);i(r.$$.fragment,s),f=m(s),i(u.$$.fragment,s),s.forEach($),n.forEach($),V=m(a),M=c(a,"DIV",{class:!0});var l=o(M);S=c(l,"DIV",{class:!0});var d=o(S);A.l(d),F=m(d),i(N.$$.fragment,d),d.forEach($),z=m(l),J&&J.l(l),K=m(l),O=c(l,"DIV",{class:!0});var h=o(O);i(Q.$$.fragment,h),W=m(h),i(q.$$.fragment,h),h.forEach($),l.forEach($),X=m(a),Z=c(a,"DIV",{class:!0});var g=o(Z);ea=c(g,"DIV",{class:!0});var p=o(ea);ta=c(p,"DIV",{class:!0});var v=o(ta);i(na.$$.fragment,v),oa=m(v),i(ia.$$.fragment,v),v.forEach($),da=m(p),Fa&&Fa.l(p),p.forEach($),g.forEach($),ua=m(a),i(ha.$$.fragment,a),ga=m(a),i(pa.$$.fragment,a),this.h()},h(){d(t,"class","na action btn-dark"),d(t,"href",x="/mailbox/"+a[1].id),d(e,"class","action-group first-action svelte-1ucrxaw"),d(S,"class","action btn-dark"),d(O,"class","action btn-dark"),d(M,"class","action-group"),d(ta,"class","action btn-dark"),d(ea,"class","action-group"),d(Z,"class","action-group")},m(n,s){h(n,e,s),g(e,t),p(r,t,null),g(t,f),p(u,t,null),h(n,V,s),h(n,M,s),g(M,S),Da[T].m(S,null),g(S,F),p(N,S,null),g(M,z),~L&&Ta[L].m(M,null),g(M,K),g(M,O),p(Q,O,null),g(O,W),p(q,O,null),h(n,X,s),h(n,Z,s),g(Z,ea),g(ea,ta),p(na,ta,null),g(ta,oa),p(ia,ta,null),g(ea,da),Fa&&Fa.m(ea,null),h(n,ua,s),p(ha,n,s),h(n,ga,s),p(pa,n,s),va=!0,ba||(xa=[v(w=ca.call(null,t,`${a[4].Back_to} ${ra(a[1])}`)),v(P=ca.call(null,S,a[0].seen?a[4].Mark_as_seen:a[4].Mark_as_not_seen)),b(S,"click",a[7]),v(U=ca.call(null,O,aa(a[1])?a[4].Delete_permanently:sa(a[1])?a[4].Discard_drafts:a[4].Delete)),b(O,"click",a[9]),v($a=ca.call(null,ta,a[4].Forward)),b(ta,"click",a[12])],ba=!0)},p(a,e){(!va||2&e&&x!==(x="/mailbox/"+a[1].id))&&d(t,"href",x),w&&k(w.update)&&18&e&&w.update.call(null,`${a[4].Back_to} ${ra(a[1])}`);let n=T;T=Ea(a),T!==n&&(y(),E(Da[n],1,1,(()=>{Da[n]=null})),j(),A=Da[T],A||(A=Da[T]=ka[T](a),A.c()),D(A,1),A.m(S,F)),P&&k(P.update)&&17&e&&P.update.call(null,a[0].seen?a[4].Mark_as_seen:a[4].Mark_as_not_seen);let s=L;L=Aa(a,e),L===s?~L&&Ta[L].p(a,e):(J&&(y(),E(Ta[s],1,1,(()=>{Ta[s]=null})),j()),~L?(J=Ta[L],J?J.p(a,e):(J=Ta[L]=_a[L](a),J.c()),D(J,1),J.m(M,K)):J=null),U&&k(U.update)&&18&e&&U.update.call(null,aa(a[1])?a[4].Delete_permanently:sa(a[1])?a[4].Discard_drafts:a[4].Delete),$a&&k($a.update)&&16&e&&$a.update.call(null,a[4].Forward),2&e&&(wa=!sa(a[1])&&!la(a[1])),wa?Fa?(Fa.p(a,e),2&e&&D(Fa,1)):(Fa=Sa(a),Fa.c(),D(Fa,1),Fa.m(ea,null)):Fa&&(y(),E(Fa,1,1,(()=>{Fa=null})),j());const l={};2&e&&(l.mailbox=a[1]),ha.$set(l);const r={};2&e&&(r.mailbox=a[1]),1&e&&(r.message=a[0]),pa.$set(r)},i(a){va||(D(r.$$.fragment,a),D(u.$$.fragment,a),D(A),D(N.$$.fragment,a),D(J),D(Q.$$.fragment,a),D(q.$$.fragment,a),D(na.$$.fragment,a),D(ia.$$.fragment,a),D(Fa),D(ha.$$.fragment,a),D(pa.$$.fragment,a),va=!0)},o(a){E(r.$$.fragment,a),E(u.$$.fragment,a),E(A),E(N.$$.fragment,a),E(J),E(Q.$$.fragment,a),E(q.$$.fragment,a),E(na.$$.fragment,a),E(ia.$$.fragment,a),E(Fa),E(ha.$$.fragment,a),E(pa.$$.fragment,a),va=!1},d(a){a&&$(e),I(r),I(u),a&&$(V),a&&$(M),Da[T].d(),I(N),~L&&Ta[L].d(),I(Q),I(q),a&&$(X),a&&$(Z),I(na),I(ia),Fa&&Fa.d(),a&&$(ua),I(ha,a),a&&$(ga),I(pa,a),ba=!1,_(xa)}}}function Aa(a){let e;function t(a,e){return a[0].from.name?Na:Fa}let s=t(a),l=s(a);return{c(){e=n("div"),l.c(),this.h()},l(a){e=c(a,"DIV",{class:!0});var t=o(e);l.l(t),t.forEach($),this.h()},h(){d(e,"class","from svelte-1ucrxaw")},m(a,t){h(a,e,t),l.m(e,null)},p(a,n){s===(s=t(a))&&l?l.p(a,n):(l.d(1),l=s(a),l&&(l.c(),l.m(e,null)))},d(a){a&&$(e),l.d()}}}function Fa(a){let e,t,s,l=a[0].from.address+"";return{c(){e=r("From: "),t=n("span"),s=r(l),this.h()},l(a){e=f(a,"From: "),t=c(a,"SPAN",{class:!0});var n=o(t);s=f(n,l),n.forEach($),this.h()},h(){d(t,"class","from-only-address svelte-1ucrxaw")},m(a,n){h(a,e,n),h(a,t,n),g(t,s)},p(a,e){1&e&&l!==(l=a[0].from.address+"")&&x(s,l)},d(a){a&&$(e),a&&$(t)}}}function Na(a){let e,t,s,i,u,p,v,b=a[0].from.name+"",w=a[0].from.address+"";return{c(){e=r("From: "),t=n("span"),s=r(b),i=l(),u=r("<"),p=r(w),v=r(">"),this.h()},l(a){e=f(a,"From: "),t=c(a,"SPAN",{class:!0});var n=o(t);s=f(n,b),n.forEach($),i=m(a),u=f(a,"<"),p=f(a,w),v=f(a,">"),this.h()},h(){d(t,"class","from-name svelte-1ucrxaw")},m(a,n){h(a,e,n),h(a,t,n),g(t,s),h(a,i,n),h(a,u,n),h(a,p,n),h(a,v,n)},p(a,e){1&e&&b!==(b=a[0].from.name+"")&&x(s,b),1&e&&w!==(w=a[0].from.address+"")&&x(p,w)},d(a){a&&$(e),a&&$(t),a&&$(i),a&&$(u),a&&$(p),a&&$(v)}}}function Pa(a){let e,t,s,i=a[4]["To:"]+"",u=a[0].to,p=[];for(let n=0;n<u.length;n+=1)p[n]=za(_a(a,u,n));return{c(){e=n("div"),t=r(i),s=l();for(let a=0;a<p.length;a+=1)p[a].c();this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);t=f(n,i),s=m(n);for(let e=0;e<p.length;e+=1)p[e].l(n);n.forEach($),this.h()},h(){d(e,"class","to svelte-1ucrxaw")},m(a,n){h(a,e,n),g(e,t),g(e,s);for(let t=0;t<p.length;t+=1)p[t].m(e,null)},p(a,n){if(16&n&&i!==(i=a[4]["To:"]+"")&&x(t,i),1&n){let t;for(u=a[0].to,t=0;t<u.length;t+=1){const s=_a(a,u,t);p[t]?p[t].p(s,n):(p[t]=za(s),p[t].c(),p[t].m(e,null))}for(;t<p.length;t+=1)p[t].d(1);p.length=u.length}},d(a){a&&$(e),N(p,a)}}}function za(a){let e,t,s,i=a[17].address+"",u=0!==a[19]&&function(a){let e;return{c(){e=r(",")},l(a){e=f(a,",")},m(a,t){h(a,e,t)},d(a){a&&$(e)}}}();return{c(){u&&u.c(),e=l(),t=n("span"),s=r(i),this.h()},l(a){u&&u.l(a),e=m(a),t=c(a,"SPAN",{class:!0});var n=o(t);s=f(n,i),n.forEach($),this.h()},h(){d(t,"class","to-address svelte-1ucrxaw")},m(a,n){u&&u.m(a,n),h(a,e,n),h(a,t,n),g(t,s)},p(a,e){1&e&&i!==(i=a[17].address+"")&&x(s,i)},d(a){u&&u.d(a),a&&$(e),a&&$(t)}}}function Ra(a){let e,t,s,i,u=a[4]["Sent:"]+"",p=new Date(a[0].date).toLocaleString()+"";return{c(){e=n("div"),t=r(u),s=l(),i=r(p),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);t=f(n,u),s=m(n),i=f(n,p),n.forEach($),this.h()},h(){d(e,"class","date svelte-1ucrxaw")},m(a,n){h(a,e,n),g(e,t),g(e,s),g(e,i)},p(a,e){16&e&&u!==(u=a[4]["Sent:"]+"")&&x(t,u),1&e&&p!==(p=new Date(a[0].date).toLocaleString()+"")&&x(i,p)},d(a){a&&$(e)}}}function Ba(a){let e,t,s,l;return{c(){e=n("div"),this.h()},l(a){e=c(a,"DIV",{class:!0}),o(e).forEach($),this.h()},h(){d(e,"class","html")},m(n,r){h(n,e,r),s||(l=v(t=oa.call(null,e,{html:a[3],message:a[0]})),s=!0)},p(a,e){t&&k(t.update)&&9&e&&t.update.call(null,{html:a[3],message:a[0]})},d(a){a&&$(e),s=!1,l()}}}function La(a){let e,t,s=(a[0].text||"")+"";return{c(){e=n("div"),t=r(s),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);t=f(n,s),n.forEach($),this.h()},h(){d(e,"class","text svelte-1ucrxaw")},m(a,n){h(a,e,n),g(e,t)},p(a,e){1&e&&s!==(s=(a[0].text||"")+"")&&x(t,s)},d(a){a&&$(e)}}}function Ca(a){let e,t,u,v,w,k,_,V,y,j,M,S,T,A,F,N,z,R=a[0].subject+"";t=new ia({props:{scrolled:a[2],$$slots:{default:[Ta]},$$scope:{ctx:a}}});let L=a[0].from&&Aa(a),C=a[0].to&&Pa(a),G=a[0].date&&Ra(a);function H(a,e){return a[3]?Ba:La}let K=H(a),O=K(a);return{c(){e=n("div"),s(t.$$.fragment),u=l(),v=n("div"),w=n("div"),k=n("div"),_=r(R),V=l(),y=n("div"),L&&L.c(),j=l(),C&&C.c(),M=l(),G&&G.c(),S=l(),T=n("div"),O.c(),this.h()},l(a){e=c(a,"DIV",{class:!0});var n=o(e);i(t.$$.fragment,n),u=m(n),v=c(n,"DIV",{class:!0});var s=o(v);w=c(s,"DIV",{class:!0});var l=o(w);k=c(l,"DIV",{class:!0});var r=o(k);_=f(r,R),r.forEach($),V=m(l),y=c(l,"DIV",{class:!0});var d=o(y);L&&L.l(d),j=m(d),C&&C.l(d),M=m(d),G&&G.l(d),d.forEach($),l.forEach($),S=m(s),T=c(s,"DIV",{class:!0});var h=o(T);O.l(h),h.forEach($),s.forEach($),n.forEach($),this.h()},h(){d(k,"class","subject svelte-1ucrxaw"),d(y,"class","info svelte-1ucrxaw"),d(w,"class","detail svelte-1ucrxaw"),d(T,"class","body svelte-1ucrxaw"),d(v,"class","message svelte-1ucrxaw"),d(e,"class","page svelte-1ucrxaw")},m(n,s){h(n,e,s),p(t,e,null),g(e,u),g(e,v),g(v,w),g(w,k),g(k,_),g(w,V),g(w,y),L&&L.m(y,null),g(y,j),C&&C.m(y,null),g(y,M),G&&G.m(y,null),g(v,S),g(v,T),O.m(T,null),F=!0,N||(z=b(v,"scroll",a[5]),N=!0)},p(a,e){const n={};4&e&&(n.scrolled=a[2]),1048595&e&&(n.$$scope={dirty:e,ctx:a}),t.$set(n),(!F||1&e)&&R!==(R=a[0].subject+"")&&x(_,R),a[0].from?L?L.p(a,e):(L=Aa(a),L.c(),L.m(y,j)):L&&(L.d(1),L=null),a[0].to?C?C.p(a,e):(C=Pa(a),C.c(),C.m(y,M)):C&&(C.d(1),C=null),a[0].date?G?G.p(a,e):(G=Ra(a),G.c(),G.m(y,null)):G&&(G.d(1),G=null),K===(K=H(a))&&O?O.p(a,e):(O.d(1),O=K(a),O&&(O.c(),O.m(T,null)))},i(a){F||(D(t.$$.fragment,a),A||P((()=>{A=B(v,J,{duration:150,x:-20}),A.start()})),F=!0)},o(a){E(t.$$.fragment,a),F=!1},d(a){a&&$(e),I(t),L&&L.d(),C&&C.d(),G&&G.d(),O.d(),N=!1,z()}}}function Ga(a){let e,n,s,r,c=`${a[0].mailbox}-${a[0].id}`;document.title=e=a[0].subject;let o=Ca(a);return{c(){n=l(),o.c(),s=V()},l(a){z('[data-svelte="svelte-1rfgw4w"]',document.head).forEach($),n=m(a),o.l(a),s=V()},m(a,e){h(a,n,e),o.m(a,e),h(a,s,e),r=!0},p(a,[n]){(!r||1&n)&&e!==(e=a[0].subject)&&(document.title=e),1&n&&t(c,c=`${a[0].mailbox}-${a[0].id}`)?(y(),E(o,1,1,L),j(),o=Ca(a),o.c(),D(o),o.m(s.parentNode,s)):o.p(a,n)},i(a){r||(D(o),r=!0)},o(a){E(o),r=!1},d(a){a&&$(n),a&&$(s),o.d(a)}}}const Ha=({page:a,fetch:e,session:t})=>U({page:a,fetch:e,session:t});function Ja(a,e,t){let n,s,l;M(a,pa,(a=>t(4,l=a)));var r,c=this&&this.__awaiter||function(a,e,t,n){return new(t||(t=Promise))((function(s,l){function r(a){try{o(n.next(a))}catch(e){l(e)}}function c(a){try{o(n.throw(a))}catch(e){l(e)}}function o(a){var e;a.done?s(a.value):(e=a.value,e instanceof t?e:new t((function(a){a(e)}))).then(r,c)}o((n=n.apply(a,e||[])).next())}))};let{mailbox:o}=e,{message:i}=e,m=!1;const{user:f,mailboxes:$}=R("dash");M(a,$,(a=>t(14,s=a)));const d=X((()=>c(void 0,void 0,void 0,(function*(){try{t(0,i.seen=!i.seen,i),yield na(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),seen:i.seen})}catch(a){throw t(0,i.seen=!i.seen,i),a}})))),u=X((()=>c(void 0,void 0,void 0,(function*(){Y(o)?yield g(s.find(Z)):yield g(s.find(Y))})))),h=X((()=>c(void 0,void 0,void 0,(function*(){aa(o)||Y(o)?(yield ea(`/api/mailboxes/${o.id}/messages/${i.id}`),yield ta(`/mailbox/${o.id}`)):yield g(s.find(aa))})))),g=X((a=>c(void 0,void 0,void 0,(function*(){o.id!==a.id&&(yield na(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),moveTo:a.id}),yield ta(`/mailbox/${o.id}`))})))),p=X((()=>c(void 0,void 0,void 0,(function*(){const a=s.find(sa);yield da(f,a,o,i.id)})))),v=X((()=>c(void 0,void 0,void 0,(function*(){const a=s.find(sa);yield ua(a,o,i.id)}))));return a.$$set=a=>{"mailbox"in a&&t(1,o=a.mailbox),"message"in a&&t(0,i=a.message)},a.$$.update=()=>{1&a.$$.dirty&&console.log({message:i}),8193&a.$$.dirty&&t(3,n=null===t(13,r=i.html)||void 0===r?void 0:r.join("").trim())},[i,o,m,n,l,a=>{let e=a.target;t(2,m=0!==e.scrollTop)},$,d,u,h,g,p,v,r]}class Ka extends a{constructor(a){super(),e(this,a,Ja,Ga,t,{mailbox:1,message:0})}}export{Ka as default,Ha as load};
