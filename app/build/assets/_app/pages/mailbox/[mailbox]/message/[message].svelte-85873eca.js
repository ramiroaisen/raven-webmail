import{S as a,i as e,s as t,e as s,j as n,k as l,t as r,c,a as o,m as i,n as m,g as f,d,b as $,G as u,f as h,H as g,o as p,J as v,I as b,h as x,Q as w,a3 as k,x as D,u as E,v as I,N as _,l as V,r as y,w as j,E as M,aI as S,F as T,P as A,ax as F,aD as N,K as P,b0 as z,O as R,ac as B,D as L,b2 as G,W as H,b3 as J,ad as K,b4 as O,aZ as Q,aY as W,as as Y,a_ as Z}from"../../../../chunks/vendor-a33ae268.js";import{n as q,b as C,t as U,u as X,e as aa,_ as ea,g as ta,d as sa,f as na,v as la,m as ra}from"../../../../chunks/util-f7a25e62.js";import{t as ca,b as oa}from"../../../../chunks/MenuItem-ffe38195.js";import{T as ia}from"../../../../chunks/TabTop-15a5e35c.js";import{R as ma}from"../../../../chunks/Ripple-d46a3189.js";import{M as fa}from"../../../../chunks/MoveTo-27280e0f.js";import{P as da,M as $a,u as ua,b as ha,c as ga}from"../../../../chunks/compose-c5527cac.js";import{l as pa}from"../../../../chunks/locale-bf4f32f8.js";import"../../../../chunks/singletons-12a22614.js";import"../../../../chunks/preload-helper-ec9aa979.js";function va(a,e,t){const s=a.slice();return s[6]=e[t],s}function ba(a){let e,t,V,y,j,M,F,N,P,z,R,B,L,G,H,J,K=a[2].attachments.length+"";function O(e){a[4](e)}V=new S({});let Q={anchor:"top-left",$$slots:{default:[ka]},$$scope:{ctx:a}};return void 0!==a[0]&&(Q.open=a[0]),P=new da({props:Q}),T.push((()=>A(P,"open",O))),B=new ma({}),{c(){e=s("div"),t=s("div"),n(V.$$.fragment),y=l(),j=s("div"),M=r(K),F=l(),N=s("div"),n(P.$$.fragment),R=l(),n(B.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);t=c(s,"DIV",{class:!0});var n=o(t);i(V.$$.fragment,n),y=m(n),j=c(n,"DIV",{class:!0});var l=o(j);M=f(l,K),l.forEach(d),F=m(n),N=c(n,"DIV",{class:!0});var r=o(N);i(P.$$.fragment,r),r.forEach(d),R=m(n),i(B.$$.fragment,n),n.forEach(d),s.forEach(d),this.h()},h(){$(j,"class","count svelte-1as9z7t"),$(N,"class","anchor svelte-1as9z7t"),$(t,"class","action btn-dark"),u(t,"hover",a[0]),$(e,"class","action-group")},m(s,n){h(s,e,n),g(e,t),p(V,t,null),g(t,y),g(t,j),g(j,M),g(t,F),g(t,N),p(P,N,null),g(t,R),p(B,t,null),G=!0,H||(J=[v(L=ca.call(null,t,a[3].Attachments)),b(t,"click",a[5])],H=!0)},p(a,e){(!G||4&e)&&K!==(K=a[2].attachments.length+"")&&x(M,K);const s={};518&e&&(s.$$scope={dirty:e,ctx:a}),!z&&1&e&&(z=!0,s.open=a[0],w((()=>z=!1))),P.$set(s),L&&k(L.update)&&8&e&&L.update.call(null,a[3].Attachments),1&e&&u(t,"hover",a[0])},i(a){G||(D(V.$$.fragment,a),D(P.$$.fragment,a),D(B.$$.fragment,a),G=!0)},o(a){E(V.$$.fragment,a),E(P.$$.fragment,a),E(B.$$.fragment,a),G=!1},d(a){a&&d(e),I(V),I(P),I(B),H=!1,_(J)}}}function xa(a){let e,t,u,v,b,w,k,_,V,y,j,M=a[6].filename+"";return k=new ma({}),{c(){e=s("a"),t=s("div"),u=l(),v=s("div"),b=r(M),w=l(),n(k.$$.fragment),_=l(),this.h()},l(a){e=c(a,"A",{href:!0,class:!0,download:!0});var s=o(e);t=c(s,"DIV",{class:!0,style:!0}),o(t).forEach(d),u=m(s),v=c(s,"DIV",{class:!0});var n=o(v);b=f(n,M),n.forEach(d),w=m(s),i(k.$$.fragment,s),_=m(s),s.forEach(d),this.h()},h(){$(t,"class","img svelte-1as9z7t"),F(t,"background-image","url("+ua(a[6].filename)+")"),$(v,"class","name svelte-1as9z7t"),$(e,"href",V="/api/mailboxes/"+a[1].id+"/messages/"+a[2].id+"/attachments/"+a[6].id),$(e,"class","na item btn-dark svelte-1as9z7t"),$(e,"download",y=a[6].filename)},m(a,s){h(a,e,s),g(e,t),g(e,u),g(e,v),g(v,b),g(e,w),p(k,e,null),g(e,_),j=!0},p(a,s){(!j||4&s)&&F(t,"background-image","url("+ua(a[6].filename)+")"),(!j||4&s)&&M!==(M=a[6].filename+"")&&x(b,M),(!j||6&s&&V!==(V="/api/mailboxes/"+a[1].id+"/messages/"+a[2].id+"/attachments/"+a[6].id))&&$(e,"href",V),(!j||4&s&&y!==(y=a[6].filename))&&$(e,"download",y)},i(a){j||(D(k.$$.fragment,a),j=!0)},o(a){E(k.$$.fragment,a),j=!1},d(a){a&&d(e),I(k)}}}function wa(a){let e,t,s=a[2].attachments,n=[];for(let r=0;r<s.length;r+=1)n[r]=xa(va(a,s,r));const l=a=>E(n[a],1,1,(()=>{n[a]=null}));return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=V()},l(a){for(let e=0;e<n.length;e+=1)n[e].l(a);e=V()},m(a,s){for(let e=0;e<n.length;e+=1)n[e].m(a,s);h(a,e,s),t=!0},p(a,t){if(6&t){let r;for(s=a[2].attachments,r=0;r<s.length;r+=1){const l=va(a,s,r);n[r]?(n[r].p(l,t),D(n[r],1)):(n[r]=xa(l),n[r].c(),D(n[r],1),n[r].m(e.parentNode,e))}for(y(),r=s.length;r<n.length;r+=1)l(r);j()}},i(a){if(!t){for(let a=0;a<s.length;a+=1)D(n[a]);t=!0}},o(a){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)E(n[e]);t=!1},d(a){N(n,a),a&&d(e)}}}function ka(a){let e,t;return e=new $a({props:{$$slots:{default:[wa]},$$scope:{ctx:a}}}),{c(){n(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,s){p(e,a,s),t=!0},p(a,t){const s={};518&t&&(s.$$scope={dirty:t,ctx:a}),e.$set(s)},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function Da(a){var e;let t,s,n=(null==(e=a[2].attachments)?void 0:e.length)&&ba(a);return{c(){n&&n.c(),t=V()},l(a){n&&n.l(a),t=V()},m(a,e){n&&n.m(a,e),h(a,t,e),s=!0},p(a,[e]){var s;(null==(s=a[2].attachments)?void 0:s.length)?n?(n.p(a,e),4&e&&D(n,1)):(n=ba(a),n.c(),D(n,1),n.m(t.parentNode,t)):n&&(y(),E(n,1,1,(()=>{n=null})),j())},i(a){s||(D(n),s=!0)},o(a){E(n),s=!1},d(a){n&&n.d(a),a&&d(t)}}}function Ea(a,e,t){let s;M(a,pa,(a=>t(3,s=a)));let{mailbox:n}=e,{message:l}=e,{open:r=!1}=e;return a.$$set=a=>{"mailbox"in a&&t(1,n=a.mailbox),"message"in a&&t(2,l=a.message),"open"in a&&t(0,r=a.open)},[r,n,l,s,function(a){r=a,t(0,r)},()=>t(0,r=!r)]}class Ia extends a{constructor(a){super(),e(this,a,Ea,Da,t,{mailbox:1,message:2,open:0})}}function _a(a,e,t){const s=a.slice();return s[17]=e[t],s[19]=t,s}function Va(a){let e,t;return e=new Q({}),{c(){n(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,s){p(e,a,s),t=!0},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function ya(a){let e,t;return e=new W({}),{c(){n(e.$$.fragment)},l(a){i(e.$$.fragment,a)},m(a,s){p(e,a,s),t=!0},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){E(e.$$.fragment,a),t=!1},d(a){I(e,a)}}}function ja(a){let e,t,r,f,u,x,w,V;return t=new Y({}),f=new ma({}),{c(){e=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(e,"class","action btn-dark")},m(s,n){h(s,e,n),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].Mark_as_spam)),b(e,"click",a[8])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].Mark_as_spam)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&d(e),I(t),I(f),w=!1,_(V)}}}function Ma(a){let e,t,r,f,u,x,w,V;return t=new Z({}),f=new ma({}),{c(){e=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(e,"class","action btn-dark")},m(s,n){h(s,e,n),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].This_is_not_spam)),b(e,"click",a[8])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].This_is_not_spam)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&d(e),I(t),I(f),w=!1,_(V)}}}function Sa(a){let e,t,r,f,u,x,w,V;return t=new O({}),f=new ma({}),{c(){e=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(e,"class","action btn-dark")},m(s,n){h(s,e,n),p(t,e,null),g(e,r),p(f,e,null),x=!0,w||(V=[v(u=ca.call(null,e,a[4].Reply)),b(e,"click",a[11])],w=!0)},p(a,e){u&&k(u.update)&&16&e&&u.update.call(null,a[4].Reply)},i(a){x||(D(t.$$.fragment,a),D(f.$$.fragment,a),x=!0)},o(a){E(t.$$.fragment,a),E(f.$$.fragment,a),x=!1},d(a){a&&d(e),I(t),I(f),w=!1,_(V)}}}function Ta(a){let e,t,r,f,u,x,w,V,M,S,T,A,F,N,P,z,R,B,L,K,O,Q,W,Y,Z,q,C,X,ea,ta,sa,oa,ia,da,$a,ua,ha,ga,pa,va,ba,xa,wa=!na(a[1])&&!la(a[1]);r=new G({}),u=new ma({});const ka=[ya,Va],Da=[];function Ea(a,e){return a[0].seen?0:1}T=Ea(a),A=Da[T]=ka[T](a),N=new ma({});const _a=[Ma,ja],Ta=[];function Aa(a,e){return(null==R||2&e)&&(R=!!U(a[1])),R?0:((null==B||2&e)&&(B=!(na(a[1])||la(a[1])||aa(a[1]))),B?1:-1)}~(L=Aa(a,-1))&&(K=Ta[L]=_a[L](a)),W=new H({}),Z=new ma({}),sa=new J({}),ia=new ma({});let Fa=wa&&Sa(a);return ha=new fa({props:{mailbox:a[1],onMove:a[10]}}),pa=new Ia({props:{mailbox:a[1],message:a[0]}}),{c(){e=s("div"),t=s("a"),n(r.$$.fragment),f=l(),n(u.$$.fragment),V=l(),M=s("div"),S=s("div"),A.c(),F=l(),n(N.$$.fragment),z=l(),K&&K.c(),O=l(),Q=s("div"),n(W.$$.fragment),Y=l(),n(Z.$$.fragment),C=l(),X=s("div"),ea=s("div"),ta=s("div"),n(sa.$$.fragment),oa=l(),n(ia.$$.fragment),$a=l(),Fa&&Fa.c(),ua=l(),n(ha.$$.fragment),ga=l(),n(pa.$$.fragment),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);t=c(s,"A",{class:!0,href:!0});var n=o(t);i(r.$$.fragment,n),f=m(n),i(u.$$.fragment,n),n.forEach(d),s.forEach(d),V=m(a),M=c(a,"DIV",{class:!0});var l=o(M);S=c(l,"DIV",{class:!0});var $=o(S);A.l($),F=m($),i(N.$$.fragment,$),$.forEach(d),z=m(l),K&&K.l(l),O=m(l),Q=c(l,"DIV",{class:!0});var h=o(Q);i(W.$$.fragment,h),Y=m(h),i(Z.$$.fragment,h),h.forEach(d),l.forEach(d),C=m(a),X=c(a,"DIV",{class:!0});var g=o(X);ea=c(g,"DIV",{class:!0});var p=o(ea);ta=c(p,"DIV",{class:!0});var v=o(ta);i(sa.$$.fragment,v),oa=m(v),i(ia.$$.fragment,v),v.forEach(d),$a=m(p),Fa&&Fa.l(p),p.forEach(d),g.forEach(d),ua=m(a),i(ha.$$.fragment,a),ga=m(a),i(pa.$$.fragment,a),this.h()},h(){$(t,"class","na action btn-dark"),$(t,"href",x="/mailbox/"+a[1].id),$(e,"class","action-group first-action svelte-1ed8sm"),$(S,"class","action btn-dark"),$(Q,"class","action btn-dark"),$(M,"class","action-group"),$(ta,"class","action btn-dark"),$(ea,"class","action-group"),$(X,"class","action-group")},m(s,n){h(s,e,n),g(e,t),p(r,t,null),g(t,f),p(u,t,null),h(s,V,n),h(s,M,n),g(M,S),Da[T].m(S,null),g(S,F),p(N,S,null),g(M,z),~L&&Ta[L].m(M,null),g(M,O),g(M,Q),p(W,Q,null),g(Q,Y),p(Z,Q,null),h(s,C,n),h(s,X,n),g(X,ea),g(ea,ta),p(sa,ta,null),g(ta,oa),p(ia,ta,null),g(ea,$a),Fa&&Fa.m(ea,null),h(s,ua,n),p(ha,s,n),h(s,ga,n),p(pa,s,n),va=!0,ba||(xa=[v(w=ca.call(null,t,`${a[4].Back_to} ${ra(a[1])}`)),v(P=ca.call(null,S,a[0].seen?a[4].Mark_as_seen:a[4].Mark_as_not_seen)),b(S,"click",a[7]),v(q=ca.call(null,Q,aa(a[1])?a[4].Delete_permanently:na(a[1])?a[4].Discard_drafts:a[4].Delete)),b(Q,"click",a[9]),v(da=ca.call(null,ta,a[4].Forward)),b(ta,"click",a[12])],ba=!0)},p(a,e){(!va||2&e&&x!==(x="/mailbox/"+a[1].id))&&$(t,"href",x),w&&k(w.update)&&18&e&&w.update.call(null,`${a[4].Back_to} ${ra(a[1])}`);let s=T;T=Ea(a),T!==s&&(y(),E(Da[s],1,1,(()=>{Da[s]=null})),j(),A=Da[T],A||(A=Da[T]=ka[T](a),A.c()),D(A,1),A.m(S,F)),P&&k(P.update)&&17&e&&P.update.call(null,a[0].seen?a[4].Mark_as_seen:a[4].Mark_as_not_seen);let n=L;L=Aa(a,e),L===n?~L&&Ta[L].p(a,e):(K&&(y(),E(Ta[n],1,1,(()=>{Ta[n]=null})),j()),~L?(K=Ta[L],K?K.p(a,e):(K=Ta[L]=_a[L](a),K.c()),D(K,1),K.m(M,O)):K=null),q&&k(q.update)&&18&e&&q.update.call(null,aa(a[1])?a[4].Delete_permanently:na(a[1])?a[4].Discard_drafts:a[4].Delete),da&&k(da.update)&&16&e&&da.update.call(null,a[4].Forward),2&e&&(wa=!na(a[1])&&!la(a[1])),wa?Fa?(Fa.p(a,e),2&e&&D(Fa,1)):(Fa=Sa(a),Fa.c(),D(Fa,1),Fa.m(ea,null)):Fa&&(y(),E(Fa,1,1,(()=>{Fa=null})),j());const l={};2&e&&(l.mailbox=a[1]),ha.$set(l);const r={};2&e&&(r.mailbox=a[1]),1&e&&(r.message=a[0]),pa.$set(r)},i(a){va||(D(r.$$.fragment,a),D(u.$$.fragment,a),D(A),D(N.$$.fragment,a),D(K),D(W.$$.fragment,a),D(Z.$$.fragment,a),D(sa.$$.fragment,a),D(ia.$$.fragment,a),D(Fa),D(ha.$$.fragment,a),D(pa.$$.fragment,a),va=!0)},o(a){E(r.$$.fragment,a),E(u.$$.fragment,a),E(A),E(N.$$.fragment,a),E(K),E(W.$$.fragment,a),E(Z.$$.fragment,a),E(sa.$$.fragment,a),E(ia.$$.fragment,a),E(Fa),E(ha.$$.fragment,a),E(pa.$$.fragment,a),va=!1},d(a){a&&d(e),I(r),I(u),a&&d(V),a&&d(M),Da[T].d(),I(N),~L&&Ta[L].d(),I(W),I(Z),a&&d(C),a&&d(X),I(sa),I(ia),Fa&&Fa.d(),a&&d(ua),I(ha,a),a&&d(ga),I(pa,a),ba=!1,_(xa)}}}function Aa(a){let e;function t(a,e){return a[0].from.name?Na:Fa}let n=t(a),l=n(a);return{c(){e=s("div"),l.c(),this.h()},l(a){e=c(a,"DIV",{class:!0});var t=o(e);l.l(t),t.forEach(d),this.h()},h(){$(e,"class","from svelte-1ed8sm")},m(a,t){h(a,e,t),l.m(e,null)},p(a,s){n===(n=t(a))&&l?l.p(a,s):(l.d(1),l=n(a),l&&(l.c(),l.m(e,null)))},d(a){a&&d(e),l.d()}}}function Fa(a){let e,t,n,l=a[0].from.address+"";return{c(){e=r("From: "),t=s("span"),n=r(l),this.h()},l(a){e=f(a,"From: "),t=c(a,"SPAN",{class:!0});var s=o(t);n=f(s,l),s.forEach(d),this.h()},h(){$(t,"class","from-only-address svelte-1ed8sm")},m(a,s){h(a,e,s),h(a,t,s),g(t,n)},p(a,e){1&e&&l!==(l=a[0].from.address+"")&&x(n,l)},d(a){a&&d(e),a&&d(t)}}}function Na(a){let e,t,n,i,u,p,v,b=a[0].from.name+"",w=a[0].from.address+"";return{c(){e=r("From: "),t=s("span"),n=r(b),i=l(),u=r("<"),p=r(w),v=r(">"),this.h()},l(a){e=f(a,"From: "),t=c(a,"SPAN",{class:!0});var s=o(t);n=f(s,b),s.forEach(d),i=m(a),u=f(a,"<"),p=f(a,w),v=f(a,">"),this.h()},h(){$(t,"class","from-name svelte-1ed8sm")},m(a,s){h(a,e,s),h(a,t,s),g(t,n),h(a,i,s),h(a,u,s),h(a,p,s),h(a,v,s)},p(a,e){1&e&&b!==(b=a[0].from.name+"")&&x(n,b),1&e&&w!==(w=a[0].from.address+"")&&x(p,w)},d(a){a&&d(e),a&&d(t),a&&d(i),a&&d(u),a&&d(p),a&&d(v)}}}function Pa(a){let e,t,n,i=a[4]["To:"]+"",u=a[0].to,p=[];for(let s=0;s<u.length;s+=1)p[s]=za(_a(a,u,s));return{c(){e=s("div"),t=r(i),n=l();for(let a=0;a<p.length;a+=1)p[a].c();this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);t=f(s,i),n=m(s);for(let e=0;e<p.length;e+=1)p[e].l(s);s.forEach(d),this.h()},h(){$(e,"class","to svelte-1ed8sm")},m(a,s){h(a,e,s),g(e,t),g(e,n);for(let t=0;t<p.length;t+=1)p[t].m(e,null)},p(a,s){if(16&s&&i!==(i=a[4]["To:"]+"")&&x(t,i),1&s){let t;for(u=a[0].to,t=0;t<u.length;t+=1){const n=_a(a,u,t);p[t]?p[t].p(n,s):(p[t]=za(n),p[t].c(),p[t].m(e,null))}for(;t<p.length;t+=1)p[t].d(1);p.length=u.length}},d(a){a&&d(e),N(p,a)}}}function za(a){let e,t,n,i=a[17].address+"",u=0!==a[19]&&function(a){let e;return{c(){e=r(",")},l(a){e=f(a,",")},m(a,t){h(a,e,t)},d(a){a&&d(e)}}}();return{c(){u&&u.c(),e=l(),t=s("span"),n=r(i),this.h()},l(a){u&&u.l(a),e=m(a),t=c(a,"SPAN",{class:!0});var s=o(t);n=f(s,i),s.forEach(d),this.h()},h(){$(t,"class","to-address svelte-1ed8sm")},m(a,s){u&&u.m(a,s),h(a,e,s),h(a,t,s),g(t,n)},p(a,e){1&e&&i!==(i=a[17].address+"")&&x(n,i)},d(a){u&&u.d(a),a&&d(e),a&&d(t)}}}function Ra(a){let e,t,n,i,u=a[4]["Sent:"]+"",p=new Date(a[0].date).toLocaleString()+"";return{c(){e=s("div"),t=r(u),n=l(),i=r(p),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);t=f(s,u),n=m(s),i=f(s,p),s.forEach(d),this.h()},h(){$(e,"class","date svelte-1ed8sm")},m(a,s){h(a,e,s),g(e,t),g(e,n),g(e,i)},p(a,e){16&e&&u!==(u=a[4]["Sent:"]+"")&&x(t,u),1&e&&p!==(p=new Date(a[0].date).toLocaleString()+"")&&x(i,p)},d(a){a&&d(e)}}}function Ba(a){let e,t,n,l;return{c(){e=s("div"),this.h()},l(a){e=c(a,"DIV",{class:!0}),o(e).forEach(d),this.h()},h(){$(e,"class","html")},m(s,r){h(s,e,r),n||(l=v(t=oa.call(null,e,{html:a[3],message:a[0]})),n=!0)},p(a,e){t&&k(t.update)&&9&e&&t.update.call(null,{html:a[3],message:a[0]})},d(a){a&&d(e),n=!1,l()}}}function La(a){let e,t,n=(a[0].text||"")+"";return{c(){e=s("div"),t=r(n),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);t=f(s,n),s.forEach(d),this.h()},h(){$(e,"class","text svelte-1ed8sm")},m(a,s){h(a,e,s),g(e,t)},p(a,e){1&e&&n!==(n=(a[0].text||"")+"")&&x(t,n)},d(a){a&&d(e)}}}function Ga(a){let e,t,u,v,w,k,_,V,y,j,M,S,T,A,F,N,z,R=a[0].subject+"";t=new ia({props:{scrolled:a[2],$$slots:{default:[Ta]},$$scope:{ctx:a}}});let L=a[0].from&&Aa(a),G=a[0].to&&Pa(a),H=a[0].date&&Ra(a);function J(a,e){return a[3]?Ba:La}let O=J(a),Q=O(a);return{c(){e=s("div"),n(t.$$.fragment),u=l(),v=s("div"),w=s("div"),k=s("div"),_=r(R),V=l(),y=s("div"),L&&L.c(),j=l(),G&&G.c(),M=l(),H&&H.c(),S=l(),T=s("div"),Q.c(),this.h()},l(a){e=c(a,"DIV",{class:!0});var s=o(e);i(t.$$.fragment,s),u=m(s),v=c(s,"DIV",{class:!0});var n=o(v);w=c(n,"DIV",{class:!0});var l=o(w);k=c(l,"DIV",{class:!0});var r=o(k);_=f(r,R),r.forEach(d),V=m(l),y=c(l,"DIV",{class:!0});var $=o(y);L&&L.l($),j=m($),G&&G.l($),M=m($),H&&H.l($),$.forEach(d),l.forEach(d),S=m(n),T=c(n,"DIV",{class:!0});var h=o(T);Q.l(h),h.forEach(d),n.forEach(d),s.forEach(d),this.h()},h(){$(k,"class","subject svelte-1ed8sm"),$(y,"class","info svelte-1ed8sm"),$(w,"class","detail svelte-1ed8sm"),$(T,"class","body svelte-1ed8sm"),$(v,"class","message svelte-1ed8sm"),$(e,"class","page svelte-1ed8sm")},m(s,n){h(s,e,n),p(t,e,null),g(e,u),g(e,v),g(v,w),g(w,k),g(k,_),g(w,V),g(w,y),L&&L.m(y,null),g(y,j),G&&G.m(y,null),g(y,M),H&&H.m(y,null),g(v,S),g(v,T),Q.m(T,null),F=!0,N||(z=b(v,"scroll",a[5]),N=!0)},p(a,e){const s={};4&e&&(s.scrolled=a[2]),1048595&e&&(s.$$scope={dirty:e,ctx:a}),t.$set(s),(!F||1&e)&&R!==(R=a[0].subject+"")&&x(_,R),a[0].from?L?L.p(a,e):(L=Aa(a),L.c(),L.m(y,j)):L&&(L.d(1),L=null),a[0].to?G?G.p(a,e):(G=Pa(a),G.c(),G.m(y,M)):G&&(G.d(1),G=null),a[0].date?H?H.p(a,e):(H=Ra(a),H.c(),H.m(y,null)):H&&(H.d(1),H=null),O===(O=J(a))&&Q?Q.p(a,e):(Q.d(1),Q=O(a),Q&&(Q.c(),Q.m(T,null)))},i(a){F||(D(t.$$.fragment,a),A||P((()=>{A=B(v,K,{duration:150,x:-20}),A.start()})),F=!0)},o(a){E(t.$$.fragment,a),F=!1},d(a){a&&d(e),I(t),L&&L.d(),G&&G.d(),H&&H.d(),Q.d(),N=!1,z()}}}function Ha(a){let e,s,n,r,c=`${a[0].mailbox}-${a[0].id}`;document.title=e=a[0].subject;let o=Ga(a);return{c(){s=l(),o.c(),n=V()},l(a){z('[data-svelte="svelte-1rfgw4w"]',document.head).forEach(d),s=m(a),o.l(a),n=V()},m(a,e){h(a,s,e),o.m(a,e),h(a,n,e),r=!0},p(a,[s]){(!r||1&s)&&e!==(e=a[0].subject)&&(document.title=e),1&s&&t(c,c=`${a[0].mailbox}-${a[0].id}`)?(y(),E(o,1,1,L),j(),o=Ga(a),o.c(),D(o),o.m(n.parentNode,n)):o.p(a,s)},i(a){r||(D(o),r=!0)},o(a){E(o),r=!1},d(a){a&&d(s),a&&d(n),o.d(a)}}}const Ja=({page:a,fetch:e,session:t})=>q({page:a,fetch:e,session:t});function Ka(a,e,t){let s,n,l;M(a,pa,(a=>t(4,l=a)));var r,c=this&&this.__awaiter||function(a,e,t,s){return new(t||(t=Promise))((function(n,l){function r(a){try{o(s.next(a))}catch(e){l(e)}}function c(a){try{o(s.throw(a))}catch(e){l(e)}}function o(a){var e;a.done?n(a.value):(e=a.value,e instanceof t?e:new t((function(a){a(e)}))).then(r,c)}o((s=s.apply(a,e||[])).next())}))};let{mailbox:o}=e,{message:i}=e,m=!1;const{user:f,mailboxes:d}=R("dash");M(a,d,(a=>t(14,n=a)));const $=C((()=>c(void 0,void 0,void 0,(function*(){try{t(0,i.seen=!i.seen,i),yield sa(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),seen:i.seen})}catch(a){throw t(0,i.seen=!i.seen,i),a}})))),u=C((()=>c(void 0,void 0,void 0,(function*(){U(o)?yield g(n.find(X)):yield g(n.find(U))})))),h=C((()=>c(void 0,void 0,void 0,(function*(){aa(o)||U(o)?(yield ea(`/api/mailboxes/${o.id}/messages/${i.id}`),yield ta(`/mailbox/${o.id}`)):yield g(n.find(aa))})))),g=C((a=>c(void 0,void 0,void 0,(function*(){o.id!==a.id&&(yield sa(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),moveTo:a.id}),yield ta(`/mailbox/${o.id}`))})))),p=C((()=>c(void 0,void 0,void 0,(function*(){const a=n.find(na);yield ha(f,a,o,i.id)})))),v=C((()=>c(void 0,void 0,void 0,(function*(){const a=n.find(na);yield ga(a,o,i.id)}))));return a.$$set=a=>{"mailbox"in a&&t(1,o=a.mailbox),"message"in a&&t(0,i=a.message)},a.$$.update=()=>{1&a.$$.dirty&&console.log({message:i}),8193&a.$$.dirty&&t(3,s=null===t(13,r=i.html)||void 0===r?void 0:r.join("").trim())},[i,o,m,s,l,a=>{let e=a.target;t(2,m=0!==e.scrollTop)},d,$,u,h,g,p,v,r]}class Oa extends a{constructor(a){super(),e(this,a,Ka,Ha,t,{mailbox:1,message:0})}}export{Oa as default,Ja as load};
