import{S as e,i as a,s as t,e as s,j as n,k as l,t as r,c,a as o,m as i,n as m,g as f,d,b as $,G as u,f as h,H as g,o as p,J as v,I as b,h as x,Q as w,a3 as k,x as D,u as E,v as I,N as _,l as V,r as y,w as j,E as M,aI as S,F as T,P as A,ax as F,aD as N,K as P,b0 as z,O as R,ac as B,D as L,b2 as G,W as H,b3 as J,ad as K,b4 as O,aZ as Q,aY as W,as as Y,a_ as Z}from"../../../../chunks/vendor-d7518362.js";import{n as q,b as C,t as U,u as X,e as ee,_ as ae,g as te,d as se,f as ne,v as le,m as re}from"../../../../chunks/util-304b2847.js";import{t as ce,b as oe}from"../../../../chunks/MenuItem-e35c4291.js";import{T as ie}from"../../../../chunks/TabTop-0fc6ba3e.js";import{R as me}from"../../../../chunks/Ripple-cf147083.js";import{M as fe}from"../../../../chunks/MoveTo-65e8fff4.js";import{P as de,M as $e,u as ue,b as he,c as ge}from"../../../../chunks/compose-26b10bce.js";import{l as pe}from"../../../../chunks/locale-0e600940.js";import"../../../../chunks/singletons-12a22614.js";import"../../../../chunks/preload-helper-ec9aa979.js";function ve(e,a,t){const s=e.slice();return s[6]=a[t],s}function be(e){let a,t,V,y,j,M,F,N,P,z,R,B,L,G,H,J,K=e[2].attachments.length+"";function O(a){e[4](a)}V=new S({});let Q={anchor:"top-left",$$slots:{default:[ke]},$$scope:{ctx:e}};return void 0!==e[0]&&(Q.open=e[0]),P=new de({props:Q}),T.push((()=>A(P,"open",O))),B=new me({}),{c(){a=s("div"),t=s("div"),n(V.$$.fragment),y=l(),j=s("div"),M=r(K),F=l(),N=s("div"),n(P.$$.fragment),R=l(),n(B.$$.fragment),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);t=c(s,"DIV",{class:!0});var n=o(t);i(V.$$.fragment,n),y=m(n),j=c(n,"DIV",{class:!0});var l=o(j);M=f(l,K),l.forEach(d),F=m(n),N=c(n,"DIV",{class:!0});var r=o(N);i(P.$$.fragment,r),r.forEach(d),R=m(n),i(B.$$.fragment,n),n.forEach(d),s.forEach(d),this.h()},h(){$(j,"class","count svelte-1as9z7t"),$(N,"class","anchor svelte-1as9z7t"),$(t,"class","action btn-dark"),u(t,"hover",e[0]),$(a,"class","action-group")},m(s,n){h(s,a,n),g(a,t),p(V,t,null),g(t,y),g(t,j),g(j,M),g(t,F),g(t,N),p(P,N,null),g(t,R),p(B,t,null),G=!0,H||(J=[v(L=ce.call(null,t,e[3].Attachments)),b(t,"click",e[5])],H=!0)},p(e,a){(!G||4&a)&&K!==(K=e[2].attachments.length+"")&&x(M,K);const s={};518&a&&(s.$$scope={dirty:a,ctx:e}),!z&&1&a&&(z=!0,s.open=e[0],w((()=>z=!1))),P.$set(s),L&&k(L.update)&&8&a&&L.update.call(null,e[3].Attachments),1&a&&u(t,"hover",e[0])},i(e){G||(D(V.$$.fragment,e),D(P.$$.fragment,e),D(B.$$.fragment,e),G=!0)},o(e){E(V.$$.fragment,e),E(P.$$.fragment,e),E(B.$$.fragment,e),G=!1},d(e){e&&d(a),I(V),I(P),I(B),H=!1,_(J)}}}function xe(e){let a,t,u,v,b,w,k,_,V,y,j,M=e[6].filename+"";return k=new me({}),{c(){a=s("a"),t=s("div"),u=l(),v=s("div"),b=r(M),w=l(),n(k.$$.fragment),_=l(),this.h()},l(e){a=c(e,"A",{href:!0,class:!0,download:!0});var s=o(a);t=c(s,"DIV",{class:!0,style:!0}),o(t).forEach(d),u=m(s),v=c(s,"DIV",{class:!0});var n=o(v);b=f(n,M),n.forEach(d),w=m(s),i(k.$$.fragment,s),_=m(s),s.forEach(d),this.h()},h(){$(t,"class","img svelte-1as9z7t"),F(t,"background-image","url("+ue(e[6].filename)+")"),$(v,"class","name svelte-1as9z7t"),$(a,"href",V="/api/mailboxes/"+e[1].id+"/messages/"+e[2].id+"/attachments/"+e[6].id),$(a,"class","na item btn-dark svelte-1as9z7t"),$(a,"download",y=e[6].filename)},m(e,s){h(e,a,s),g(a,t),g(a,u),g(a,v),g(v,b),g(a,w),p(k,a,null),g(a,_),j=!0},p(e,s){(!j||4&s)&&F(t,"background-image","url("+ue(e[6].filename)+")"),(!j||4&s)&&M!==(M=e[6].filename+"")&&x(b,M),(!j||6&s&&V!==(V="/api/mailboxes/"+e[1].id+"/messages/"+e[2].id+"/attachments/"+e[6].id))&&$(a,"href",V),(!j||4&s&&y!==(y=e[6].filename))&&$(a,"download",y)},i(e){j||(D(k.$$.fragment,e),j=!0)},o(e){E(k.$$.fragment,e),j=!1},d(e){e&&d(a),I(k)}}}function we(e){let a,t,s=e[2].attachments,n=[];for(let r=0;r<s.length;r+=1)n[r]=xe(ve(e,s,r));const l=e=>E(n[e],1,1,(()=>{n[e]=null}));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();a=V()},l(e){for(let a=0;a<n.length;a+=1)n[a].l(e);a=V()},m(e,s){for(let a=0;a<n.length;a+=1)n[a].m(e,s);h(e,a,s),t=!0},p(e,t){if(6&t){let r;for(s=e[2].attachments,r=0;r<s.length;r+=1){const l=ve(e,s,r);n[r]?(n[r].p(l,t),D(n[r],1)):(n[r]=xe(l),n[r].c(),D(n[r],1),n[r].m(a.parentNode,a))}for(y(),r=s.length;r<n.length;r+=1)l(r);j()}},i(e){if(!t){for(let e=0;e<s.length;e+=1)D(n[e]);t=!0}},o(e){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)E(n[a]);t=!1},d(e){N(n,e),e&&d(a)}}}function ke(e){let a,t;return a=new $e({props:{$$slots:{default:[we]},$$scope:{ctx:e}}}),{c(){n(a.$$.fragment)},l(e){i(a.$$.fragment,e)},m(e,s){p(a,e,s),t=!0},p(e,t){const s={};518&t&&(s.$$scope={dirty:t,ctx:e}),a.$set(s)},i(e){t||(D(a.$$.fragment,e),t=!0)},o(e){E(a.$$.fragment,e),t=!1},d(e){I(a,e)}}}function De(e){var a;let t,s,n=(null==(a=e[2].attachments)?void 0:a.length)&&be(e);return{c(){n&&n.c(),t=V()},l(e){n&&n.l(e),t=V()},m(e,a){n&&n.m(e,a),h(e,t,a),s=!0},p(e,[a]){var s;(null==(s=e[2].attachments)?void 0:s.length)?n?(n.p(e,a),4&a&&D(n,1)):(n=be(e),n.c(),D(n,1),n.m(t.parentNode,t)):n&&(y(),E(n,1,1,(()=>{n=null})),j())},i(e){s||(D(n),s=!0)},o(e){E(n),s=!1},d(e){n&&n.d(e),e&&d(t)}}}function Ee(e,a,t){let s;M(e,pe,(e=>t(3,s=e)));let{mailbox:n}=a,{message:l}=a,{open:r=!1}=a;return e.$$set=e=>{"mailbox"in e&&t(1,n=e.mailbox),"message"in e&&t(2,l=e.message),"open"in e&&t(0,r=e.open)},[r,n,l,s,function(e){r=e,t(0,r)},()=>t(0,r=!r)]}class Ie extends e{constructor(e){super(),a(this,e,Ee,De,t,{mailbox:1,message:2,open:0})}}function _e(e,a,t){const s=e.slice();return s[17]=a[t],s[19]=t,s}function Ve(e){let a,t;return a=new Q({}),{c(){n(a.$$.fragment)},l(e){i(a.$$.fragment,e)},m(e,s){p(a,e,s),t=!0},i(e){t||(D(a.$$.fragment,e),t=!0)},o(e){E(a.$$.fragment,e),t=!1},d(e){I(a,e)}}}function ye(e){let a,t;return a=new W({}),{c(){n(a.$$.fragment)},l(e){i(a.$$.fragment,e)},m(e,s){p(a,e,s),t=!0},i(e){t||(D(a.$$.fragment,e),t=!0)},o(e){E(a.$$.fragment,e),t=!1},d(e){I(a,e)}}}function je(e){let a,t,r,f,u,x,w,V;return t=new Y({}),f=new me({}),{c(){a=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(a,"class","action btn-dark")},m(s,n){h(s,a,n),p(t,a,null),g(a,r),p(f,a,null),x=!0,w||(V=[v(u=ce.call(null,a,e[4].Mark_as_spam)),b(a,"click",e[8])],w=!0)},p(e,a){u&&k(u.update)&&16&a&&u.update.call(null,e[4].Mark_as_spam)},i(e){x||(D(t.$$.fragment,e),D(f.$$.fragment,e),x=!0)},o(e){E(t.$$.fragment,e),E(f.$$.fragment,e),x=!1},d(e){e&&d(a),I(t),I(f),w=!1,_(V)}}}function Me(e){let a,t,r,f,u,x,w,V;return t=new Z({}),f=new me({}),{c(){a=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(a,"class","action btn-dark")},m(s,n){h(s,a,n),p(t,a,null),g(a,r),p(f,a,null),x=!0,w||(V=[v(u=ce.call(null,a,e[4].This_is_not_spam)),b(a,"click",e[8])],w=!0)},p(e,a){u&&k(u.update)&&16&a&&u.update.call(null,e[4].This_is_not_spam)},i(e){x||(D(t.$$.fragment,e),D(f.$$.fragment,e),x=!0)},o(e){E(t.$$.fragment,e),E(f.$$.fragment,e),x=!1},d(e){e&&d(a),I(t),I(f),w=!1,_(V)}}}function Se(e){let a,t,r,f,u,x,w,V;return t=new O({}),f=new me({}),{c(){a=s("div"),n(t.$$.fragment),r=l(),n(f.$$.fragment),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);i(t.$$.fragment,s),r=m(s),i(f.$$.fragment,s),s.forEach(d),this.h()},h(){$(a,"class","action btn-dark")},m(s,n){h(s,a,n),p(t,a,null),g(a,r),p(f,a,null),x=!0,w||(V=[v(u=ce.call(null,a,e[4].Reply)),b(a,"click",e[11])],w=!0)},p(e,a){u&&k(u.update)&&16&a&&u.update.call(null,e[4].Reply)},i(e){x||(D(t.$$.fragment,e),D(f.$$.fragment,e),x=!0)},o(e){E(t.$$.fragment,e),E(f.$$.fragment,e),x=!1},d(e){e&&d(a),I(t),I(f),w=!1,_(V)}}}function Te(e){let a,t,r,f,u,x,w,V,M,S,T,A,F,N,P,z,R,B,L,K,O,Q,W,Y,Z,q,C,X,ae,te,se,oe,ie,de,$e,ue,he,ge,pe,ve,be,xe,we=!ne(e[1])&&!le(e[1]);r=new G({}),u=new me({});const ke=[ye,Ve],De=[];function Ee(e,a){return e[0].seen?0:1}T=Ee(e),A=De[T]=ke[T](e),N=new me({});const _e=[Me,je],Te=[];function Ae(e,a){return(null==R||2&a)&&(R=!!U(e[1])),R?0:((null==B||2&a)&&(B=!(ne(e[1])||le(e[1])||ee(e[1]))),B?1:-1)}~(L=Ae(e,-1))&&(K=Te[L]=_e[L](e)),W=new H({}),Z=new me({}),se=new J({}),ie=new me({});let Fe=we&&Se(e);return he=new fe({props:{mailbox:e[1],onMove:e[10]}}),pe=new Ie({props:{mailbox:e[1],message:e[0]}}),{c(){a=s("div"),t=s("a"),n(r.$$.fragment),f=l(),n(u.$$.fragment),V=l(),M=s("div"),S=s("div"),A.c(),F=l(),n(N.$$.fragment),z=l(),K&&K.c(),O=l(),Q=s("div"),n(W.$$.fragment),Y=l(),n(Z.$$.fragment),C=l(),X=s("div"),ae=s("div"),te=s("div"),n(se.$$.fragment),oe=l(),n(ie.$$.fragment),$e=l(),Fe&&Fe.c(),ue=l(),n(he.$$.fragment),ge=l(),n(pe.$$.fragment),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);t=c(s,"A",{class:!0,href:!0});var n=o(t);i(r.$$.fragment,n),f=m(n),i(u.$$.fragment,n),n.forEach(d),s.forEach(d),V=m(e),M=c(e,"DIV",{class:!0});var l=o(M);S=c(l,"DIV",{class:!0});var $=o(S);A.l($),F=m($),i(N.$$.fragment,$),$.forEach(d),z=m(l),K&&K.l(l),O=m(l),Q=c(l,"DIV",{class:!0});var h=o(Q);i(W.$$.fragment,h),Y=m(h),i(Z.$$.fragment,h),h.forEach(d),l.forEach(d),C=m(e),X=c(e,"DIV",{class:!0});var g=o(X);ae=c(g,"DIV",{class:!0});var p=o(ae);te=c(p,"DIV",{class:!0});var v=o(te);i(se.$$.fragment,v),oe=m(v),i(ie.$$.fragment,v),v.forEach(d),$e=m(p),Fe&&Fe.l(p),p.forEach(d),g.forEach(d),ue=m(e),i(he.$$.fragment,e),ge=m(e),i(pe.$$.fragment,e),this.h()},h(){$(t,"class","na action btn-dark"),$(t,"href",x="/mailbox/"+e[1].id),$(a,"class","action-group first-action svelte-1ed8sm"),$(S,"class","action btn-dark"),$(Q,"class","action btn-dark"),$(M,"class","action-group"),$(te,"class","action btn-dark"),$(ae,"class","action-group"),$(X,"class","action-group")},m(s,n){h(s,a,n),g(a,t),p(r,t,null),g(t,f),p(u,t,null),h(s,V,n),h(s,M,n),g(M,S),De[T].m(S,null),g(S,F),p(N,S,null),g(M,z),~L&&Te[L].m(M,null),g(M,O),g(M,Q),p(W,Q,null),g(Q,Y),p(Z,Q,null),h(s,C,n),h(s,X,n),g(X,ae),g(ae,te),p(se,te,null),g(te,oe),p(ie,te,null),g(ae,$e),Fe&&Fe.m(ae,null),h(s,ue,n),p(he,s,n),h(s,ge,n),p(pe,s,n),ve=!0,be||(xe=[v(w=ce.call(null,t,`${e[4].Back_to} ${re(e[1])}`)),v(P=ce.call(null,S,e[0].seen?e[4].Mark_as_seen:e[4].Mark_as_not_seen)),b(S,"click",e[7]),v(q=ce.call(null,Q,ee(e[1])?e[4].Delete_permanently:ne(e[1])?e[4].Discard_drafts:e[4].Delete)),b(Q,"click",e[9]),v(de=ce.call(null,te,e[4].Forward)),b(te,"click",e[12])],be=!0)},p(e,a){(!ve||2&a&&x!==(x="/mailbox/"+e[1].id))&&$(t,"href",x),w&&k(w.update)&&18&a&&w.update.call(null,`${e[4].Back_to} ${re(e[1])}`);let s=T;T=Ee(e),T!==s&&(y(),E(De[s],1,1,(()=>{De[s]=null})),j(),A=De[T],A||(A=De[T]=ke[T](e),A.c()),D(A,1),A.m(S,F)),P&&k(P.update)&&17&a&&P.update.call(null,e[0].seen?e[4].Mark_as_seen:e[4].Mark_as_not_seen);let n=L;L=Ae(e,a),L===n?~L&&Te[L].p(e,a):(K&&(y(),E(Te[n],1,1,(()=>{Te[n]=null})),j()),~L?(K=Te[L],K?K.p(e,a):(K=Te[L]=_e[L](e),K.c()),D(K,1),K.m(M,O)):K=null),q&&k(q.update)&&18&a&&q.update.call(null,ee(e[1])?e[4].Delete_permanently:ne(e[1])?e[4].Discard_drafts:e[4].Delete),de&&k(de.update)&&16&a&&de.update.call(null,e[4].Forward),2&a&&(we=!ne(e[1])&&!le(e[1])),we?Fe?(Fe.p(e,a),2&a&&D(Fe,1)):(Fe=Se(e),Fe.c(),D(Fe,1),Fe.m(ae,null)):Fe&&(y(),E(Fe,1,1,(()=>{Fe=null})),j());const l={};2&a&&(l.mailbox=e[1]),he.$set(l);const r={};2&a&&(r.mailbox=e[1]),1&a&&(r.message=e[0]),pe.$set(r)},i(e){ve||(D(r.$$.fragment,e),D(u.$$.fragment,e),D(A),D(N.$$.fragment,e),D(K),D(W.$$.fragment,e),D(Z.$$.fragment,e),D(se.$$.fragment,e),D(ie.$$.fragment,e),D(Fe),D(he.$$.fragment,e),D(pe.$$.fragment,e),ve=!0)},o(e){E(r.$$.fragment,e),E(u.$$.fragment,e),E(A),E(N.$$.fragment,e),E(K),E(W.$$.fragment,e),E(Z.$$.fragment,e),E(se.$$.fragment,e),E(ie.$$.fragment,e),E(Fe),E(he.$$.fragment,e),E(pe.$$.fragment,e),ve=!1},d(e){e&&d(a),I(r),I(u),e&&d(V),e&&d(M),De[T].d(),I(N),~L&&Te[L].d(),I(W),I(Z),e&&d(C),e&&d(X),I(se),I(ie),Fe&&Fe.d(),e&&d(ue),I(he,e),e&&d(ge),I(pe,e),be=!1,_(xe)}}}function Ae(e){let a;function t(e,a){return e[0].from.name?Ne:Fe}let n=t(e),l=n(e);return{c(){a=s("div"),l.c(),this.h()},l(e){a=c(e,"DIV",{class:!0});var t=o(a);l.l(t),t.forEach(d),this.h()},h(){$(a,"class","from svelte-1ed8sm")},m(e,t){h(e,a,t),l.m(a,null)},p(e,s){n===(n=t(e))&&l?l.p(e,s):(l.d(1),l=n(e),l&&(l.c(),l.m(a,null)))},d(e){e&&d(a),l.d()}}}function Fe(e){let a,t,n,l=e[0].from.address+"";return{c(){a=r("From: "),t=s("span"),n=r(l),this.h()},l(e){a=f(e,"From: "),t=c(e,"SPAN",{class:!0});var s=o(t);n=f(s,l),s.forEach(d),this.h()},h(){$(t,"class","from-only-address svelte-1ed8sm")},m(e,s){h(e,a,s),h(e,t,s),g(t,n)},p(e,a){1&a&&l!==(l=e[0].from.address+"")&&x(n,l)},d(e){e&&d(a),e&&d(t)}}}function Ne(e){let a,t,n,i,u,p,v,b=e[0].from.name+"",w=e[0].from.address+"";return{c(){a=r("From: "),t=s("span"),n=r(b),i=l(),u=r("<"),p=r(w),v=r(">"),this.h()},l(e){a=f(e,"From: "),t=c(e,"SPAN",{class:!0});var s=o(t);n=f(s,b),s.forEach(d),i=m(e),u=f(e,"<"),p=f(e,w),v=f(e,">"),this.h()},h(){$(t,"class","from-name svelte-1ed8sm")},m(e,s){h(e,a,s),h(e,t,s),g(t,n),h(e,i,s),h(e,u,s),h(e,p,s),h(e,v,s)},p(e,a){1&a&&b!==(b=e[0].from.name+"")&&x(n,b),1&a&&w!==(w=e[0].from.address+"")&&x(p,w)},d(e){e&&d(a),e&&d(t),e&&d(i),e&&d(u),e&&d(p),e&&d(v)}}}function Pe(e){let a,t,n,i=e[4]["To:"]+"",u=e[0].to,p=[];for(let s=0;s<u.length;s+=1)p[s]=ze(_e(e,u,s));return{c(){a=s("div"),t=r(i),n=l();for(let e=0;e<p.length;e+=1)p[e].c();this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);t=f(s,i),n=m(s);for(let a=0;a<p.length;a+=1)p[a].l(s);s.forEach(d),this.h()},h(){$(a,"class","to svelte-1ed8sm")},m(e,s){h(e,a,s),g(a,t),g(a,n);for(let t=0;t<p.length;t+=1)p[t].m(a,null)},p(e,s){if(16&s&&i!==(i=e[4]["To:"]+"")&&x(t,i),1&s){let t;for(u=e[0].to,t=0;t<u.length;t+=1){const n=_e(e,u,t);p[t]?p[t].p(n,s):(p[t]=ze(n),p[t].c(),p[t].m(a,null))}for(;t<p.length;t+=1)p[t].d(1);p.length=u.length}},d(e){e&&d(a),N(p,e)}}}function ze(e){let a,t,n,i=e[17].address+"",u=0!==e[19]&&function(e){let a;return{c(){a=r(",")},l(e){a=f(e,",")},m(e,t){h(e,a,t)},d(e){e&&d(a)}}}();return{c(){u&&u.c(),a=l(),t=s("span"),n=r(i),this.h()},l(e){u&&u.l(e),a=m(e),t=c(e,"SPAN",{class:!0});var s=o(t);n=f(s,i),s.forEach(d),this.h()},h(){$(t,"class","to-address svelte-1ed8sm")},m(e,s){u&&u.m(e,s),h(e,a,s),h(e,t,s),g(t,n)},p(e,a){1&a&&i!==(i=e[17].address+"")&&x(n,i)},d(e){u&&u.d(e),e&&d(a),e&&d(t)}}}function Re(e){let a,t,n,i,u=e[4]["Sent:"]+"",p=new Date(e[0].date).toLocaleString()+"";return{c(){a=s("div"),t=r(u),n=l(),i=r(p),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);t=f(s,u),n=m(s),i=f(s,p),s.forEach(d),this.h()},h(){$(a,"class","date svelte-1ed8sm")},m(e,s){h(e,a,s),g(a,t),g(a,n),g(a,i)},p(e,a){16&a&&u!==(u=e[4]["Sent:"]+"")&&x(t,u),1&a&&p!==(p=new Date(e[0].date).toLocaleString()+"")&&x(i,p)},d(e){e&&d(a)}}}function Be(e){let a,t,n,l;return{c(){a=s("div"),this.h()},l(e){a=c(e,"DIV",{class:!0}),o(a).forEach(d),this.h()},h(){$(a,"class","html")},m(s,r){h(s,a,r),n||(l=v(t=oe.call(null,a,{html:e[3],message:e[0]})),n=!0)},p(e,a){t&&k(t.update)&&9&a&&t.update.call(null,{html:e[3],message:e[0]})},d(e){e&&d(a),n=!1,l()}}}function Le(e){let a,t,n=(e[0].text||"")+"";return{c(){a=s("div"),t=r(n),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);t=f(s,n),s.forEach(d),this.h()},h(){$(a,"class","text svelte-1ed8sm")},m(e,s){h(e,a,s),g(a,t)},p(e,a){1&a&&n!==(n=(e[0].text||"")+"")&&x(t,n)},d(e){e&&d(a)}}}function Ge(e){let a,t,u,v,w,k,_,V,y,j,M,S,T,A,F,N,z,R=e[0].subject+"";t=new ie({props:{scrolled:e[2],$$slots:{default:[Te]},$$scope:{ctx:e}}});let L=e[0].from&&Ae(e),G=e[0].to&&Pe(e),H=e[0].date&&Re(e);function J(e,a){return e[3]?Be:Le}let O=J(e),Q=O(e);return{c(){a=s("div"),n(t.$$.fragment),u=l(),v=s("div"),w=s("div"),k=s("div"),_=r(R),V=l(),y=s("div"),L&&L.c(),j=l(),G&&G.c(),M=l(),H&&H.c(),S=l(),T=s("div"),Q.c(),this.h()},l(e){a=c(e,"DIV",{class:!0});var s=o(a);i(t.$$.fragment,s),u=m(s),v=c(s,"DIV",{class:!0});var n=o(v);w=c(n,"DIV",{class:!0});var l=o(w);k=c(l,"DIV",{class:!0});var r=o(k);_=f(r,R),r.forEach(d),V=m(l),y=c(l,"DIV",{class:!0});var $=o(y);L&&L.l($),j=m($),G&&G.l($),M=m($),H&&H.l($),$.forEach(d),l.forEach(d),S=m(n),T=c(n,"DIV",{class:!0});var h=o(T);Q.l(h),h.forEach(d),n.forEach(d),s.forEach(d),this.h()},h(){$(k,"class","subject svelte-1ed8sm"),$(y,"class","info svelte-1ed8sm"),$(w,"class","detail svelte-1ed8sm"),$(T,"class","body svelte-1ed8sm"),$(v,"class","message svelte-1ed8sm"),$(a,"class","page svelte-1ed8sm")},m(s,n){h(s,a,n),p(t,a,null),g(a,u),g(a,v),g(v,w),g(w,k),g(k,_),g(w,V),g(w,y),L&&L.m(y,null),g(y,j),G&&G.m(y,null),g(y,M),H&&H.m(y,null),g(v,S),g(v,T),Q.m(T,null),F=!0,N||(z=b(v,"scroll",e[5]),N=!0)},p(e,a){const s={};4&a&&(s.scrolled=e[2]),1048595&a&&(s.$$scope={dirty:a,ctx:e}),t.$set(s),(!F||1&a)&&R!==(R=e[0].subject+"")&&x(_,R),e[0].from?L?L.p(e,a):(L=Ae(e),L.c(),L.m(y,j)):L&&(L.d(1),L=null),e[0].to?G?G.p(e,a):(G=Pe(e),G.c(),G.m(y,M)):G&&(G.d(1),G=null),e[0].date?H?H.p(e,a):(H=Re(e),H.c(),H.m(y,null)):H&&(H.d(1),H=null),O===(O=J(e))&&Q?Q.p(e,a):(Q.d(1),Q=O(e),Q&&(Q.c(),Q.m(T,null)))},i(e){F||(D(t.$$.fragment,e),A||P((()=>{A=B(v,K,{duration:150,x:-20}),A.start()})),F=!0)},o(e){E(t.$$.fragment,e),F=!1},d(e){e&&d(a),I(t),L&&L.d(),G&&G.d(),H&&H.d(),Q.d(),N=!1,z()}}}function He(e){let a,s,n,r,c=`${e[0].mailbox}-${e[0].id}`;document.title=a=e[0].subject;let o=Ge(e);return{c(){s=l(),o.c(),n=V()},l(e){z('[data-svelte="svelte-1rfgw4w"]',document.head).forEach(d),s=m(e),o.l(e),n=V()},m(e,a){h(e,s,a),o.m(e,a),h(e,n,a),r=!0},p(e,[s]){(!r||1&s)&&a!==(a=e[0].subject)&&(document.title=a),1&s&&t(c,c=`${e[0].mailbox}-${e[0].id}`)?(y(),E(o,1,1,L),j(),o=Ge(e),o.c(),D(o),o.m(n.parentNode,n)):o.p(e,s)},i(e){r||(D(o),r=!0)},o(e){E(o),r=!1},d(e){e&&d(s),e&&d(n),o.d(e)}}}const Je=({page:e,fetch:a,session:t})=>q({page:e,fetch:a,session:t});function Ke(e,a,t){let s,n,l;M(e,pe,(e=>t(4,l=e)));var r,c=this&&this.__awaiter||function(e,a,t,s){return new(t||(t=Promise))((function(n,l){function r(e){try{o(s.next(e))}catch(a){l(a)}}function c(e){try{o(s.throw(e))}catch(a){l(a)}}function o(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,c)}o((s=s.apply(e,a||[])).next())}))};let{mailbox:o}=a,{message:i}=a,m=!1;const{user:f,mailboxes:d}=R("dash");M(e,d,(e=>t(14,n=e)));const $=C((()=>c(void 0,void 0,void 0,(function*(){try{t(0,i.seen=!i.seen,i),yield se(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),seen:i.seen})}catch(e){throw t(0,i.seen=!i.seen,i),e}})))),u=C((()=>c(void 0,void 0,void 0,(function*(){U(o)?yield g(n.find(X)):yield g(n.find(U))})))),h=C((()=>c(void 0,void 0,void 0,(function*(){ee(o)||U(o)?(yield ae(`/api/mailboxes/${o.id}/messages/${i.id}`),yield te(`/mailbox/${o.id}`)):yield g(n.find(ee))})))),g=C((e=>c(void 0,void 0,void 0,(function*(){o.id!==e.id&&(yield se(`/api/mailboxes/${o.id}/messages`,{message:String(i.id),moveTo:e.id}),yield te(`/mailbox/${o.id}`))})))),p=C((()=>c(void 0,void 0,void 0,(function*(){const e=n.find(ne);yield he(f,e,o,i.id)})))),v=C((()=>c(void 0,void 0,void 0,(function*(){const e=n.find(ne);yield ge(e,o,i.id)}))));return e.$$set=e=>{"mailbox"in e&&t(1,o=e.mailbox),"message"in e&&t(0,i=e.message)},e.$$.update=()=>{1&e.$$.dirty&&console.log({message:i}),8193&e.$$.dirty&&t(3,s=null===t(13,r=i.html)||void 0===r?void 0:r.join("").trim())},[i,o,m,s,l,e=>{let a=e.target;t(2,m=0!==a.scrollTop)},d,$,u,h,g,p,v,r]}class Oe extends e{constructor(e){super(),a(this,e,Ke,He,t,{mailbox:1,message:0})}}export{Oe as default,Je as load};
