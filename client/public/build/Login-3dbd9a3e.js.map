{"version":3,"file":"Login-3dbd9a3e.js","sources":["../../src/lib/router/routes/Login.svelte"],"sourcesContent":["<style>\n  form{\n    box-sizing: border-box; \n    border-top: 4px solid var(--pc);\n    border-radius: 3px;\n    box-shadow: 0 2px 4px 0 rgba(0,0,0,.2);\n    background: #fff;\n    padding: 3em;\n    width: 90%;\n    max-width: 400px;\n    margin: 0 auto;\n  }\n  \n  .field{\n    margin-bottom: 3em;\n  }\n\n  .button{\n    display: flex;\n    flex-direction: row-reverse;\n  }\n\n  h1 {\n    text-align: center;\n    margin: 2em 0;\n  }\n</style>\n\n<script>\n  import {getContext} from \"svelte\"; \n\n  //import Page from \"/comp/Page.svelte\";\n  import TextField from \"comp@TextField.svelte\";\n  import Password from \"comp@Password.svelte\";\n  //import Button from \"comp@Button.svelte\";\n  import {Button} from \"svelte-mui\";\n\n  import {getNotifier} from \"comp@Notify/notify.js\";\n\n  let username = \"\";\n  let password = \"\";\n\n  import {login} from \"lib@client/client.js\"\n\n  const handleSubmit = async event => {\n    \n    event.preventDefault();\n    \n    try {\n      const user = await fetch(\"/login\", {\n        method: \"POST\", \n        headers: {\"content-type\": \"application/json\"},\n        body: JSON.stringify({username, password})\n      }).then(res => res.json());\n\n      if(user.error) {\n        throw new Error(user.error.message);\n      }\n      location.href = \"/\";\n    } catch (e) {\n      getNotifier().add({variant: \"error\", text: e.message});\n    }\n  }\n\n  const {locale: l} = getContext(\"app\");\n  export let locale = $l.login;\n\n</script>\n\n<svelte:head>\n  <title>{locale.title}</title>\n</svelte:head>\n\n<h1>{locale.title}</h1>\n<form action=\"#!/login\" method=\"post\" on:submit={handleSubmit}>\n  <div class=\"field\">\n    <TextField bind:value={username} name=\"username\" label={locale.labels.username}/>\n  </div>\n  <div class=\"field\">\n    <Password bind:value={password} name=\"password\" label={locale.labels.password}/>\n  </div>\n  <div class=\"button\">\n    <Button color=\"var(--pc)\" raised>\n      {locale.action}\n    </Button>\n  </div>\n</form>"],"names":["ctx","action","title","labels","username","password","locale","l","getContext","$l","login","event","preventDefault","user","fetch","method","headers","content-type","body","JSON","stringify","then","res","json","error","Error","message","location","href","e","getNotifier","add","variant","text"],"mappings":"gRAmFOA,KAAOC,iEAAPD,KAAOC,qFAVTD,KAAOE,0DAHFF,KAAOE,mCAM2CF,KAAOG,OAAOC,mBAA/CJ,eAAAA,uHAGgCA,KAAOG,OAAOE,mBAA/CL,eAAAA,upBALuBA,kCAJvCA,KAAOE,6CAGZF,KAAOE,2CAGgDF,KAAOG,OAAOC,iCAA/CJ,qDAGgCA,KAAOG,OAAOE,iCAA/CL,oTApEpBI,EAAW,GACXC,EAAW,SAwBRC,OAAQC,GAAKC,EAAW,qCACpBF,EAASG,EAAGC,2EAnBrBC,EAAMC,2BAGEC,QAAaC,MAAM,UACvBC,OAAQ,OACRC,SAAUC,eAAgB,oBAC1BC,KAAMC,KAAKC,WAAWhB,SAAAA,EAAUC,SAAAA,MAC/BgB,KAAKC,GAAOA,EAAIC,WAEhBV,EAAKW,gBACIC,MAAMZ,EAAKW,MAAME,SAE7BC,SAASC,KAAO,UACTC,GACPC,IAAcC,KAAKC,QAAS,QAASC,KAAMJ,EAAEH,4BA4CxBtB,wBAGDC"}