import{J as e,S as t,a as n,s,b as l,c as o,d as i,e as a,n as r,f as c,K as d,k as m,m as u,l as g,E as $,L as f,M as h,o as p,r as x,p as w,N as v,q as b,x as B,y as L,z as y,A as z,F as k,B as M,G as H,H as A,O as V,P as j,Q as C,R as D,U as S,V as Z,W as _,X as R,Y as T,Z as E,_ as F,$ as P,a0 as U,a1 as Y,a2 as N,a3 as I,a4 as K,a5 as q,a6 as G,a7 as J,a8 as O,a9 as Q,aa as W,ab as X,ac as ee,ad as te,ae as ne,af as se,ag as le,ah as oe,u as ie,ai as ae}from"./main-9f15064e.js";import{T as re,a as ce,M as de,b as me,c as ue,U as ge}from"./MoveTo-38d38150.js";function $e(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M12,15.39L8.24,17.66L9.23,13.38L5.91,10.5L10.29,10.13L12,6.09L13.71,10.13L18.09,10.5L14.77,13.38L15.76,17.66M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function fe(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class he extends t{constructor(e){super(),n(this,e,fe,$e,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function pe(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function xe(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class we extends t{constructor(e){super(),n(this,e,xe,pe,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function ve(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function be(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class Be extends t{constructor(e){super(),n(this,e,be,ve,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Le(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M10,17L5,12L6.41,10.58L10,14.17L17.59,6.58L19,8M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function ye(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class ze extends t{constructor(e){super(),n(this,e,ye,Le,s,{size:4,width:0,height:1,color:2,viewBox:3})}}const ke=(e,t)=>{const n=new Date,s=new Date(e);return n.getFullYear()!==s.getFullYear()?`${t.months[s.getMonth()]} ${s.getFullYear()}`:n.getMonth()!==s.getMonth()?`${s.getDate()} ${t.months[s.getMonth()]}`:n.getDate()!==s.getDate()?`${t.weekDays[s.getDay()]} ${s.getDate()}`:`${s.getHours()}:${l=s.getMinutes(),l.toString().padStart(2,"0")}`;var l};function Me(e){let t;const n=new Be({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function He(e){let t;const n=new ze({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function Ae(e){let t;const n=new he({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function Ve(e){let t;const n=new we({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function je(e){let t,n=(e[7].from.name||e[7].from.address||"")+"";return{c(){t=$(n)},m(e,n){i(e,t,n)},p(e,s){128&s&&n!==(n=(e[7].from.name||e[7].from.address||"")+"")&&k(t,n)},d(e){e&&c(t)}}}function Ce(e){let t,n,s,l,r=e[2].mailboxMessage.to+"",d=(e[7].to||[]).map(Se).filter(Boolean).join(", ")+"";return{c(){t=m("span"),n=$(r),s=u(),l=$(d),o(t,"class","for")},m(e,o){i(e,t,o),a(t,n),a(t,s),i(e,l,o)},p(e,t){4&t&&r!==(r=e[2].mailboxMessage.to+"")&&k(n,r),128&t&&d!==(d=(e[7].to||[]).map(Se).filter(Boolean).join(", ")+"")&&k(l,d)},d(e){e&&c(t),e&&c(l)}}}function De(e){let t,n,s,l,r,H,A,V,j,C,D,S,Z,_,R,T,E,F,P,U,Y,N,I,K,q,G,J=(e[7].subject||"")+"",O=(e[7].intro||"")+"",Q=(e[7].date&&ke(e[7].date,e[2]))+"";const W=[He,Me],X=[];function ee(e,t){return e[5]?0:1}s=ee(e),l=X[s]=W[s](e);const te=new d({}),ne=[Ve,Ae],se=[];function le(e,t){return e[7].flagged?0:1}V=le(e),j=se[V]=ne[V](e);const oe=new d({});function ie(e,t){return e[4]||e[3]?Ce:je}let ae=ie(e),re=ae(e);return{c(){t=m("a"),n=m("x-cell"),l.c(),r=u(),g(te.$$.fragment),H=u(),A=m("x-cell"),j.c(),C=u(),g(oe.$$.fragment),D=u(),S=m("x-cell-group"),Z=m("x-cell"),re.c(),_=u(),R=m("x-cell"),T=m("span"),E=$(J),F=u(),P=m("span"),U=$(O),Y=u(),N=m("x-cell"),I=$(Q),f(n,"class","btn-dark icon cell-selected svelte-2l64lx"),f(A,"class","btn-dark icon svelte-2l64lx"),h(A,"flagged",e[7].flagged),f(Z,"class","from svelte-2l64lx"),o(T,"class","subject"),o(P,"class","intro svelte-2l64lx"),f(R,"class","subject-intro svelte-2l64lx"),f(N,"class","date svelte-2l64lx"),f(S,"class","from-subject-date svelte-2l64lx"),o(t,"href",K="#!/mailbox/"+e[6].id+"/message/"+e[7].id),o(t,"class","na message svelte-2l64lx"),h(t,"selected",e[5]),h(t,"unseen",!e[7].seen)},m(l,o,c){i(l,t,o),a(t,n),X[s].m(n,null),a(n,r),p(te,n,null),a(t,H),a(t,A),se[V].m(A,null),a(A,C),p(oe,A,null),a(t,D),a(t,S),a(S,Z),re.m(Z,null),a(S,_),a(S,R),a(R,T),a(T,E),a(R,F),a(R,P),a(P,U),a(S,Y),a(S,N),a(N,I),q=!0,c&&x(G),G=[w(n,"click",v(b(e[19]))),w(A,"click",v(b(e[10]))),w(t,"click",e[11])]},p(e,[i]){let a=s;s=ee(e),s!==a&&(B(),L(X[a],1,1,()=>{X[a]=null}),y(),l=X[s],l||(l=X[s]=W[s](e),l.c()),z(l,1),l.m(n,r));let c=V;V=le(e),V!==c&&(B(),L(se[c],1,1,()=>{se[c]=null}),y(),j=se[V],j||(j=se[V]=ne[V](e),j.c()),z(j,1),j.m(A,C)),128&i&&h(A,"flagged",e[7].flagged),ae===(ae=ie(e))&&re?re.p(e,i):(re.d(1),re=ae(e),re&&(re.c(),re.m(Z,null))),(!q||128&i)&&J!==(J=(e[7].subject||"")+"")&&k(E,J),(!q||128&i)&&O!==(O=(e[7].intro||"")+"")&&k(U,O),(!q||132&i)&&Q!==(Q=(e[7].date&&ke(e[7].date,e[2]))+"")&&k(I,Q),(!q||192&i&&K!==(K="#!/mailbox/"+e[6].id+"/message/"+e[7].id))&&o(t,"href",K),32&i&&h(t,"selected",e[5]),128&i&&h(t,"unseen",!e[7].seen)},i(e){q||(z(l),z(te.$$.fragment,e),z(j),z(oe.$$.fragment,e),q=!0)},o(e){L(l),L(te.$$.fragment,e),L(j),L(oe.$$.fragment,e),q=!1},d(e){e&&c(t),X[s].d(),M(te),se[V].d(),M(oe),re.d(),x(G)}}}const Se=e=>e.name||e.address;function Ze(t,n,s){let l,o,i,a,c=r,d=()=>(c(),c=V(B,e=>s(6,o=e)),B),m=r,u=()=>(m(),m=V(x,e=>s(7,i=e)),x);t.$$.on_destroy.push(()=>c()),t.$$.on_destroy.push(()=>m());const g=H("mailbox-selection"),{isSelected:$,add:f,remove:h,toggle:p}=g;A(t,$,e=>s(14,l=e));let{message:x}=n;u();let w,v,b,{mailbox:B}=n;d();let L;j(()=>L&&L());const{locale:y}=H("app");A(t,y,e=>s(15,a=e));let{locale:z=a}=n;return t.$set=e=>{"message"in e&&u(s(0,x=e.message)),"mailbox"in e&&d(s(1,B=e.mailbox)),"locale"in e&&s(2,z=e.locale)},t.$$.update=()=>{2&t.$$.dirty&&s(3,w=B===C),2&t.$$.dirty&&s(4,v=B===D),16385&t.$$.dirty&&s(5,b=l(x))},[x,B,z,w,v,b,o,i,$,p,e=>{S(o.id,[i.id],!i.flagged),x.update(e=>({...e,flagged:!e.flagged}))},async t=>{if(w){t.preventDefault(),i.seen||x.update(e=>({...e,seen:!0}));const n=await Z(i.id),s=e(n);L=s.subscribe(e=>{x.update(t=>({...t,...e}))}),_(s)}},y,L,l,a,g,f,h,()=>p(x)]}class _e extends t{constructor(e){super(),n(this,e,Ze,De,s,{message:0,mailbox:1,locale:2})}}function Re(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function Te(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class Ee extends t{constructor(e){super(),n(this,e,Te,Re,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Fe(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19M17,17H7V7H17V17Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function Pe(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class Ue extends t{constructor(e){super(),n(this,e,Pe,Fe,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Ye(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function Ne(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class Ie extends t{constructor(e){super(),n(this,e,Ne,Ye,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Ke(e){let t,n;return{c(){t=l("svg"),n=l("path"),o(n,"d","M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"),o(n,"fill",e[2]),o(t,"width",e[0]),o(t,"height",e[1]),o(t,"viewBox",e[3])},m(e,s){i(e,t,s),a(t,n)},p(e,[s]){4&s&&o(n,"fill",e[2]),1&s&&o(t,"width",e[0]),2&s&&o(t,"height",e[1]),8&s&&o(t,"viewBox",e[3])},i:r,o:r,d(e){e&&c(t)}}}function qe(e,t,n){let{size:s="1em"}=t,{width:l=s}=t,{height:o=s}=t,{color:i="currentColor"}=t,{viewBox:a="0 0 24 24"}=t;return e.$set=e=>{"size"in e&&n(4,s=e.size),"width"in e&&n(0,l=e.width),"height"in e&&n(1,o=e.height),"color"in e&&n(2,i=e.color),"viewBox"in e&&n(3,a=e.viewBox)},[l,o,i,a,s]}class Ge extends t{constructor(e){super(),n(this,e,qe,Ke,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Je(e,t,n){const s=e.slice();return s[41]=t[n],s}function Oe(e){let t;const n=new Ue({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function Qe(e){let t;const n=new ze({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function We(e){let t;const n=new Be({});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}function Xe(e){let t,n,s,l,r,h,x,v,b,H,A,V,j,C,D,S,Z,_,R,T,E,F,P=e[18]("selection.title",{n:e[13].length})+"";const Y=[tt,et],N=[];function I(e,t){return 8192&t[0]&&(s=!!e[13].every(gt)),s?0:1}l=I(e,[-1]),r=N[l]=Y[l](e);const K=[st,nt],q=[];function G(e,t){return e[6]?0:e[8]||e[9]||e[7]?-1:1}~(x=G(e))&&(v=q[x]=K[x](e));const J=new le({}),O=new d({}),Q=new de({props:{mailbox:e[0],selection:e[3]}});Q.$on("moved",e[20]);const W=new Ie({});return{c(){t=m("div"),n=m("x-action-group"),r.c(),h=u(),v&&v.c(),b=u(),H=m("x-action"),g(J.$$.fragment),A=u(),g(O.$$.fragment),j=u(),C=m("x-action-group"),g(Q.$$.fragment),D=u(),S=m("x-selection-info"),g(W.$$.fragment),Z=u(),_=m("span"),R=$(P),f(H,"class","btn-dark"),f(H,"data-tooltip",V=e[7]?e[5].actions.deletePermanently:e[8]?e[5].actions.discardDrafts:e[5].actions.delete),o(_,"class","svelte-slbuxn"),f(S,"class","svelte-slbuxn"),o(t,"class","only-when-selection svelte-slbuxn")},m(s,o,r){i(s,t,o),a(t,n),N[l].m(n,null),a(n,h),~x&&q[x].m(n,null),a(n,b),a(n,H),p(J,H,null),a(H,A),p(O,H,null),a(t,j),a(t,C),p(Q,C,null),a(t,D),a(t,S),p(W,S,null),a(S,Z),a(S,_),a(_,R),E=!0,r&&F(),F=w(H,"click",e[39])},p(e,t){let s=l;l=I(e,t),l===s?N[l].p(e,t):(B(),L(N[s],1,1,()=>{N[s]=null}),y(),r=N[l],r||(r=N[l]=Y[l](e),r.c()),z(r,1),r.m(n,h));let o=x;x=G(e),x===o?~x&&q[x].p(e,t):(v&&(B(),L(q[o],1,1,()=>{q[o]=null}),y()),~x?(v=q[x],v||(v=q[x]=K[x](e),v.c()),z(v,1),v.m(n,b)):v=null),(!E||416&t[0]&&V!==(V=e[7]?e[5].actions.deletePermanently:e[8]?e[5].actions.discardDrafts:e[5].actions.delete))&&f(H,"data-tooltip",V);const i={};1&t[0]&&(i.mailbox=e[0]),8&t[0]&&(i.selection=e[3]),Q.$set(i),(!E||270336&t[0])&&P!==(P=e[18]("selection.title",{n:e[13].length})+"")&&k(R,P)},i(e){E||(z(r),z(v),z(J.$$.fragment,e),z(O.$$.fragment,e),z(Q.$$.fragment,e),z(W.$$.fragment,e),e&&U(()=>{T||(T=X(t,ee,{duration:150},!0)),T.run(1)}),E=!0)},o(e){L(r),L(v),L(J.$$.fragment,e),L(O.$$.fragment,e),L(Q.$$.fragment,e),L(W.$$.fragment,e),e&&(T||(T=X(t,ee,{duration:150},!1)),T.run(0)),E=!1},d(e){e&&c(t),N[l].d(),~x&&q[x].d(),M(J),M(O),M(Q),M(W),e&&T&&T.end(),F()}}}function et(e){let t,n,s,l,o;const r=new me({}),$=new d({});return{c(){t=m("x-action"),g(r.$$.fragment),n=u(),g($.$$.fragment),f(t,"class","btn-dark"),f(t,"data-tooltip",s=e[5].actions.markAsUnread)},m(s,c,d){i(s,t,c),p(r,t,null),a(t,n),p($,t,null),l=!0,d&&o(),o=w(t,"click",e[36])},p(e,n){(!l||32&n[0]&&s!==(s=e[5].actions.markAsUnread))&&f(t,"data-tooltip",s)},i(e){l||(z(r.$$.fragment,e),z($.$$.fragment,e),l=!0)},o(e){L(r.$$.fragment,e),L($.$$.fragment,e),l=!1},d(e){e&&c(t),M(r),M($),o()}}}function tt(e){let t,n,s,l,o;const r=new ue({}),$=new d({});return{c(){t=m("x-action"),g(r.$$.fragment),n=u(),g($.$$.fragment),f(t,"class","btn-dark"),f(t,"data-tooltip",s=e[5].actions.markAsRead)},m(s,c,d){i(s,t,c),p(r,t,null),a(t,n),p($,t,null),l=!0,d&&o(),o=w(t,"click",e[35])},p(e,n){(!l||32&n[0]&&s!==(s=e[5].actions.markAsRead))&&f(t,"data-tooltip",s)},i(e){l||(z(r.$$.fragment,e),z($.$$.fragment,e),l=!0)},o(e){L(r.$$.fragment,e),L($.$$.fragment,e),l=!1},d(e){e&&c(t),M(r),M($),o()}}}function nt(e){let t,n,s,l,o;const r=new oe({}),$=new d({});return{c(){t=m("x-action"),g(r.$$.fragment),n=u(),g($.$$.fragment),f(t,"class","btn-dark"),f(t,"data-tooltip",s=e[5].actions.markAsSpam)},m(s,c,d){i(s,t,c),p(r,t,null),a(t,n),p($,t,null),l=!0,d&&o(),o=w(t,"click",e[38])},p(e,n){(!l||32&n[0]&&s!==(s=e[5].actions.markAsSpam))&&f(t,"data-tooltip",s)},i(e){l||(z(r.$$.fragment,e),z($.$$.fragment,e),l=!0)},o(e){L(r.$$.fragment,e),L($.$$.fragment,e),l=!1},d(e){e&&c(t),M(r),M($),o()}}}function st(e){let t,n,s,l,o;const r=new ge({}),$=new d({});return{c(){t=m("x-action"),g(r.$$.fragment),n=u(),g($.$$.fragment),f(t,"class","btn-dark"),f(t,"data-tooltip",s=e[5].actions.unMarkAsSpam)},m(s,c,d){i(s,t,c),p(r,t,null),a(t,n),p($,t,null),l=!0,d&&o(),o=w(t,"click",e[37])},p(e,n){(!l||32&n[0]&&s!==(s=e[5].actions.unMarkAsSpam))&&f(t,"data-tooltip",s)},i(e){l||(z(r.$$.fragment,e),z($.$$.fragment,e),l=!0)},o(e){L(r.$$.fragment,e),L($.$$.fragment,e),l=!1},d(e){e&&c(t),M(r),M($),o()}}}function lt(e){let t,n,s,l,o,r,$,h,v,b,k,H,A,V,j;const C=new d({}),D=[We,Qe,Oe],S=[];function Z(e,t){return 0===e[13].length?0:e[13].length===e[14].length?1:2}l=Z(e),o=S[l]=D[l](e);const _=new Ee({}),R=new d({});let T=0!==e[13].length&&Xe(e);return{c(){t=m("x-action-group"),n=m("x-action"),g(C.$$.fragment),s=u(),o.c(),$=u(),h=m("x-action"),v=m("div"),g(_.$$.fragment),b=u(),g(R.$$.fragment),H=u(),T&&T.c(),A=I(),f(n,"class","btn-dark"),f(n,"data-tooltip",r=e[5].actions.select),te(v,"display","flex"),te(v,"transition","transform 300ms ease"),te(v,"transform","rotate("+360*e[10]+"deg)"),f(h,"class","btn-dark reload"),f(h,"data-tooltip",k=e[5].actions.reload),f(t,"class","select svelte-slbuxn")},m(o,r,c){i(o,t,r),a(t,n),p(C,n,null),a(n,s),S[l].m(n,null),a(t,$),a(t,h),a(h,v),p(_,v,null),a(h,b),p(R,h,null),i(o,H,r),T&&T.m(o,r),i(o,A,r),V=!0,c&&x(j),j=[w(n,"click",e[19]),w(h,"click",e[24])]},p(e,t){let s=l;l=Z(e),l!==s&&(B(),L(S[s],1,1,()=>{S[s]=null}),y(),o=S[l],o||(o=S[l]=D[l](e),o.c()),z(o,1),o.m(n,null)),(!V||32&t[0]&&r!==(r=e[5].actions.select))&&f(n,"data-tooltip",r),(!V||1024&t[0])&&te(v,"transform","rotate("+360*e[10]+"deg)"),(!V||32&t[0]&&k!==(k=e[5].actions.reload))&&f(h,"data-tooltip",k),0!==e[13].length?T?(T.p(e,t),8192&t[0]&&z(T,1)):(T=Xe(e),T.c(),z(T,1),T.m(A.parentNode,A)):T&&(B(),L(T,1,1,()=>{T=null}),y())},i(e){V||(z(C.$$.fragment,e),z(o),z(_.$$.fragment,e),z(R.$$.fragment,e),z(T),V=!0)},o(e){L(C.$$.fragment,e),L(o),L(_.$$.fragment,e),L(R.$$.fragment,e),L(T),V=!1},d(e){e&&c(t),M(C),S[l].d(),M(_),M(R),e&&c(H),T&&T.d(e),e&&c(A),x(j)}}}function ot(e){let t,n=!e[11]&&it(e);return{c(){n&&n.c(),t=I()},m(e,s){n&&n.m(e,s),i(e,t,s)},p(e,s){e[11]?n&&(n.d(1),n=null):n?n.p(e,s):(n=it(e),n.c(),n.m(t.parentNode,t))},d(e){n&&n.d(e),e&&c(t)}}}function it(e){let t,n,s,l=e[5].mailbox.empty+"";return{c(){t=m("x-mailbox-empty"),n=m("span"),s=$(l),o(n,"class","label svelte-slbuxn"),f(t,"class","svelte-slbuxn")},m(e,l){i(e,t,l),a(t,n),a(n,s)},p(e,t){32&t[0]&&l!==(l=e[5].mailbox.empty+"")&&k(s,l)},d(e){e&&c(t)}}}function at(e,t){let n,s,l,o;const a=new _e({props:{message:t[41],mailbox:t[0]}});return{key:e,first:null,c(){n=m("x-mailbox-message"),g(a.$$.fragment),f(n,"class","svelte-slbuxn"),this.first=n},m(e,t){i(e,n,t),p(a,n,null),o=!0},p(e,t){const n={};16384&t[0]&&(n.message=e[41]),1&t[0]&&(n.mailbox=e[0]),a.$set(n)},i(e){o||(z(a.$$.fragment,e),e&&U(()=>{l&&l.end(1),s||(s=Y(n,t[26],{duration:150})),s.start()}),o=!0)},o(e){L(a.$$.fragment,e),s&&s.invalidate(),e&&(l=N(n,t[27],{})),o=!1},d(e){e&&c(n),M(a),e&&l&&l.end()}}}function rt(e){let t,n,s,l;const o=[dt,ct],a=[];function r(e,t){return e[11]?0:e[16]?1:-1}return~(n=r(e))&&(s=a[n]=o[n](e)),{c(){t=m("x-loadmore"),s&&s.c(),f(t,"class","svelte-slbuxn")},m(e,s){i(e,t,s),~n&&a[n].m(t,null),l=!0},p(e,l){let i=n;n=r(e),n===i?~n&&a[n].p(e,l):(s&&(B(),L(a[i],1,1,()=>{a[i]=null}),y()),~n?(s=a[n],s||(s=a[n]=o[n](e),s.c()),z(s,1),s.m(t,null)):s=null)},i(e){l||(z(s),l=!0)},o(e){L(s),l=!1},d(e){e&&c(t),~n&&a[n].d()}}}function ct(e){let t,n,s,l,o;const $=new Ge({}),h=new d({});return{c(){t=m("x-loadmore-button"),g($.$$.fragment),n=u(),g(h.$$.fragment),f(t,"class","btn-dark svelte-slbuxn")},m(s,r,c){i(s,t,r),p($,t,null),a(t,n),p(h,t,null),l=!0,c&&o(),o=w(t,"click",e[25])},p:r,i(e){l||(z($.$$.fragment,e),z(h.$$.fragment,e),e&&(s||U(()=>{s=Y(t,ee,{delay:150,duration:150}),s.start()})),l=!0)},o(e){L($.$$.fragment,e),L(h.$$.fragment,e),l=!1},d(e){e&&c(t),M($),M(h),o()}}}function dt(e){let t,n,s;const l=new ne({props:{size:"0.75em"}});return{c(){t=m("x-loadmore-loading"),g(l.$$.fragment),f(t,"class","svelte-slbuxn")},m(e,n){i(e,t,n),p(l,t,null),s=!0},p:r,i(e){s||(z(l.$$.fragment,e),e&&(n||U(()=>{n=Y(t,ee,{delay:150,duration:150}),n.start()})),s=!0)},o(e){L(l.$$.fragment,e),s=!1},d(e){e&&c(t),M(l)}}}function mt(e){let t,n,s,l,o,r=[],d=new Map;const $=new ce({props:{scrolled:0!==e[17],$$slots:{default:[lt]},$$scope:{ctx:e}}});let h=e[14];const x=e=>`${e[15].id}-${e[41].get().id}`;for(let t=0;t<h.length;t+=1){let n=Je(e,h,t),s=x(n);d.set(s,r[t]=at(s,n))}let v=null;h.length||(v=ot(e));let b=(e[11]||e[16])&&rt(e);return{c(){g($.$$.fragment),t=u(),n=m("x-tab-content");for(let e=0;e<r.length;e+=1)r[e].c();v&&v.c(),s=u(),b&&b.c(),f(n,"class","svelte-slbuxn")},m(c,d,m){p($,c,d),i(c,t,d),i(c,n,d);for(let e=0;e<r.length;e+=1)r[e].m(n,null);v&&v.m(n,null),a(n,s),b&&b.m(n,null),l=!0,m&&o(),o=w(n,"scroll",e[40])},p(e,t){const l={};if(131072&t[0]&&(l.scrolled=0!==e[17]),288745&t[0]|8192&t[1]&&(l.$$scope={dirty:t,ctx:e}),$.$set(l),18465&t[0]){const l=e[14];B(),r=K(r,t,x,1,e,l,d,n,se,at,s,Je),y(),!l.length&&v?v.p(e,t):l.length?v&&(v.d(1),v=null):(v=ot(e),v.c(),v.m(n,s))}e[11]||e[16]?b?(b.p(e,t),67584&t[0]&&z(b,1)):(b=rt(e),b.c(),z(b,1),b.m(n,null)):b&&(B(),L(b,1,1,()=>{b=null}),y())},i(e){if(!l){z($.$$.fragment,e);for(let e=0;e<h.length;e+=1)z(r[e]);z(b),l=!0}},o(e){L($.$$.fragment,e);for(let e=0;e<r.length;e+=1)L(r[e]);L(b),l=!1},d(e){M($,e),e&&c(t),e&&c(n);for(let e=0;e<r.length;e+=1)r[e].d();v&&v.d(),b&&b.d(),o()}}}function ut(e){let t,n,s;document.title=t=(e[15].unseen?`(${e[15].unseen}) `:"")+e[12].label;const l=new re({props:{$$slots:{default:[mt]},$$scope:{ctx:e}}});return{c(){n=u(),g(l.$$.fragment)},m(e,t){i(e,n,t),p(l,e,t),s=!0},p(e,n){(!s||36864&n[0])&&t!==(t=(e[15].unseen?`(${e[15].unseen}) `:"")+e[12].label)&&(document.title=t);const o={};487401&n[0]|8192&n[1]&&(o.$$scope={dirty:n,ctx:e}),l.$set(o)},i(e){s||(z(l.$$.fragment,e),s=!0)},o(e){L(l.$$.fragment,e),s=!1},d(e){e&&c(n),M(l,e)}}}const gt=e=>!e.get().seen;function $t(t,n,s){let l,o,i,a,c,d,m,u=r,g=()=>(u(),u=V(k,e=>s(13,l=e)),k),$=r,f=()=>($(),$=V(L,e=>s(14,o=e)),L),h=r,p=()=>(h(),h=V(B,e=>s(15,i=e)),B),x=r,w=()=>(x(),x=V(y,e=>s(16,a=e)),y),v=r,b=()=>(v(),v=V(_,e=>s(17,d=e)),_);t.$$.on_destroy.push(()=>u()),t.$$.on_destroy.push(()=>$()),t.$$.on_destroy.push(()=>h()),t.$$.on_destroy.push(()=>x()),t.$$.on_destroy.push(()=>v());let{mailbox:B}=n;p();let{messages:L}=n;f();let{next:y}=n;w();let{prev:z}=n,{selection:k}=n;g();let M,j,S,Z,{scroll:_}=n;b(),R("mailbox-selection",k);const U=()=>{const e=k.get();L.update(t=>t.filter(t=>!e.includes(t))),k.clear(),L.get().length<10&&te()},Y=async e=>{l.length&&(l.forEach(t=>t.update(t=>({...t,seen:e}))),k.invalidate(),await q(i.id,l.map(e=>e.get().id),e))},N=async e=>{G(i.id,l.map(e=>e.get().id),e),U()},I=async()=>{J(i.id,l.map(e=>e.get().id)),U()};let K=!1,X=0;let ee=!1;const te=async()=>{if(!a)return;s(11,ee=!0);const t=await Q(i.id,a);L.update(n=>[...n,...t.messages.map(t=>e(t))]),y.set(t.next),z.set(t.prev),s(11,ee=!1)},{locale:ne,trans:se}=H("app");A(t,ne,e=>s(32,c=e)),A(t,se,e=>s(18,m=e));let le,{locale:oe=c}=n;const ie={matchKeys:["from","subject","intro"],sleep:e=>new Promise(t=>setTimeout(t,e)),loadMore:async(e=1)=>{for(let t=0;t<e;t++)console.log("loading page "+(t+1)),await te(),await ie.sleep(250)},select:e=>{console.log(k);let t=0;for(const n of o)ae(e,n.get())&&(t++,k.add(n));console.log(`selected ${t} messages`)}},ae=(e,t)=>{if(console.log(e,t,!1),e.from)if(e.from instanceof RegExp){if(e.from.test(t.from.address||"")||e.from.test(t.from.name||""))return!0}else if((t.from.address||"").includes(e.from)||(t.from.name||"").includes(e.from))return!0;if(e.subject)if(e.subject instanceof RegExp){if(e.subject.test(t.subject))return!0}else if(t.subject.includes(e.subject))return!0;if(e.intro)if(e.intro instanceof RegExp){if(e.intro.test(t.intro))return!0}else if(t.intro.includes(e.intro))return!0;return!1};T(()=>(window.mailbox=ie,()=>{window.mailbox===ie&&(window.mailbox=null)})),console.log(o);return t.$set=e=>{"mailbox"in e&&p(s(0,B=e.mailbox)),"messages"in e&&f(s(1,L=e.messages)),"next"in e&&w(s(2,y=e.next)),"prev"in e&&s(30,z=e.prev),"selection"in e&&g(s(3,k=e.selection)),"scroll"in e&&b(s(4,_=e.scroll)),"locale"in e&&s(5,oe=e.locale)},t.$$.update=()=>{1&t.$$.dirty[0]&&s(6,M=B===E),1&t.$$.dirty[0]&&s(7,j=B===F),1&t.$$.dirty[0]&&s(8,S=B===C),1&t.$$.dirty[0]&&s(9,Z=B===D),32800&t.$$.dirty[0]&&s(12,le=P(i,oe.mailbox.title))},[B,L,y,k,_,oe,M,j,S,Z,X,ee,le,l,o,i,a,d,m,()=>{k.update(e=>l.length!==o.length?o.slice():[])},U,Y,N,I,async()=>{if(K)return;s(10,X++,X),K=!0;const t=await O(i.id);L.set(t.messages.map(t=>e(t))),z.set(t.prev),y.set(t.next),k.clear(),K=!1},te,(e,t)=>(e.classList.add("removed"),e.style.zIndex="1",setTimeout(()=>e.classList.remove("removed"),1),setTimeout(()=>e.style.zIndex=null,150),{duration:150}),e=>(e.classList.add("removed"),{duration:150}),ne,se,z,K,c,ie,ae,()=>Y(!0),()=>Y(!1),()=>N(!1),()=>N(!0),()=>I(),e=>W(_,d=e.target.scrollTop)]}class ft extends t{constructor(e){super(),n(this,e,$t,ut,s,{mailbox:0,messages:1,next:2,prev:30,selection:3,scroll:4,locale:5},[-1,-1])}}function ht(e){let t;const n=new ft({props:{mailbox:e[0],messages:e[1],prev:e[2],next:e[3],selection:e[4],scroll:e[5]}});return{c(){g(n.$$.fragment)},m(e,s){p(n,e,s),t=!0},p(e,[t]){const s={};1&t&&(s.mailbox=e[0]),2&t&&(s.messages=e[1]),4&t&&(s.prev=e[2]),8&t&&(s.next=e[3]),16&t&&(s.selection=e[4]),32&t&&(s.scroll=e[5]),n.$set(s)},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){L(n.$$.fragment,e),t=!1},d(e){M(n,e)}}}async function pt(t,{client:n}){if(!ie.get())return this.redirect("#!/login");const s=ae(t.params.mailbox);if(null==s)return this.error({code:404,message:"La página no existe"});{const n=await O(t.params.mailbox),l=e(n.messages.map(t=>e(t))),o=e(n.next);return{mailbox:s,messages:l,prev:e(n.prev),next:o,selection:((t=[])=>{const n=e(t),s=(...e)=>{const t=n.get().slice();for(const s of e)t.includes(s)||t.push(s),n.set(t)},l=(...e)=>n.update(t=>t.filter(t=>!e.includes(t))),o=e=>n.get().includes(e),i=e(o);return n.subscribe(i.invalidate),{...n,clear:()=>n.set([]),add:s,remove:l,toggle:e=>{o(e)?l(e):s(e)},isSelected:i}})(),scroll:e(0)}}}function xt(e,t,n){let{mailbox:s}=t,{messages:l}=t,{prev:o}=t,{next:i}=t,{selection:a}=t,{scroll:r}=t;return e.$set=e=>{"mailbox"in e&&n(0,s=e.mailbox),"messages"in e&&n(1,l=e.messages),"prev"in e&&n(2,o=e.prev),"next"in e&&n(3,i=e.next),"selection"in e&&n(4,a=e.selection),"scroll"in e&&n(5,r=e.scroll)},[s,l,o,i,a,r]}export default class extends t{constructor(e){super(),n(this,e,xt,ht,s,{mailbox:0,messages:1,prev:2,next:3,selection:4,scroll:5})}}export{pt as preload};
//# sourceMappingURL=Mailbox-3b0da227.js.map
