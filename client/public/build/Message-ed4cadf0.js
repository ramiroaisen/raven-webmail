import{S as t,a as e,s as a,b as n,c as s,d as o,e as l,n as c,f as r,as as i,K as m,k as $,E as d,L as f,F as u,an as g,h as p,j as h,l as x,m as b,M as w,o as k,p as v,w as y,A as j,y as A,B as L,O as B,G as M,H as T,ap as S,at as R,a2 as _,x as z,z as O,aq as U,ar as D,Y as C,Z as H,Q as I,R as N,a5 as P,a6 as Z,au as q,W as E,J as F,av as G,af as J,r as K,a4 as Q,aw as V,ax as W,ag as Y,u as X,ah as tt,ay as et}from"./main-05acd417.js";import{T as at,a as nt,R as st,M as ot,d as lt,c as ct,b as rt,U as it}from"./MoveTo-dde04707.js";function mt(t){let e,a;return{c(){e=n("svg"),a=n("path"),s(a,"d","M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"),s(a,"fill",t[2]),s(e,"width",t[0]),s(e,"height",t[1]),s(e,"viewBox",t[3])},m(t,n){o(t,e,n),l(e,a)},p(t,[n]){4&n&&s(a,"fill",t[2]),1&n&&s(e,"width",t[0]),2&n&&s(e,"height",t[1]),8&n&&s(e,"viewBox",t[3])},i:c,o:c,d(t){t&&r(e)}}}function $t(t,e,a){let{size:n="1em"}=e,{width:s=n}=e,{height:o=n}=e,{color:l="currentColor"}=e,{viewBox:c="0 0 24 24"}=e;return t.$set=t=>{"size"in t&&a(4,n=t.size),"width"in t&&a(0,s=t.width),"height"in t&&a(1,o=t.height),"color"in t&&a(2,l=t.color),"viewBox"in t&&a(3,c=t.viewBox)},[s,o,l,c,n]}class dt extends t{constructor(t){super(),e(this,t,$t,mt,a,{size:4,width:0,height:1,color:2,viewBox:3})}}function ft(t,e,a){const n=t.slice();return n[11]=e[a],n}function ut(t){let e,a,n=t[3].length+"";return{c(){e=$("x-count"),a=d(n),f(e,"class","svelte-coi85r")},m(t,n){o(t,e,n),l(e,a)},p(t,e){8&e&&n!==(n=t[3].length+"")&&u(a,n)},d(t){t&&r(e)}}}function gt(t){let e,a=t[11].filename+"";return{c(){e=d(a)},m(t,a){o(t,e,a)},p(t,n){8&n&&a!==(a=t[11].filename+"")&&u(e,a)},d(t){t&&r(e)}}}function pt(t){let e,a,n,c,i,m;const d=new D({props:{href:"/download/"+t[5].id+"/"+t[6].id+"/"+t[11].id+"?filename="+encodeURIComponent(t[11].filename),target:"_blank",$$slots:{default:[gt]},$$scope:{ctx:t}}});return{c(){e=$("div"),x(d.$$.fragment),a=b(),n=$("img"),i=b(),n.src!==(c=R(t[11].filename))&&s(n,"src",c),s(n,"alt",""),s(n,"class","svelte-coi85r"),s(e,"class","item svelte-coi85r")},m(t,s){o(t,e,s),k(d,e,null),l(e,a),l(e,n),l(e,i),m=!0},p(t,e){const a={};104&e&&(a.href="/download/"+t[5].id+"/"+t[6].id+"/"+t[11].id+"?filename="+encodeURIComponent(t[11].filename)),16392&e&&(a.$$scope={dirty:e,ctx:t}),d.$set(a),(!m||8&e&&n.src!==(c=R(t[11].filename)))&&s(n,"src",c)},i(t){m||(j(d.$$.fragment,t),m=!0)},o(t){A(d.$$.fragment,t),m=!1},d(t){t&&r(e),L(d)}}}function ht(t){let e,a,n=t[3],s=[];for(let e=0;e<n.length;e+=1)s[e]=pt(ft(t,n,e));const l=t=>A(s[t],1,1,()=>{s[t]=null});return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=_()},m(t,n){for(let e=0;e<s.length;e+=1)s[e].m(t,n);o(t,e,n),a=!0},p(t,a){if(104&a){let o;for(n=t[3],o=0;o<n.length;o+=1){const l=ft(t,n,o);s[o]?(s[o].p(l,a),j(s[o],1)):(s[o]=pt(l),s[o].c(),j(s[o],1),s[o].m(e.parentNode,e))}for(z(),o=n.length;o<s.length;o+=1)l(o);O()}},i(t){if(!a){for(let t=0;t<n.length;t+=1)j(s[t]);a=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)A(s[t]);a=!1},d(t){U(s,t),t&&r(e)}}}function xt(t){let e;const a=new S({props:{$$slots:{default:[ht]},$$scope:{ctx:t}}});return{c(){x(a.$$.fragment)},m(t,n){k(a,t,n),e=!0},p(t,e){const n={};16488&e&&(n.$$scope={dirty:e,ctx:t}),a.$set(n)},i(t){e||(j(a.$$.fragment,t),e=!0)},o(t){A(a.$$.fragment,t),e=!1},d(t){L(a,t)}}}function bt(t){let e,a,n,c,d,u,B,M,T;const S=new i({}),R=new m({});let _=t[3].length&&ut(t);function z(e){t[10].call(null,e)}let O={anchor:"top-left",$$slots:{default:[xt]},$$scope:{ctx:t}};void 0!==t[0]&&(O.open=t[0]);const U=new g({props:O});return p.push(()=>h(U,"open",z)),{c(){e=$("x-action"),x(S.$$.fragment),a=b(),x(R.$$.fragment),n=b(),_&&_.c(),c=b(),d=$("div"),x(U.$$.fragment),s(d,"class","anchor svelte-coi85r"),f(e,"class","btn-dark"),f(e,"data-tooltip",B=t[4].actions.attachments),w(e,"hover",t[0])},m(s,r,i){o(s,e,r),k(S,e,null),l(e,a),k(R,e,null),l(e,n),_&&_.m(e,null),l(e,c),l(e,d),k(U,d,null),M=!0,i&&T(),T=v(e,"click",t[8])},p(t,[a]){t[3].length?_?_.p(t,a):(_=ut(t),_.c(),_.m(e,c)):_&&(_.d(1),_=null);const n={};16488&a&&(n.$$scope={dirty:a,ctx:t}),!u&&1&a&&(u=!0,n.open=t[0],y(()=>u=!1)),U.$set(n),(!M||16&a&&B!==(B=t[4].actions.attachments))&&f(e,"data-tooltip",B),1&a&&w(e,"hover",t[0])},i(t){M||(j(S.$$.fragment,t),j(R.$$.fragment,t),j(U.$$.fragment,t),M=!0)},o(t){A(S.$$.fragment,t),A(R.$$.fragment,t),A(U.$$.fragment,t),M=!1},d(t){t&&r(e),L(S),L(R),_&&_.d(),L(U),T()}}}function wt(t,e,a){let n,s,o,l=c,r=()=>(l(),l=B($,t=>a(5,s=t)),$),i=c,m=()=>(i(),i=B(d,t=>a(6,o=t)),d);t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>i());let{mailbox:$}=e;r();let{message:d}=e;m();let{attachments:f}=e;const{locale:u}=M("app");T(t,u,t=>a(9,n=t));let{locale:g=n}=e,{menuOpen:p=!1}=e;return t.$set=t=>{"mailbox"in t&&r(a(1,$=t.mailbox)),"message"in t&&m(a(2,d=t.message)),"attachments"in t&&a(3,f=t.attachments),"locale"in t&&a(4,g=t.locale),"menuOpen"in t&&a(0,p=t.menuOpen)},[p,$,d,f,g,s,o,u,()=>a(0,p=!p),n,function(t){p=t,a(0,p)}]}class kt extends t{constructor(t){super(),e(this,t,wt,bt,a,{mailbox:1,message:2,attachments:3,locale:4,menuOpen:0})}}function vt(t){let e;const a=new ct({});return{c(){x(a.$$.fragment)},m(t,n){k(a,t,n),e=!0},i(t){e||(j(a.$$.fragment,t),e=!0)},o(t){A(a.$$.fragment,t),e=!1},d(t){L(a,t)}}}function yt(t){let e;const a=new rt({});return{c(){x(a.$$.fragment)},m(t,n){k(a,t,n),e=!0},i(t){e||(j(a.$$.fragment,t),e=!0)},o(t){A(a.$$.fragment,t),e=!1},d(t){L(a,t)}}}function jt(t){let e,a,n,s,c;const i=new Y({}),d=new m({});return{c(){e=$("x-action"),x(i.$$.fragment),a=b(),x(d.$$.fragment),f(e,"class","btn-dark"),f(e,"data-tooltip",n=t[3].actions.markAsSpam)},m(n,r,m){o(n,e,r),k(i,e,null),l(e,a),k(d,e,null),s=!0,m&&c(),c=v(e,"click",t[13])},p(t,a){(!s||8&a&&n!==(n=t[3].actions.markAsSpam))&&f(e,"data-tooltip",n)},i(t){s||(j(i.$$.fragment,t),j(d.$$.fragment,t),s=!0)},o(t){A(i.$$.fragment,t),A(d.$$.fragment,t),s=!1},d(t){t&&r(e),L(i),L(d),c()}}}function At(t){let e,a,n,s,c;const i=new it({}),d=new m({});return{c(){e=$("x-action"),x(i.$$.fragment),a=b(),x(d.$$.fragment),f(e,"class","btn-dark"),f(e,"data-tooltip",n=t[3].actions.unMarkAsSpam)},m(n,r,m){o(n,e,r),k(i,e,null),l(e,a),k(d,e,null),s=!0,m&&c(),c=v(e,"click",t[13])},p(t,a){(!s||8&a&&n!==(n=t[3].actions.unMarkAsSpam))&&f(e,"data-tooltip",n)},i(t){s||(j(i.$$.fragment,t),j(d.$$.fragment,t),s=!0)},o(t){A(i.$$.fragment,t),A(d.$$.fragment,t),s=!1},d(t){t&&r(e),L(i),L(d),c()}}}function Lt(t){let e,a;const n=new kt({props:{mailbox:t[0],message:t[1],attachments:t[5].attachments,tooltip:t[3].actions.attachments}});return{c(){e=$("x-action-group"),x(n.$$.fragment)},m(t,s){o(t,e,s),k(n,e,null),a=!0},p(t,e){const a={};1&e&&(a.mailbox=t[0]),2&e&&(a.message=t[1]),32&e&&(a.attachments=t[5].attachments),8&e&&(a.tooltip=t[3].actions.attachments),n.$set(a)},i(t){a||(j(n.$$.fragment,t),a=!0)},o(t){A(n.$$.fragment,t),a=!1},d(t){t&&r(e),L(n)}}}function Bt(t){let e,a,n,c,i,d,u,g,p,h,w,y,B,M,T,S,R,U,D,C,H,I,N,P,Z,q,E,G,Q,V,W;const Y=new dt({}),X=new m({}),tt=new m({}),et=[yt,vt],at=[];function nt(t,e){return t[5].seen?0:1}h=nt(t),w=at[h]=et[h](t);const ct=[At,jt],rt=[];~(M=function(t,e){return t[8]?0:t[10]||t[11]||t[9]?-1:1}(t))&&(T=rt[M]=ct[M](t));const it=new J({}),mt=new m({}),$t=new st({}),ft=new m({});let ut=!t[10]&&!t[11]&&function(t){let e,a,n,s,c;const i=new lt({}),d=new m({});return{c(){e=$("x-action"),x(i.$$.fragment),a=b(),x(d.$$.fragment),f(e,"class","btn-dark"),f(e,"data-tooltip",n=t[3].actions.reply)},m(n,r,m){o(n,e,r),k(i,e,null),l(e,a),k(d,e,null),s=!0,m&&c(),c=v(e,"click",t[15])},p(t,a){(!s||8&a&&n!==(n=t[3].actions.reply))&&f(e,"data-tooltip",n)},i(t){s||(j(i.$$.fragment,t),j(d.$$.fragment,t),s=!0)},o(t){A(i.$$.fragment,t),A(d.$$.fragment,t),s=!1},d(t){t&&r(e),L(i),L(d),c()}}}(t);const gt=new ot({props:{mailbox:t[0],selection:F([t[1]]),tooltip:t[3].actions.moveTo}});gt.$on("moved",t[17]);let pt=t[5].attachments&&t[5].attachments.length&&Lt(t);return{c(){e=$("x-action-group"),a=$("a"),x(Y.$$.fragment),n=b(),x(X.$$.fragment),d=b(),u=$("x-action-group"),g=$("x-action"),x(tt.$$.fragment),p=b(),w.c(),B=b(),T&&T.c(),S=b(),R=$("x-action"),x(it.$$.fragment),U=b(),x(mt.$$.fragment),C=b(),H=$("x-action-group"),I=$("x-action"),x($t.$$.fragment),N=b(),x(ft.$$.fragment),Z=b(),ut&&ut.c(),q=b(),E=$("x-action-group"),x(gt.$$.fragment),G=b(),pt&&pt.c(),Q=_(),s(a,"class","x-action btn-dark"),s(a,"href",c="#!/mailbox/"+t[4].id),s(a,"data-tooltip",i=t[3].actions.backToMailbox),f(g,"class","btn-dark"),f(g,"data-tooltip",y=t[5].seen?t[3].actions.markAsUnread:t[3].actions.markAsRead),f(R,"class","btn-dark"),f(R,"data-tooltip",D=t[9]?t[3].actions.deletePermanently:t[10]?t[3].actions.discardDrafts:t[3].actions.delete),f(I,"class","btn-dark"),f(I,"data-tooltip",P=t[3].actions.forward)},m(s,c,r){o(s,e,c),l(e,a),k(Y,a,null),l(a,n),k(X,a,null),o(s,d,c),o(s,u,c),l(u,g),k(tt,g,null),l(g,p),at[h].m(g,null),l(u,B),~M&&rt[M].m(u,null),l(u,S),l(u,R),k(it,R,null),l(R,U),k(mt,R,null),o(s,C,c),o(s,H,c),l(H,I),k($t,I,null),l(I,N),k(ft,I,null),l(H,Z),ut&&ut.m(H,null),o(s,q,c),o(s,E,c),k(gt,E,null),o(s,G,c),pt&&pt.m(s,c),o(s,Q,c),V=!0,r&&K(W),W=[v(g,"click",t[12]),v(R,"click",t[14]),v(I,"click",t[16])]},p(t,e){(!V||16&e&&c!==(c="#!/mailbox/"+t[4].id))&&s(a,"href",c),(!V||8&e&&i!==(i=t[3].actions.backToMailbox))&&s(a,"data-tooltip",i);let n=h;h=nt(t),h!==n&&(z(),A(at[n],1,1,()=>{at[n]=null}),O(),w=at[h],w||(w=at[h]=et[h](t),w.c()),j(w,1),w.m(g,null)),(!V||40&e&&y!==(y=t[5].seen?t[3].actions.markAsUnread:t[3].actions.markAsRead))&&f(g,"data-tooltip",y),T&&T.p(t,e),(!V||8&e&&D!==(D=t[9]?t[3].actions.deletePermanently:t[10]?t[3].actions.discardDrafts:t[3].actions.delete))&&f(R,"data-tooltip",D),(!V||8&e&&P!==(P=t[3].actions.forward))&&f(I,"data-tooltip",P),t[10]||t[11]||ut.p(t,e);const o={};1&e&&(o.mailbox=t[0]),2&e&&(o.selection=F([t[1]])),8&e&&(o.tooltip=t[3].actions.moveTo),gt.$set(o),t[5].attachments&&t[5].attachments.length?pt?(pt.p(t,e),32&e&&j(pt,1)):(pt=Lt(t),pt.c(),j(pt,1),pt.m(Q.parentNode,Q)):pt&&(z(),A(pt,1,1,()=>{pt=null}),O())},i(t){V||(j(Y.$$.fragment,t),j(X.$$.fragment,t),j(tt.$$.fragment,t),j(w),j(T),j(it.$$.fragment,t),j(mt.$$.fragment,t),j($t.$$.fragment,t),j(ft.$$.fragment,t),j(ut),j(gt.$$.fragment,t),j(pt),V=!0)},o(t){A(Y.$$.fragment,t),A(X.$$.fragment,t),A(tt.$$.fragment,t),A(w),A(T),A(it.$$.fragment,t),A(mt.$$.fragment,t),A($t.$$.fragment,t),A(ft.$$.fragment,t),A(ut),A(gt.$$.fragment,t),A(pt),V=!1},d(t){t&&r(e),L(Y),L(X),t&&r(d),t&&r(u),L(tt),at[h].d(),~M&&rt[M].d(),L(it),L(mt),t&&r(C),t&&r(H),L($t),L(ft),ut&&ut.d(),t&&r(q),t&&r(E),L(gt),t&&r(G),pt&&pt.d(t),t&&r(Q),K(W)}}}function Mt(t){let e;function a(t,e){return t[5].from.name?St:Tt}let n=a(t),s=n(t);return{c(){e=$("x-message-from"),s.c(),f(e,"class","svelte-hdndkc")},m(t,a){o(t,e,a),s.m(e,null)},p(t,o){n===(n=a(t))&&s?s.p(t,o):(s.d(1),s=n(t),s&&(s.c(),s.m(e,null)))},d(t){t&&r(e),s.d()}}}function Tt(t){let e,a,n,c,i=t[3].message.labels.from+"",m=t[5].from.address+"";return{c(){e=d(i),a=b(),n=$("span"),c=d(m),s(n,"class","from-main svelte-hdndkc")},m(t,s){o(t,e,s),o(t,a,s),o(t,n,s),l(n,c)},p(t,a){8&a&&i!==(i=t[3].message.labels.from+"")&&u(e,i),32&a&&m!==(m=t[5].from.address+"")&&u(c,m)},d(t){t&&r(e),t&&r(a),t&&r(n)}}}function St(t){let e,a,n,c,i,m,f,g,p=t[3].message.labels.from+"",h=t[5].from.name+"",x=t[5].from.address+"";return{c(){e=d(p),a=b(),n=$("span"),c=d(h),i=b(),m=d("<"),f=d(x),g=d(">"),s(n,"class","from-main svelte-hdndkc")},m(t,s){o(t,e,s),o(t,a,s),o(t,n,s),l(n,c),o(t,i,s),o(t,m,s),o(t,f,s),o(t,g,s)},p(t,a){8&a&&p!==(p=t[3].message.labels.from+"")&&u(e,p),32&a&&h!==(h=t[5].from.name+"")&&u(c,h),32&a&&x!==(x=t[5].from.address+"")&&u(f,x)},d(t){t&&r(e),t&&r(a),t&&r(n),t&&r(i),t&&r(m),t&&r(f),t&&r(g)}}}function Rt(t){let e,a,n,s,c=t[3].message.labels.to+"",i=t[5].to.map(Ct).join(", ")+"";return{c(){e=$("x-message-to"),a=d(c),n=b(),s=d(i),f(e,"class","svelte-hdndkc")},m(t,c){o(t,e,c),l(e,a),l(e,n),l(e,s)},p(t,e){8&e&&c!==(c=t[3].message.labels.to+"")&&u(a,c),32&e&&i!==(i=t[5].to.map(Ct).join(", ")+"")&&u(s,i)},d(t){t&&r(e)}}}function _t(t){let e,a,n,s,c=t[3].message.labels.date+"",i=new Date(t[5].date).toLocaleString()+"";return{c(){e=$("x-message-date"),a=d(c),n=b(),s=d(i),f(e,"class","svelte-hdndkc")},m(t,c){o(t,e,c),l(e,a),l(e,n),l(e,s)},p(t,e){8&e&&c!==(c=t[3].message.labels.date+"")&&u(a,c),32&e&&i!==(i=new Date(t[5].date).toLocaleString()+"")&&u(s,i)},d(t){t&&r(e)}}}function zt(t){let e,a,n=t[5].text+"";return{c(){e=$("pre"),a=d(n)},m(t,n){o(t,e,n),l(e,a)},p(t,e){32&e&&n!==(n=t[5].text+"")&&u(a,n)},d(t){t&&r(e)}}}function Ot(t){let e,a=V(t[5].html.join(""))+"";return{c(){e=new W(a,null)},m(t,a){e.m(t,a)},p(t,n){32&n&&a!==(a=V(t[5].html.join(""))+"")&&e.p(a)},d(t){t&&e.d()}}}function Ut(t){let e,a,n,s,c,i,m,g,p,h,w,y,B,M=t[5].subject+"";const T=new nt({props:{scrolled:0!==t[6],$$slots:{default:[Bt]},$$scope:{ctx:t}}});let S=t[5].from&&Mt(t),R=t[5].to&&Rt(t),_=t[5].date&&_t(t);function z(t,e){return t[5].html&&t[5].html.length?Ot:((null==w||32&e)&&(w=!(!t[5].text||!t[5].text.trim())),w?zt:void 0)}let O=z(t,-1),U=O&&O(t);return{c(){x(T.$$.fragment),e=b(),a=$("x-tab-content"),n=$("x-message-title"),s=d(M),c=b(),i=$("x-message-info"),S&&S.c(),m=b(),R&&R.c(),g=b(),_&&_.c(),p=b(),h=$("x-message-content"),U&&U.c(),f(n,"class","svelte-hdndkc"),f(i,"class","svelte-hdndkc"),f(h,"class","svelte-hdndkc"),f(a,"class","svelte-hdndkc")},m(r,$,d){k(T,r,$),o(r,e,$),o(r,a,$),l(a,n),l(n,s),l(a,c),l(a,i),S&&S.m(i,null),l(i,m),R&&R.m(i,null),l(i,g),_&&_.m(i,null),l(a,p),l(a,h),U&&U.m(h,null),y=!0,d&&B(),B=v(a,"scroll",t[7])},p(t,e){const a={};64&e&&(a.scrolled=0!==t[6]),2097211&e&&(a.$$scope={dirty:e,ctx:t}),T.$set(a),(!y||32&e)&&M!==(M=t[5].subject+"")&&u(s,M),t[5].from?S?S.p(t,e):(S=Mt(t),S.c(),S.m(i,m)):S&&(S.d(1),S=null),t[5].to?R?R.p(t,e):(R=Rt(t),R.c(),R.m(i,g)):R&&(R.d(1),R=null),t[5].date?_?_.p(t,e):(_=_t(t),_.c(),_.m(i,null)):_&&(_.d(1),_=null),O===(O=z(t,e))&&U?U.p(t,e):(U&&U.d(1),U=O&&O(t),U&&(U.c(),U.m(h,null)))},i(t){y||(j(T.$$.fragment,t),y=!0)},o(t){A(T.$$.fragment,t),y=!1},d(t){L(T,t),t&&r(e),t&&r(a),S&&S.d(),R&&R.d(),_&&_.d(),U&&U.d(),B()}}}function Dt(t){let e,a,n;document.title=e=t[5].subject;const s=new at({props:{$$slots:{default:[Ut]},$$scope:{ctx:t}}});return{c(){a=b(),x(s.$$.fragment)},m(t,e){o(t,a,e),k(s,t,e),n=!0},p(t,[a]){(!n||32&a)&&e!==(e=t[5].subject)&&(document.title=e);const o={};2097275&a&&(o.$$scope={dirty:a,ctx:t}),s.$set(o)},i(t){n||(j(s.$$.fragment,t),n=!0)},o(t){A(s.$$.fragment,t),n=!1},d(t){t&&r(a),L(s,t)}}}const Ct=t=>`<${t.address}>`;function Ht(t,e,a){let n,s,o,l,r=c,i=()=>(r(),r=B(u,t=>a(4,n=t)),u),m=c,$=()=>(m(),m=B(g,t=>a(5,s=t)),g),d=c,f=()=>(d(),d=B(p,t=>a(6,l=t)),p);t.$$.on_destroy.push(()=>r()),t.$$.on_destroy.push(()=>m()),t.$$.on_destroy.push(()=>d());let{mailbox:u}=e;i();let{message:g}=e;$();let{scroll:p}=e;f();let h=C===u,x=H===u,b=I===u,w=N===u;const k=t=>{let e=!1;return async()=>{if(!e){e=!0;try{await t()}catch(t){throw t}finally{e=!1}}}},v=k(async()=>{await Q(n.id,[s.id],!s.seen),g.update(t=>({...t,seen:!t.seen}))}),y=k(async()=>{await P(n.id,[s.id],!h),location.hash="#!/mailbox/"+n.id}),j=k(async()=>{await Z(n.id,[s.id]),location.hash="#!/mailbox/"+n.id}),A=k(async()=>{const t=await q(n.id,s.id);E(F(t))}),L=k(async()=>{const t=await G(n.id,s.id);E(F(t))}),{locale:S}=M("app");T(t,S,t=>a(19,o=t));let{locale:R=o}=e;return t.$set=t=>{"mailbox"in t&&i(a(0,u=t.mailbox)),"message"in t&&$(a(1,g=t.message)),"scroll"in t&&f(a(2,p=t.scroll)),"locale"in t&&a(3,R=t.locale)},[u,g,p,R,n,s,l,t=>p.set(t.target.scrollTop),h,x,b,w,v,y,j,A,L,()=>setTimeout(()=>location.hash="#!/mailbox/"+n.id,250),S]}class It extends t{constructor(t){super(),e(this,t,Ht,Dt,a,{mailbox:0,message:1,scroll:2,locale:3})}}function Nt(t){let e;const a=new It({props:{mailbox:t[0],message:t[1],scroll:t[2]}});return{c(){x(a.$$.fragment)},m(t,n){k(a,t,n),e=!0},p(t,[e]){const n={};1&e&&(n.mailbox=t[0]),2&e&&(n.message=t[1]),4&e&&(n.scroll=t[2]),a.$set(n)},i(t){e||(j(a.$$.fragment,t),e=!0)},o(t){A(a.$$.fragment,t),e=!1},d(t){L(a,t)}}}async function Pt(t){if(!X.get())return this.redirect("#!/login");const e=await tt(t.params.mailbox);if(null==e)return this.redirect("#!/");try{const a=await et(t.params.mailbox,t.params.message);return{mailbox:e,message:F(a),scroll:F(0)}}catch(t){this.redirect("#!/mailbox/"+e.get().id)}}function Zt(t,e,a){let{mailbox:n}=e,{message:s}=e,{scroll:o}=e;return t.$set=t=>{"mailbox"in t&&a(0,n=t.mailbox),"message"in t&&a(1,s=t.message),"scroll"in t&&a(2,o=t.scroll)},[n,s,o]}export default class extends t{constructor(t){super(),e(this,t,Zt,Nt,a,{mailbox:0,message:1,scroll:2})}}export{Pt as preload};
//# sourceMappingURL=Message-ed4cadf0.js.map
